
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>General information for developers &#8212; Clawpack 5.1.0 documentation</title>
    <link rel="stylesheet" href="../_static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/base.css" type="text/css" />
    <link rel="stylesheet" href="../_static/layout.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/clawicon.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Installing and configuring git" href="devel/gitwash/git_installation.html" />
    <link rel="prev" title="Information for developers" href="for_developers.html" /> 
  </head><body>
<div id="main-wrapper" class="sphinx">
<div id="header-wrapper">
  <section id="header">
    <!-- <h1><a href="http://clawpack.org/">Clawpack</a></h1> -->
    <h1><a href="http://clawpack.org/">Clawpack-5</a></h1> 
    <nav>
      <ul>
        <li>
          <a href="../contents.html">Docs</a>
        </li>
        <li>
          <a href="../installing.html">Install</a>
        </li>
        <li>
          <a class="" href="http://clawpack.org/gallery">Gallery</a>
        </li>
        <li>
          <a class="" href="../community.html">Community</a>
        </li>
        <li>
          <a class="active" href="http://github.com/clawpack">Source</a>
        </li>
        <li>
          <a class="" href="../developers.html">Develop</a>
        </li>
      </ul>
    </nav>
  </section>
<div class="decoration"></div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="devel/gitwash/git_installation.html" title="Installing and configuring git"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="for_developers.html" title="Information for developers"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Clawpack 5.1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Pyclaw</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="for_developers.html" accesskey="U">Information for developers</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="general-information-for-developers">
<span id="develop"></span><h1>General information for developers<a class="headerlink" href="#general-information-for-developers" title="Permalink to this headline">¶</a></h1>
<p>The PyClaw repository is hosted on Github at
<a class="reference external" href="http://github.com/clawpack/pyclaw">http://github.com/clawpack/pyclaw</a>.</p>
<div class="section" id="guidelines-for-contributing">
<h2>Guidelines for contributing<a class="headerlink" href="#guidelines-for-contributing" title="Permalink to this headline">¶</a></h2>
<p>When preparing contributions, please follow the guidelines in
<a class="reference internal" href="devel/gitwash/patching_forking.html#contribution"><span class="std std-ref">Contributing to PyClaw code development</span></a>.  Also:</p>
<blockquote>
<div><ul class="simple">
<li><p>If the planned changes are substantial or will be backward-incompatible,
it’s best to discuss them on the <a class="reference external" href="http://groups.google.com/group/claw-dev">claw-dev Google group</a> before starting.</p></li>
<li><p>Make sure all tests pass and all the built-in examples run correctly.</p></li>
<li><p>Be verbose and detailed in your commit messages and your pull request.</p></li>
<li><p>It may be wise to have one of the maintainers look at your changes before
they are complete
(especially if the changes will necessitate modifications of tests
and/or examples).</p></li>
<li><p>If your changes are not backward-compatible, your pull request should
include instructions for users to update their own application codes.</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="bugs">
<h2>Bugs<a class="headerlink" href="#bugs" title="Permalink to this headline">¶</a></h2>
<p>If you find a bug, post an issue with as much explanation as possible on the
Issue tracker at <a class="reference external" href="https://github.com/clawpack/pyclaw/issues">https://github.com/clawpack/pyclaw/issues</a>.  If you’re looking
for something useful to do, try tackling one of the issues listed there.</p>
</div>
<div class="section" id="developer-communication">
<h2>Developer communication<a class="headerlink" href="#developer-communication" title="Permalink to this headline">¶</a></h2>
<p>As PyClaw is part of the family of Clawpack codes, developer communication
takes place on the google group at <a class="reference external" href="http://groups.google.com/group/claw-dev/">http://groups.google.com/group/claw-dev/</a>.</p>
</div>
<div class="section" id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h2>
<p>It is almost always okay to add “optional dependencies”, for example,  creating
an optional feature or application that is only enabled when the software
dependencies for that feature are satisfied.  <code class="xref py py-mod docutils literal notranslate"><span class="pre">petclaw</span></code> is an example of
this, as it provides an optional means of running many PyClaw applications in
parallel.</p>
<p>In general, introduction of general dependencies
should be avoided.  If you wish to make a change that
will introduce a new dependency (including depending on a more
recent version of a particular package), it should be discussed
on the <a class="reference external" href="http://groups.google.com/group/claw-dev">claw-dev Google group</a>
first.</p>
<p>New versions of existing dependencies will typically be adopted
either when new functionality provides an important benefit for
PyClaw or when the currently supported version is deemed to be
substantially outdated.</p>
</div>
<div class="section" id="running-the-tests">
<h2>Running the tests<a class="headerlink" href="#running-the-tests" title="Permalink to this headline">¶</a></h2>
<p>The PyClaw test suite is built around <a class="reference external" href="http://nose.readthedocs.org/en/latest/">nosetests</a> for automatic test discovery, with
supplementary functionality from the <a class="reference internal" href="util.html#module-pyclaw.util" title="pyclaw.util"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyclaw.util</span></code></a> module.  To run the
complete test suite with helpful output, issue the following command at the
top-level of the pyclaw source directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nosetests</span> <span class="o">-</span><span class="n">vs</span>
</pre></div>
</div>
<p>To run the parallel versions of the tests (if petsc4py is installed), run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mpirun</span> <span class="o">-</span><span class="n">n</span> <span class="mi">4</span> <span class="n">nosetests</span> <span class="o">-</span><span class="n">vs</span>
</pre></div>
</div>
<p>(Replace 4 with the number of processes you’d like test on)</p>
<p>Try prime numbers if you’re really trying to break things!</p>
<div class="section" id="running-serial-tests-simultaneously">
<h3>Running serial tests simultaneously<a class="headerlink" href="#running-serial-tests-simultaneously" title="Permalink to this headline">¶</a></h3>
<p>When running the tests, if your machine has multiple cores you can take
advantage of them by doing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nosetests</span> <span class="o">-</span><span class="n">vs</span> <span class="o">--</span><span class="n">processes</span><span class="o">=</span><span class="mi">2</span>
</pre></div>
</div>
<p>(replace “2” with the number of processes you want to spawn). However, using
large numbers of processes occasionally causes spurious failure of some tests
due to issues with the operating system.  If you see this behavior, it’s best
to run the tests in serial or with a small number of processes.</p>
</div>
<div class="section" id="running-a-specific-test">
<h3>Running a specific test<a class="headerlink" href="#running-a-specific-test" title="Permalink to this headline">¶</a></h3>
<p>The PyClaw tests are associated with particular applications in the examples/ sub-
directory of the primary repository directory.  If you want to run tests for a
specific application, simply specify the directory containing the application
you are interested in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nosetests</span> <span class="o">-</span><span class="n">vs</span> <span class="n">examples</span><span class="o">/</span><span class="n">acoustics_3d_variable</span>
</pre></div>
</div>
<p>You can also specify a single file to run the tests it contains.</p>
</div>
<div class="section" id="doctests">
<h3>Doctests<a class="headerlink" href="#doctests" title="Permalink to this headline">¶</a></h3>
<p>Several of the main PyClaw modules also have doctests (tests in their
docstrings). You can run them by executing the corresponding module:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd $PYCLAW/src/pyclaw
python grid.py
python state.py
</pre></div>
</div>
<p>If the tests pass, you will see no output.  You can get more output by using
the <cite>-v</cite> option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">state</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">v</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="writing-new-tests">
<h2>Writing New Tests<a class="headerlink" href="#writing-new-tests" title="Permalink to this headline">¶</a></h2>
<p>If you contribute new functionality to PyClaw, it is expected that you will also
write at least one or two new tests that exercise your contribution, so that
further changes to other parts of PyClaw or your code don’t break your feature.
You do not have to use any of the functionality offered by pyclaw.util, but it
may simplify your test-writing and allow you to check more cases than you would
easily specify by hand.</p>
<p>The most important function in <a class="reference internal" href="util.html#module-pyclaw.util" title="pyclaw.util"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyclaw.util</span></code></a> is
<a class="reference internal" href="util.html#pyclaw.util.gen_variants" title="pyclaw.util.gen_variants"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyclaw.util.gen_variants()</span></code></a>, which allows you to perform combinatorial
testing without manually specifying every feature you’d like to perform.
Currently, <a class="reference internal" href="util.html#pyclaw.util.gen_variants" title="pyclaw.util.gen_variants"><code class="xref py py-func docutils literal notranslate"><span class="pre">gen_variants()</span></code></a> can multiplicatively exercise
kernel_languages (Fortran or Python) and pure PyClaw or PetClaw implementations.
This allows you to write one function that tests four variants.</p>
<p>Another function provided by <a class="reference internal" href="util.html#module-pyclaw.util" title="pyclaw.util"><code class="xref py py-mod docutils literal notranslate"><span class="pre">util</span></code></a> is
<a class="reference internal" href="util.html#pyclaw.util.test_app" title="pyclaw.util.test_app"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyclaw.util.test_app()</span></code></a>. The <a class="reference internal" href="util.html#pyclaw.util.test_app" title="pyclaw.util.test_app"><code class="xref py py-func docutils literal notranslate"><span class="pre">test_app()</span></code></a> function will
run an application as if started from the command line with the specified
keyword arguments passed in.  This is useful for testing specific code that does
not necessarily work with <code class="xref py py-mod docutils literal notranslate"><span class="pre">petclaw</span></code>, for example, and is not expected to.</p>
<p>You will notice that both <a class="reference internal" href="util.html#pyclaw.util.gen_variants" title="pyclaw.util.gen_variants"><code class="xref py py-func docutils literal notranslate"><span class="pre">gen_variants()</span></code></a> and
<a class="reference internal" href="util.html#pyclaw.util.test_app" title="pyclaw.util.test_app"><code class="xref py py-func docutils literal notranslate"><span class="pre">test_app()</span></code></a> require a <cite>verifier</cite> method as an argument.
These functions both effectively run tests and verify output with the following
function calls:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">application</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">check_values</span> <span class="o">=</span> <span class="n">verifier</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
<p>The <cite>verifier</cite> method needs to return <cite>None</cite> if there is no problem with the
output, or a sequence of three values describing what was expected, what it
received, and more details about the error.  A very simple <cite>verifier</cite> method
that you can use is <a class="reference internal" href="util.html#pyclaw.util.check_diff" title="pyclaw.util.check_diff"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyclaw.util.check_diff()</span></code></a>, which can use either an
absolute tolerance or a relative tolerance to compare an expected value against
the test output from the application.</p>
<p>See examples/acoustics_1d_homogeneous/test_acoustics.py for a comprehensive example
of how to use <a class="reference internal" href="util.html#pyclaw.util.gen_variants" title="pyclaw.util.gen_variants"><code class="xref py py-func docutils literal notranslate"><span class="pre">gen_variants()</span></code></a> and
<a class="reference internal" href="util.html#pyclaw.util.check_diff" title="pyclaw.util.check_diff"><code class="xref py py-func docutils literal notranslate"><span class="pre">check_diff()</span></code></a>. See examples/shallow_sphere/test_shallow_sphere.py
for an example that uses <a class="reference internal" href="util.html#pyclaw.util.test_app" title="pyclaw.util.test_app"><code class="xref py py-func docutils literal notranslate"><span class="pre">test_app()</span></code></a> and also loads a known
solution from disk using numpy.</p>
</div>
<div class="section" id="catching-errors-with-pyflakes-and-pylint">
<h2>Catching errors with Pyflakes and Pylint<a class="headerlink" href="#catching-errors-with-pyflakes-and-pylint" title="Permalink to this headline">¶</a></h2>
<p>Pyflakes and Pylint are Python packages designed to help you catch errors or
poor coding practices.  To run pylint on the whole PyClaw package, do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd $PYCLAW
pylint -d C pyclaw
</pre></div>
</div>
<p>The <cite>-d</cite> option suppresses a lot of style warnings, since PyClaw doesn’t
generally conform to PEP8.  To run pylint on just one module, use something
like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pylint</span> <span class="o">-</span><span class="n">d</span> <span class="n">C</span> <span class="n">pyclaw</span><span class="o">.</span><span class="n">state</span>
</pre></div>
</div>
<p>Since pylint output can be long, it’s helpful to write it to an html file
and open that in a web browser:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pylint</span> <span class="o">-</span><span class="n">d</span> <span class="n">C</span> <span class="n">pyclaw</span><span class="o">.</span><span class="n">state</span> <span class="o">-</span><span class="n">f</span> <span class="n">html</span> <span class="o">&gt;</span> <span class="n">pylint</span><span class="o">.</span><span class="n">html</span>
</pre></div>
</div>
<p>Pyflakes is similar to pylint but aims only to catch errors.  If you
use Vim, there is a nice extension package
<a class="reference external" href="https://github.com/kevinw/pyflakes-vim">pyflakes.vim</a>
that will catch errors as you code and underline them in red.</p>
</div>
<div class="section" id="checking-test-coverage">
<h2>Checking test coverage<a class="headerlink" href="#checking-test-coverage" title="Permalink to this headline">¶</a></h2>
<p>You can use nose to see how much of the code is covered by the current
suite of tests and track progress if you add more tests</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nosetests</span> <span class="o">--</span><span class="k">with</span><span class="o">-</span><span class="n">coverage</span> <span class="o">--</span><span class="n">cover</span><span class="o">-</span><span class="n">package</span><span class="o">=</span><span class="n">pyclaw</span> <span class="o">--</span><span class="n">cover</span><span class="o">-</span><span class="n">html</span>
</pre></div>
</div>
<p>This creates a set of html files in <cite>./cover</cite>, showing exactly which lines
of code have been tested.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p><a href="http://clawpack.org/">
    <img class="logo" src= "../_static/clawlogo.jpg" alt="Logo"/>
</a>
<h2>Version 5.1.0</h2>
</p>
  <h3><a href="../contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">General information for developers</a><ul>
<li><a class="reference internal" href="#guidelines-for-contributing">Guidelines for contributing</a></li>
<li><a class="reference internal" href="#bugs">Bugs</a></li>
<li><a class="reference internal" href="#developer-communication">Developer communication</a></li>
<li><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li><a class="reference internal" href="#running-the-tests">Running the tests</a><ul>
<li><a class="reference internal" href="#running-serial-tests-simultaneously">Running serial tests simultaneously</a></li>
<li><a class="reference internal" href="#running-a-specific-test">Running a specific test</a></li>
<li><a class="reference internal" href="#doctests">Doctests</a></li>
</ul>
</li>
<li><a class="reference internal" href="#writing-new-tests">Writing New Tests</a></li>
<li><a class="reference internal" href="#catching-errors-with-pyflakes-and-pylint">Catching errors with Pyflakes and Pylint</a></li>
<li><a class="reference internal" href="#checking-test-coverage">Checking test coverage</a></li>
</ul>
</li>
</ul>
<h3>Related Topics</h3>
<ul>
  <li><a href="../contents.html">Documentation overview</a><ul>
  <li><a href="index.html">Pyclaw</a><ul>
  <li><a href="for_developers.html">Information for developers</a><ul>
      <li>Previous: <a href="for_developers.html" title="previous chapter">Information for developers</a></li>
      <li>Next: <a href="devel/gitwash/git_installation.html" title="next chapter">Installing and configuring git</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
<div class="widget navlinks">
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/pyclaw/develop.rst.txt"
            rel="nofollow"
            target="_blank">Source .rst</a></li>
    <li><a href="https://github.com/clawpack/doc/blob/dev/doc/pyclaw/develop.rst"
            rel="nofollow"
            target="_blank">Source on GitHub</a></li>
     <li><a href="https://github.com/clawpack/doc/commits/dev/doc/pyclaw/develop.rst"
             rel="nofollow"
             target="_blank">History</a></li>
    <li><a href="https://github.com/clawpack/doc/edit/dev/doc/pyclaw/develop.rst"
            rel="nofollow"
            target="_blank">Suggest Edits</a></li>
     <li><a href="https://github.com/clawpack/doc/issues/new/choose"
             rel="nofollow"
             target="_blank">Raise an Issue</a></li>
  </ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
<h4>Latest Version</h4>
<ul>
  <li><a href="../../dev/index.html">dev</a></li>
  <li><a href="../../v5.7.0/index.html">v5.7.0</a></li>
</ul>
<h4>Older Versions</h4>
<ul>
  <li><a href="../../list/index.html">list</a></li>
  <li><a href="develop.html">v5.1.0</a></li>
  <li><a href="../../v5.2.0/pyclaw/develop.html">v5.2.0</a></li>
  <li><a href="../../v5.2.1/pyclaw/develop.html">v5.2.1</a></li>
  <li><a href="../../v5.3.0/index.html">v5.3.0</a></li>
  <li><a href="../../v5.3.1/index.html">v5.3.1</a></li>
  <li><a href="../../v5.4.0/index.html">v5.4.0</a></li>
  <li><a href="../../v5.4.1/index.html">v5.4.1</a></li>
  <li><a href="../../v5.5.0/index.html">v5.5.0</a></li>
  <li><a href="../../v5.6.0/index.html">v5.6.0</a></li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
    &copy; Copyright CC-BY 2020, The Clawpack Development Team.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44811544-1', 'auto');
  ga('send', 'pageview');

  </script>
  
  </body>
</html>