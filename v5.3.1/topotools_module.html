
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>topotools module for working with topography data &#8212; Clawpack 5.3.1 documentation</title>
    <link rel="stylesheet" href="_static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/base.css" type="text/css" />
    <link rel="stylesheet" href="_static/layout.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/clawicon.ico"/>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
<div id="main-wrapper" class="sphinx">
<div id="header-wrapper">
  <section id="header">
    <!-- <h1><a href="http://clawpack.org/">Clawpack</a></h1> -->
    <h1><a href="http://clawpack.org/">Clawpack-5</a></h1> 
    <nav>
      <ul>
        <li>
          <a href="contents.html">Docs</a>
        </li>
        <li>
          <a href="installing.html">Install</a>
        </li>
        <li>
          <a class="" href="http://clawpack.org/gallery/index.html">Gallery</a>
        </li>
        <li>
          <a href="about.html">Citation</a>
        </li>
        <li>
          <a class="active" href="http://github.com/clawpack">GitHub</a>
        </li>
        <li>
          <a class="" href="community.html">Community</a>
        </li>
        <li>
          <a class="" href="developers.html">Contribute</a>
        </li>
      </ul>
    </nav>
  </section>
<div class="decoration"></div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="contents.html">Clawpack 5.3.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="topotools-module-for-working-with-topography-data">
<span id="topotools-module"></span><h1>topotools module for working with topography data<a class="headerlink" href="#topotools-module-for-working-with-topography-data" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This describes new tools added in Clawpack 5.2.1</p>
</div>
<p><a class="reference external" href="http://nbviewer.ipython.org/url/clawpack.github.io/notebooks/topotools_examples.ipynb">This IPython notebook</a>
illustrates how to use some of the tools.</p>
<p>The file <cite>$CLAW/geoclaw/tests/test_topotools.py</cite> contains some tests of these
tools.  Looking at these test routines may also give some ideas on
how to use them.</p>
<div class="section" id="module-clawpack.geoclaw.topotools">
<span id="documentation-auto-generated-from-the-module-docstrings"></span><h2>Documentation auto-generated from the module docstrings<a class="headerlink" href="#module-clawpack.geoclaw.topotools" title="Permalink to this headline">¶</a></h2>
<p>GeoClaw topotools Module  <cite>$CLAW/geoclaw/src/python/geoclaw/topotools.py</cite></p>
<p>Module provides several functions for reading, writing and manipulating
topography (bathymetry) files.</p>
<dl class="field-list simple">
<dt class="field-odd">Classes</dt>
<dd class="field-odd"><ul class="simple">
<li><p>Topography</p></li>
</ul>
</dd>
<dt class="field-even">Functions</dt>
<dd class="field-even"><ul class="simple">
<li><p>determine_topo_type</p></li>
<li><p>create_topo_func</p></li>
<li><p>topo1writer</p></li>
<li><p>topo2writer</p></li>
<li><p>topo3writer</p></li>
<li><p>swapheader</p></li>
</ul>
</dd>
<dt class="field-odd">TODO</dt>
<dd class="field-odd"><ul class="simple">
<li><p>Add sub and super sampling capababilities</p></li>
<li><p>Add functions for creating topography based off a topo function, incorporate
the create_topo_func into Topography class, maybe allow more broad 
initialization ability to the class to handle this?</p></li>
<li><p>Fix <cite>in_poly</cite> function</p></li>
<li><p>Add remove/fill no data value</p></li>
<li><p>Add more robust plotting capabilities</p></li>
</ul>
</dd>
</dl>
<dl class="class">
<dt id="clawpack.geoclaw.topotools.Topography">
<em class="property">class </em><code class="sig-prename descclassname">clawpack.geoclaw.topotools.</code><code class="sig-name descname">Topography</code><span class="sig-paren">(</span><em class="sig-param">path=None</em>, <em class="sig-param">topo_func=None</em>, <em class="sig-param">topo_type=None</em>, <em class="sig-param">unstructured=False</em><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.Topography" title="Permalink to this definition">¶</a></dt>
<dd><p>Base topography class.</p>
<p>A class representing a single topography file.</p>
<dl class="field-list simple">
<dt class="field-odd">Properties</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>Note: Modified to check the <cite>grid_registration</cite> when reading or writing
topo files and properly deal with <cite>llcorner</cite> registration in which case
the x,y data should be offset by dx/2, dy/2 from the lower left corner 
specified in the header of a DEM file.</p>
<dl class="field-list">
<dt class="field-odd">Initialization</dt>
<dd class="field-odd"><ul class="simple">
<li></li>
</ul>
</dd>
<dt class="field-even">Examples</dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">clawpack.geoclaw.topotools</span> <span class="k">as</span> <span class="nn">topo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topo_file</span> <span class="o">=</span> <span class="n">topo</span><span class="o">.</span><span class="n">Topography</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topo_file</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;./topo.tt3&#39;</span><span class="p">,</span> <span class="n">topo_type</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topo_file</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="clawpack.geoclaw.topotools.Topography.X">
<em class="property">property </em><code class="sig-name descname">X</code><a class="headerlink" href="#clawpack.geoclaw.topotools.Topography.X" title="Permalink to this definition">¶</a></dt>
<dd><p>Two dimensional coordinate array in x direction.</p>
</dd></dl>

<dl class="method">
<dt id="clawpack.geoclaw.topotools.Topography.Y">
<em class="property">property </em><code class="sig-name descname">Y</code><a class="headerlink" href="#clawpack.geoclaw.topotools.Topography.Y" title="Permalink to this definition">¶</a></dt>
<dd><p>Two dimensional coordinate array in y direction.</p>
</dd></dl>

<dl class="method">
<dt id="clawpack.geoclaw.topotools.Topography.Z">
<em class="property">property </em><code class="sig-name descname">Z</code><a class="headerlink" href="#clawpack.geoclaw.topotools.Topography.Z" title="Permalink to this definition">¶</a></dt>
<dd><p>A representation of the data as a 2d array.</p>
</dd></dl>

<dl class="method">
<dt id="clawpack.geoclaw.topotools.Topography.crop">
<code class="sig-name descname">crop</code><span class="sig-paren">(</span><em class="sig-param">filter_region=None</em>, <em class="sig-param">coarsen=1</em><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.Topography.crop" title="Permalink to this definition">¶</a></dt>
<dd><p>Crop region to <em>filter_region</em></p>
<p>Create a new Topography object that is identical to this one but cropped
to the region specified by filter_region</p>
<dl class="field-list simple">
<dt class="field-odd">TODO</dt>
<dd class="field-odd"><ul class="simple">
<li><p>Currently this does not work for unstructured data, could in principle</p></li>
<li><p>This could be a special case of in_poly although that routine could
leave the resulting topography as unstructured effectively.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="clawpack.geoclaw.topotools.Topography.delta">
<em class="property">property </em><code class="sig-name descname">delta</code><a class="headerlink" href="#clawpack.geoclaw.topotools.Topography.delta" title="Permalink to this definition">¶</a></dt>
<dd><p>Spacing of data points.</p>
</dd></dl>

<dl class="method">
<dt id="clawpack.geoclaw.topotools.Topography.extent">
<em class="property">property </em><code class="sig-name descname">extent</code><a class="headerlink" href="#clawpack.geoclaw.topotools.Topography.extent" title="Permalink to this definition">¶</a></dt>
<dd><p>Extent of the topography.</p>
</dd></dl>

<dl class="method">
<dt id="clawpack.geoclaw.topotools.Topography.generate_2d_coordinates">
<code class="sig-name descname">generate_2d_coordinates</code><span class="sig-paren">(</span><em class="sig-param">mask=False</em><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.Topography.generate_2d_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate 2d coordinate arrays.</p>
</dd></dl>

<dl class="method">
<dt id="clawpack.geoclaw.topotools.Topography.generate_2d_topo">
<code class="sig-name descname">generate_2d_topo</code><span class="sig-paren">(</span><em class="sig-param">mask=False</em><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.Topography.generate_2d_topo" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a 2d array of the topo.</p>
</dd></dl>

<dl class="method">
<dt id="clawpack.geoclaw.topotools.Topography.in_poly">
<code class="sig-name descname">in_poly</code><span class="sig-paren">(</span><em class="sig-param">polygon</em><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.Topography.in_poly" title="Permalink to this definition">¶</a></dt>
<dd><p>Mask points (x,y) that are not in the specified polygon.</p>
<p>Uses simple ray casting algorithm for speed so beware of corner cases!</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><em>polygon</em> (list) List of points that comprise the polygon.  Note that
order of the points will effect if this works (positive versus negative
winding order).  Points should be in counter-clockwise arrangement.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><ul class="simple">
<li><p><em>X_mask</em> (numpy.ma.MaskedArray) Masked array of X coordinates where those
points outside of the polygon have been masked.</p></li>
<li><p><em>Y</em> (numpy.ndarray) Coordinates in y direction in a meshgrid type of
configuration.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="clawpack.geoclaw.topotools.Topography.interp_unstructured">
<code class="sig-name descname">interp_unstructured</code><span class="sig-paren">(</span><em class="sig-param">fill_topo</em>, <em class="sig-param">extent=None</em>, <em class="sig-param">method='nearest'</em>, <em class="sig-param">delta=None</em>, <em class="sig-param">delta_limit=20.0</em>, <em class="sig-param">no_data_value=-9999</em>, <em class="sig-param">buffer_length=100.0</em>, <em class="sig-param">proximity_radius=100.0</em>, <em class="sig-param">resolution_limit=2000</em><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.Topography.interp_unstructured" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate unstructured data on to regular grid.</p>
<p>Function to interpolate the unstructured data in the topo object onto a
structured grid.  Utilizes a bounding box plus a buffer of size 
<em>buffer_length</em> (meters) containing all data unless <em>extent is not None</em>
is <em>True</em>.  Then uses the fill topography <em>fill_topo</em> to fill in the
gaps in the unstructured data.  By default this is done by masking the 
fill data with the extents, the value <em>no_data_value</em> and if 
<em>proximity_radius</em> (meters) is not 0, by a radius of <em>proximity_radius</em> 
from all grid points in the object.  Stores the 
result in the <em>self.X</em>, <em>self.Y</em> and <em>self.Z</em> object attributes.  The
resolution of the final grid is determined by calculating the minimum
distance between all <em>x</em> and <em>y</em> data with a hard lower limit of 
<em>delta_limit</em> (meters).</p>
<p>Note that the function <em>scipy.interpolate.griddata</em> does not respect
masks so a call to <em>numpy.ma.MaskedArray.compressed()</em> must be made to 
remove the masked data.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><em>fill_topo</em> (list) - List of Topography objects to use as fill data
in the projection.</p></li>
<li><p><em>extent</em> (tuple) - A tuple defining the rectangle of the sub-section.  
Must be in the form (x lower,x upper,y lower, y upper).</p></li>
<li><p><em>method</em> (string) - Method used for interpolation, valid methods are
found in <em>scipy.interpolate.griddata</em>.  Default is <em>nearest</em>.</p></li>
<li><p><em>delta</em> (tuple) - Directly set the grid spacing of the interpolation
rather than determining it from the data itself.  Defaults to <em>None</em>
which causes the method to determine this value itself.
Should be a 2-tuple of floats (delta_x, delta_y).</p></li>
<li><p><em>delta_limit</em> (float) - Limit of finest horizontal resolution, 
default is 20 meters.</p></li>
<li><p><em>no_data_value</em> (float) - Value to use if no data was found to fill in a 
missing value, ignored if <cite>method = ‘nearest’</cite>. Default is <cite>-9999</cite>.</p></li>
<li><p><em>buffer_length</em> (float) - Buffer around bounding box, only applicable
when <em>extent</em> is None.  Default is <cite>100.0</cite> meters.</p></li>
<li><p><em>proximity_radius</em> (float) - Radius every unstructured data point
used to mask the fill data with.  Default is <cite>100.0</cite> meters.</p></li>
<li><p><em>resolution_limit</em> (int) - Limit the number of grid points in a
single dimension.  Raises a <em>ValueError</em> if the limit is violated.
Default value is <cite>2000</cite>.</p></li>
</ul>
</dd>
</dl>
<p>Sets this object’s <em>unstructured</em> attribute to <em>False</em> if successful.</p>
</dd></dl>

<dl class="method">
<dt id="clawpack.geoclaw.topotools.Topography.make_shoreline_xy">
<code class="sig-name descname">make_shoreline_xy</code><span class="sig-paren">(</span><em class="sig-param">sea_level=0</em><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.Topography.make_shoreline_xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an array <em>shoreline_xy</em> with 2 columns containing x and y values
for all segements of the shoreline (defined to be the contour 
where self.z = sea_level) separated by [nan,nan] pairs.  
This allows all shorelines to be quickly plotted via:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span><span class="p">(</span><span class="n">shoreline_xy</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">shoreline_xy</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>The shoreline can be saved as a binary <em>.npy</em> file via:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">numpy</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">shoreline_xy</span><span class="p">)</span>
</pre></div>
</div>
<p>which is much smaller than the original topography file. 
Reload via:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">shoreline_xy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="clawpack.geoclaw.topotools.Topography.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param">axes=None</em>, <em class="sig-param">contour_levels=None</em>, <em class="sig-param">contour_kwargs={}</em>, <em class="sig-param">limits=None</em>, <em class="sig-param">cmap=None</em>, <em class="sig-param">add_colorbar=True</em>, <em class="sig-param">plot_box=False</em>, <em class="sig-param">fig_kwargs={}</em>, <em class="sig-param">data_break=0.0</em>, <em class="sig-param">cb_kwargs={}</em><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.Topography.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the topography.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><em>axes</em> (matplotlib.pyplot.axes) - If passed in, plot will be
added to this axes.  Otherwise a new plot figure will be created
(using <em>fig_kwargs</em>) and a new <em>axes</em> object created and returned.</p></li>
<li><p><em>contour_levels</em> (list) - levels for contour lines if these are 
to be added (default <em>None</em>).  Set to [0.] to plot shoreline.</p></li>
<li><p><em>contour_kwargs</em> (dict) - keyword arguments to be passed to
contour command, e.g. {‘colors’:’r’, ‘linestyles’: ‘-‘}.
Default is empty dict.</p></li>
<li><p><em>limits</em> (list) - (min, max) of topo values for color map.  
Defaults to None, in which case (self.Z.min(), self.Z.max()) used.</p></li>
<li><p><em>cmap</em> (matplotlib.colors.Colormap) - colormap, defaults to
specialized map with blues for bathymetry and green/browns for topo.</p></li>
<li><p><em>fig_kwargs</em> (dict) - keyword arguments to be passed to figure.</p></li>
<li><p><em>plot_box</em> (bool or color specifier) - If evaluates to True, plot
a box around limits of this topo.</p></li>
<li><p><em>data_break</em> (float) - when default cmap is used, the value to use
to break between water and land colormaps.
Defaults to 0., but for some topo files may need to use e.g. 0.01
Or may want to show plots at different tide stage.</p></li>
<li><p><em>cb_kwargs</em> (dict) - keyword arguments to be passed to colorbar
e.g. ‘shrink’, ‘extend’, ‘label’.  Can also set ‘title’ for cbar</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><ul class="simple">
<li><p><em>axes</em> (matplotlib.pyplot.axes) - the axes on which plot created.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Note that:</dt><dd><ul class="simple">
<li><p>if <em>type(self.Z)</em> is <em>numpy.ma.MaskedArray</em> then <em>pcolor</em> is used,</p></li>
<li><p>if <em>type(self.Z)</em> is <em>numpy.ndarray</em> then <em>imshow</em> is used.
(This is faster for large files)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="clawpack.geoclaw.topotools.Topography.read">
<code class="sig-name descname">read</code><span class="sig-paren">(</span><em class="sig-param">path=None, topo_type=None, unstructured=False, mask=False, filter_region=None, force=False, stride=[1, 1], nc_params={}</em><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.Topography.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in the data from the object’s <em>path</em> attribute.</p>
<p>Stores the resulting data in one of the sets of <em>x</em>, <em>y</em>, and <em>z</em> or 
<em>X</em>, <em>Y</em>, and <em>Z</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><em>path</em> (str)  file to read</p></li>
<li><p><em>topo_type</em> (int) - GeoClaw format topo_type</p></li>
<li><p><em>unstructured</em> (bool) - default is False for lat-long grids.</p></li>
<li><p><em>mask</em> (bool) - whether to store as masked array for missing
values (default if False)</p></li>
<li><p><em>filter_region</em> (tuple)</p></li>
<li><p><em>stride</em> (list) - List of strides for the x and y dimensions
respectively.  Default is <em>[1, 1]</em>.  Note that this is only
implemented for NetCDF reading currently.</p></li>
<li><p><em>nc_params</em> (dict) -</p></li>
</ul>
</dd>
</dl>
<p>The first three might have already been set when instatiating object.</p>
</dd></dl>

<dl class="method">
<dt id="clawpack.geoclaw.topotools.Topography.read_header">
<code class="sig-name descname">read_header</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.Topography.read_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in header of topography file at path.</p>
<p>If a value returns numpy.nan then the value was not retrievable.  Note
that this routine can read in headers whose values and labels are 
swapped.</p>
</dd></dl>

<dl class="method">
<dt id="clawpack.geoclaw.topotools.Topography.replace_no_data_values">
<code class="sig-name descname">replace_no_data_values</code><span class="sig-paren">(</span><em class="sig-param">method='fill'</em><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.Topography.replace_no_data_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace <em>no_data_value</em> with other values as specified by <em>method</em>.</p>
<p>self.no_data_value</p>
<dl class="field-list">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul>
<li><p><em>method</em> can be one of:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>fill</em> - Fill in all <em>no_data_value</em> locations with <em>value</em></p></li>
<li><p><em>nearest</em> - Fill in <em>no_data_value</em> locations with 
average of nearest neighbors.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="clawpack.geoclaw.topotools.Topography.replace_values">
<code class="sig-name descname">replace_values</code><span class="sig-paren">(</span><em class="sig-param">indices</em>, <em class="sig-param">value=nan</em>, <em class="sig-param">method='fill'</em><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.Topography.replace_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace the values at <em>indices</em> by the specified method</p>
<dl class="field-list simple">
<dt class="field-odd">Methods</dt>
<dd class="field-odd"><ul class="simple">
<li><p>“fill”</p></li>
<li><p>“nearest”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="clawpack.geoclaw.topotools.Topography.set_xyZ">
<code class="sig-name descname">set_xyZ</code><span class="sig-paren">(</span><em class="sig-param">X</em>, <em class="sig-param">Y</em>, <em class="sig-param">Z</em><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.Topography.set_xyZ" title="Permalink to this definition">¶</a></dt>
<dd><p>Set _x, _y, and _Z attributes and then generate X,Y,Z.</p>
<p>If X,Y are 1d arrays, then shape of Z should be (len(Y), len(X)).</p>
<p>Allow X,Y to be 2d arrays of shape Z.shape, in which case
first extract x,y</p>
</dd></dl>

<dl class="method">
<dt id="clawpack.geoclaw.topotools.Topography.smooth_data">
<code class="sig-name descname">smooth_data</code><span class="sig-paren">(</span><em class="sig-param">indices</em>, <em class="sig-param">r=1</em><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.Topography.smooth_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter topo data at <em>indices</em> by averaging surrounding data.</p>
<p>Surrounding data is considered within the ball of radius <em>r</em> in the 
inf-norm.  Acts as a low-band pass filter and removes oscillatory data.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><em>indices</em> (list)</p></li>
<li><p><em>r</em> (int)</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="clawpack.geoclaw.topotools.Topography.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">topo_type=None</em>, <em class="sig-param">no_data_value=None</em>, <em class="sig-param">fill_value=None</em>, <em class="sig-param">header_style='geoclaw'</em>, <em class="sig-param">Z_format='%15.7e'</em>, <em class="sig-param">grid_registration=None</em><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.Topography.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write out a topography file to path of type <em>topo_type</em>.</p>
<p>Writes out a topography file of topo type specified with <em>topo_type</em> or
inferred from the output file’s extension, defaulting to 3, to path
from data in Z.  The rest of the arguments are used to write the header
data.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><em>path</em> (str)  - file to write</p></li>
<li><p><em>topo_type</em> (int) - GeoClaw format topo_type 
<strong>Note:</strong> this is second positional argument, agreeing with
the read function in this class.  It was the third argument in
GeoClaw version 5.3.1 and earlier.</p></li>
<li><p><em>no_data_value</em> - values used to indicate missing data</p></li>
<li><p><em>fill_value</em> (float) - value to use if filling a masked array</p></li>
<li><dl class="simple">
<dt><em>header_style</em> (str) - indicates format of header lines</dt><dd><dl class="simple">
<dt>‘geoclaw’ or ‘default’  ==&gt; write value then label </dt><dd><p>with grid_registration == ‘lower’ as default</p>
</dd>
<dt>‘arcgis’ or ‘asc’ ==&gt; write label then value  </dt><dd><p>with grid_registration == ‘llcorner’ as default
(needed for .asc files in ArcGIS)</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><p><em>Z_format</em> (str) - string format to use for Z values
The default format “%15.7e” gives at least millimeter precision
for topography with abs(Z) &lt; 10000 and results in
smaller files than the previous default of “%22.15e” used in
GeoClaw version 5.3.1 and earlier.  A shorter format can be used
if the user knows there are fewer significant digits, e.g.
etopo1 data is integers and so has a resolution of 1 meter.
In this case a cropped or coarsened version might be written
with <cite>Z_format = “%7i”</cite>, for example.</p></li>
<li><dl class="simple">
<dt><em>grid_registration</em> (str) - ‘lower’, ‘llcorner’, ‘llcenter’ </dt><dd><p>or None for defaults described above.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="clawpack.geoclaw.topotools.Topography.x">
<em class="property">property </em><code class="sig-name descname">x</code><a class="headerlink" href="#clawpack.geoclaw.topotools.Topography.x" title="Permalink to this definition">¶</a></dt>
<dd><p>One dimensional coorindate array in x direction.</p>
</dd></dl>

<dl class="method">
<dt id="clawpack.geoclaw.topotools.Topography.y">
<em class="property">property </em><code class="sig-name descname">y</code><a class="headerlink" href="#clawpack.geoclaw.topotools.Topography.y" title="Permalink to this definition">¶</a></dt>
<dd><p>One dimensional coordinate array in y direction.</p>
</dd></dl>

<dl class="method">
<dt id="clawpack.geoclaw.topotools.Topography.z">
<em class="property">property </em><code class="sig-name descname">z</code><a class="headerlink" href="#clawpack.geoclaw.topotools.Topography.z" title="Permalink to this definition">¶</a></dt>
<dd><p>A representation of the data as an 1d array.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="clawpack.geoclaw.topotools.create_topo_func">
<code class="sig-prename descclassname">clawpack.geoclaw.topotools.</code><code class="sig-name descname">create_topo_func</code><span class="sig-paren">(</span><em class="sig-param">loc</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.create_topo_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a 1-dimensional topography profile specfied by a set of (x,z) 
values, create a lambda function that when evaluated will give the 
topgraphy at the point (x,y).  (The resulting function is constant in y.)</p>
<dl class="field-list">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">create_topo_func</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul>
<li><p><em>loc</em> (list) - Create a topography file with the profile denoted by the
tuples inside of loc.  A sample set of points are shown below.  Note 
that the first value of the list is the x location and the second is 
the height of the topography.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="o">^</span>                                                  <span class="n">o</span> <span class="n">loc</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>  <span class="n">o</span>
<span class="o">|</span>                                                    
<span class="o">|</span>                                          <span class="n">loc</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>   
<span class="o">|--------------------------------------------</span><span class="n">o</span><span class="o">-----&gt;</span> <span class="n">x</span> <span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="p">(</span><span class="n">sea</span> <span class="n">level</span><span class="p">)</span>
<span class="o">|</span>                                            
<span class="o">|</span>                                <span class="n">o</span> <span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">o</span> <span class="n">loc</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="o">|</span>                         
<span class="o">|</span>                         
<span class="o">|</span>                           <span class="n">o</span> <span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="o">|</span>           
<span class="o">|</span>                               
<span class="o">|</span><span class="n">__________________o</span> <span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="mf">0.0</span>               
</pre></div>
</div>
</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="clawpack.geoclaw.topotools.determine_topo_type">
<code class="sig-prename descclassname">clawpack.geoclaw.topotools.</code><code class="sig-name descname">determine_topo_type</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">default=None</em><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.determine_topo_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Using the file suffix of path, attempt to deterimine the topo type.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><em>path</em> (string) - Path to the file.  Can include archive extensions (they
will be stripped off).</p></li>
<li><p><em>default</em> (object) - Value returned if no suitable topo type was 
determined.  Default is <em>None</em>.</p></li>
</ul>
</dd>
</dl>
<p>returns integer between 1-3 or <em>default</em> if nothing matches.</p>
</dd></dl>

<dl class="function">
<dt id="clawpack.geoclaw.topotools.fetch_topo_url">
<code class="sig-prename descclassname">clawpack.geoclaw.topotools.</code><code class="sig-name descname">fetch_topo_url</code><span class="sig-paren">(</span><em class="sig-param">url</em>, <em class="sig-param">local_fname=None</em>, <em class="sig-param">force=None</em>, <em class="sig-param">verbose=False</em>, <em class="sig-param">ask_user=False</em><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.fetch_topo_url" title="Permalink to this definition">¶</a></dt>
<dd><p>DEPRECATED:  Use <em>clawpack.clawutil.data.get_remote_file</em> instead (see note below).</p>
<p>Replaces get_topo function.</p>
<p>Download a topo file from the web, provided the file does not
already exist locally.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><em>url</em> (str) URL including file name</p></li>
<li><p><em>local_fname</em> (str) name of local file to create.  
If <em>local_fname == None</em>, take file name from URL</p></li>
<li><p><em>force</em> (bool) If False, prompt user before downloading.</p></li>
</ul>
</dd>
</dl>
<p>For GeoClaw examples, some topo files can be found in
<a href="#id1"><span class="problematic" id="id2">`http://www.geoclaw.org/topo`_</span></a>
See that website for a list of archived topo datasets.</p>
<p>If force==False then prompt the user to make sure it’s ok to download,</p>
<p>If force==None then check for environment variable CLAW_TOPO_DOWNLOAD
and if this exists use its value.  This is useful for the script
python/run_examples.py that runs all examples so it won’t stop to prompt.</p>
<p>This routine has been deprecated in favor of 
<em>clawpack.clawutil.data.get_remote_file</em>.  All the functionality should be 
the same but calls the other routine internally.</p>
</dd></dl>

<dl class="function">
<dt id="clawpack.geoclaw.topotools.get_topo">
<code class="sig-prename descclassname">clawpack.geoclaw.topotools.</code><code class="sig-name descname">get_topo</code><span class="sig-paren">(</span><em class="sig-param">topo_fname</em>, <em class="sig-param">remote_directory</em>, <em class="sig-param">force=None</em><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.get_topo" title="Permalink to this definition">¶</a></dt>
<dd><p>DEPRECATED:  Use <em>clawpack.geoclaw.util.get_remote_file</em> instead</p>
<p>Download a topo file from the web, provided the file does not
already exist locally.</p>
<p>remote_directory should be a URL.  For GeoClaw data it may be a
subdirectory of  <a class="reference external" href="http://www.clawpack.org/geoclaw/topo">http://www.clawpack.org/geoclaw/topo</a>
See that website for a list of archived topo datasets.</p>
<p>If force==False then prompt the user to make sure it’s ok to download,
with option to first get small file of metadata.</p>
<p>If force==None then check for environment variable CLAW_TOPO_DOWNLOAD
and if this exists use its value.  This is useful for the script
python/run_examples.py that runs all examples so it won’t stop to prompt.</p>
</dd></dl>

<dl class="function">
<dt id="clawpack.geoclaw.topotools.read_netcdf">
<code class="sig-prename descclassname">clawpack.geoclaw.topotools.</code><code class="sig-name descname">read_netcdf</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">zvar=None</em>, <em class="sig-param">extent='all'</em>, <em class="sig-param">coarsen=1</em>, <em class="sig-param">return_topo=True</em>, <em class="sig-param">return_xarray=False</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.read_netcdf" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><em>path</em> (str) - Path to the file to read, or url to remote file,
or a key into the topotools.remote_topo_urls dictionary.</p></li>
<li><p><em>zvar</em> (str) - variable to read as Z=elevation. 
if None, will try ‘Band1’, ‘z’, ‘elevation’.</p></li>
<li><p><em>extent</em> - [x1,x2,y1,y2] for desired subset, or ‘all’ for entire file</p></li>
<li><p><em>coarsen</em> (int) - factor to coarsen by, 1 by default.</p></li>
<li><p><em>return_topo</em> (bool) - if True, return a topotools.Topography object.
default is True</p></li>
<li><p><em>return_xarray</em> (bool) - if True, return an xarray.Dataset object.
default is False</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><ul class="simple">
<li><p>topo and/or xarray_ds depending on what was requested.
(either a single object or a tuple of two objects.)</p></li>
</ul>
</dd>
</dl>
<p>If <cite>return_xarray == True</cite> then <cite>xarray</cite> is used to read the data,
otherwise <cite>netCDF4</cite> is used directly.</p>
<p>Sample usage:</p>
<blockquote>
<div><p>from clawpack.geoclaw import topotools
extent = [-126,-122,46,49]
path = ‘etopo1’
topo = topotools.read_netcdf(path, extent=extent, coarsen=2,                                      verbose=True)</p>
<p># to plot:
topo.plot()</p>
<p># to save topofile for input to GeoClaw:
topo.write(‘etopo_sample_2min.tt3’, topo_type=3, Z_format=’%.0f’)</p>
</div></blockquote>
<p>This should give a 2-minute resolution DEM of the Western Washington coast.
Note that etopo1 Z values are integers (vertical resolution is 1 meter)
and using <cite>Z_format=’%.0f’</cite> will save as integers to minimize file size.</p>
</dd></dl>

<dl class="function">
<dt id="clawpack.geoclaw.topotools.swapheader">
<code class="sig-prename descclassname">clawpack.geoclaw.topotools.</code><code class="sig-name descname">swapheader</code><span class="sig-paren">(</span><em class="sig-param">inputfile</em>, <em class="sig-param">outputfile</em><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.swapheader" title="Permalink to this definition">¶</a></dt>
<dd><p>Swap the order of key and value in header to value first.</p>
<p>Note that this is a wrapper around functionality in the Topography class.</p>
</dd></dl>

<dl class="function">
<dt id="clawpack.geoclaw.topotools.topo1writer">
<code class="sig-prename descclassname">clawpack.geoclaw.topotools.</code><code class="sig-name descname">topo1writer</code><span class="sig-paren">(</span><em class="sig-param">outfile</em>, <em class="sig-param">topo</em>, <em class="sig-param">xlower</em>, <em class="sig-param">xupper</em>, <em class="sig-param">ylower</em>, <em class="sig-param">yupper</em>, <em class="sig-param">nxpoints</em>, <em class="sig-param">nypoints</em><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.topo1writer" title="Permalink to this definition">¶</a></dt>
<dd><p>Function topo1writer will write out the topofiles by evaluating the
function topo on the grid specified by the other parameters.</p>
<p>Assumes topo can be called on arrays X,Y produced by numpy.meshgrid.</p>
<p>Output file is of “topotype1,” which we use to refer to a file with
(x,y,z) values on each line, progressing from upper left corner across
rows, then down.</p>
</dd></dl>

<dl class="function">
<dt id="clawpack.geoclaw.topotools.topo2writer">
<code class="sig-prename descclassname">clawpack.geoclaw.topotools.</code><code class="sig-name descname">topo2writer</code><span class="sig-paren">(</span><em class="sig-param">outfile</em>, <em class="sig-param">topo</em>, <em class="sig-param">xlower</em>, <em class="sig-param">xupper</em>, <em class="sig-param">ylower</em>, <em class="sig-param">yupper</em>, <em class="sig-param">nxpoints</em>, <em class="sig-param">nypoints</em>, <em class="sig-param">nodata_value=-99999</em><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.topo2writer" title="Permalink to this definition">¶</a></dt>
<dd><p>Write out a topo type 2 file by evaluating the function <em>topo</em>.</p>
<p>This routine is here for backwards compatibility and simply creates a new
topography object and writes it out.</p>
</dd></dl>

<dl class="function">
<dt id="clawpack.geoclaw.topotools.topo3writer">
<code class="sig-prename descclassname">clawpack.geoclaw.topotools.</code><code class="sig-name descname">topo3writer</code><span class="sig-paren">(</span><em class="sig-param">outfile</em>, <em class="sig-param">topo</em>, <em class="sig-param">xlower</em>, <em class="sig-param">xupper</em>, <em class="sig-param">ylower</em>, <em class="sig-param">yupper</em>, <em class="sig-param">nxpoints</em>, <em class="sig-param">nypoints</em>, <em class="sig-param">nodata_value=-99999</em><span class="sig-paren">)</span><a class="headerlink" href="#clawpack.geoclaw.topotools.topo3writer" title="Permalink to this definition">¶</a></dt>
<dd><p>Write out a topo type 3 file by evaluating the function <em>topo</em>.</p>
<p>This routine is here for backwards compatibility and simply creates a new
topography object and writes it out.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p><a href="http://clawpack.org/">
    <img class="logo" src= "_static/clawlogo.jpg" alt="Logo"/>
</a>
<h2>Version 5.3.1</h2>
</p>
  <h3><a href="contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">topotools module for working with topography data</a><ul>
<li><a class="reference internal" href="#module-clawpack.geoclaw.topotools">Documentation auto-generated from the module docstrings</a></li>
</ul>
</li>
</ul>
<h3>Related Topics</h3>
<ul>
  <li><a href="contents.html">Documentation overview</a><ul>
  </ul></li>
</ul>
<div class="widget navlinks">
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/topotools_module.rst.txt"
            rel="nofollow"
            target="_blank">Source .rst</a></li>
    <li><a href="https://github.com/clawpack/doc/blob/dev/doc/topotools_module.rst"
            rel="nofollow"
            target="_blank">Source on GitHub</a></li>
     <li><a href="https://github.com/clawpack/doc/commits/dev/doc/topotools_module.rst"
             rel="nofollow"
             target="_blank">History</a></li>
    <li><a href="https://github.com/clawpack/doc/edit/dev/doc/topotools_module.rst"
            rel="nofollow"
            target="_blank">Suggest Edits</a></li>
     <li><a href="https://github.com/clawpack/doc/issues/new/choose"
             rel="nofollow"
             target="_blank">Raise an Issue</a></li>
  </ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
<h4>Latest Version</h4>
<ul>
  <li><a href="../dev/topotools_module.html">dev</a></li>
  <li><a href="../v5.7.0/topotools_module.html">v5.7.0</a></li>
</ul>
<h4>Older Versions</h4>
<ul>
  <li><a href="../v5.1.0/index.html">v5.1.0</a></li>
  <li><a href="../v5.2.0/index.html">v5.2.0</a></li>
  <li><a href="../v5.2.1/topotools_module.html">v5.2.1</a></li>
  <li><a href="../v5.3.0/topotools_module.html">v5.3.0</a></li>
  <li><a href="topotools_module.html">v5.3.1</a></li>
  <li><a href="../v5.4.0/topotools_module.html">v5.4.0</a></li>
  <li><a href="../v5.4.1/topotools_module.html">v5.4.1</a></li>
  <li><a href="../v5.5.0/topotools_module.html">v5.5.0</a></li>
  <li><a href="../v5.6.0/topotools_module.html">v5.6.0</a></li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
    &copy; Copyright CC-BY 2020, The Clawpack Development Team.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44811544-1', 'auto');
  ga('send', 'pageview');

  </script>
  
  </body>
</html>