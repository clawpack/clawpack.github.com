<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Developers’ Guide &#8212; Clawpack 5.2.1 documentation</title>
    
    <link rel="stylesheet" href="_static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/base.css" type="text/css" />
    <link rel="stylesheet" href="_static/layout.css" type="text/css" />
    <link rel="stylesheet" href="_static/banner.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '5.2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/clawicon.ico"/>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="git resources" href="git_resources.html" />
    <link rel="prev" title="Riemann Solver Package" href="pyclaw/rp.html" /> 
  </head>
  <body role="document">
<div id="main-wrapper" class="sphinx">
<div id="header-wrapper">
  <section id="header">
    <!-- <h1><a href="http://clawpack.org/">Clawpack</a></h1> -->
    <h1><a href="http://clawpack.org/">Clawpack-5</a></h1> 
    <nav>
      <ul>
        <li>
          <a href="toc_condensed.html">Docs</a>
        </li>
        <li>
          <a href="installing.html">Install</a>
        </li>
        <li>
          <a class="" href="galleries.html">Gallery</a>
        </li>
        <li>
          <a class="active" href="https://groups.google.com/forum/#!forum/claw-users">Support</a>
        </li>
        <li>
          <a class="active" href="http://github.com/organizations/clawpack">Source</a>
        </li>
        <li>
          <a class="" href="#">Develop</a>
        </li>
      </ul>
    </nav>
  </section>
<div class="decoration"></div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="git_resources.html" title="git resources"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pyclaw/rp.html" title="Riemann Solver Package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="contents.html">Clawpack 5.2.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="developers-guide">
<span id="developers"></span><h1>Developers&#8217; Guide<a class="headerlink" href="#developers-guide" title="Permalink to this headline">¶</a></h1>
<p>See <a class="reference internal" href="pyclaw/devel/gitwash/git_resources.html#git-resources"><span class="std std-ref">git resources</span></a> for some useful links.</p>
<div class="section" id="cloning-the-most-recent-code-from-github">
<span id="developers-gitclone"></span><h2>Cloning the most recent code from Github<a class="headerlink" href="#cloning-the-most-recent-code-from-github" title="Permalink to this headline">¶</a></h2>
<p>You can create a read-only development version of Clawpack via:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">git</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">clawpack</span><span class="o">/</span><span class="n">clawpack</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">clawpack</span>
<span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">git</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
<p>This downloads the following clawpack modules as subrepositories checked out at
specific commits (as opposed to the tip of a branch).</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/clawpack/pyclaw">https://github.com/clawpack/pyclaw</a>  (Python code, some of which is
needed also for Fortran version)</li>
<li><a class="reference external" href="https://github.com/clawpack/clawutil">https://github.com/clawpack/clawutil</a> (Utility functions,
Makefile.common used in multiple repositories)</li>
<li><a class="reference external" href="https://github.com/clawpack/classic">https://github.com/clawpack/classic</a>  (Classic single-grid code)</li>
<li><a class="reference external" href="https://github.com/clawpack/amrclaw">https://github.com/clawpack/amrclaw</a> (AMR version of Fortran code)</li>
<li><a class="reference external" href="https://github.com/clawpack/riemann">https://github.com/clawpack/riemann</a>  (Riemann solvers)</li>
<li><a class="reference external" href="https://github.com/clawpack/visclaw">https://github.com/clawpack/visclaw</a>  (Python graphics and
visualization tools)</li>
<li><a class="reference external" href="https://github.com/clawpack/geoclaw">https://github.com/clawpack/geoclaw</a>  (GeoClaw)</li>
</ul>
<p>This should give a snapshot of the repositories that work well together.
(Note that there are many inter-dependencies between code in the
repositories and checking out a different commit in one repository may break
things in a different repository.)</p>
<p>If you want to also install the PyClaw Python components, you can then do:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>
</div>
<p>If you plan to work on the Python parts of Clawpack as a developer, you may instead
wish to do:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">e</span> <span class="o">.</span>
</pre></div>
</div>
<p>The advantage of this is that when you edit Python code in your clawpack directly,
it will immediately take effect, without the need to install again.  However,
the (potential) danger of this approach is that the path to your clawpack
directory will be stored in the file site-packages/easy-install.pth and
prepended to your PYTHONPATH whenever you run Python.  This path will
take precedence over any manually added paths, unless you delete the .pth
file.</p>
<p>If you want to use the Fortran versions in <cite>classic</cite>, <cite>amrclaw</cite>, <cite>geoclaw</cite>,
etc., you need to set environment variables and proceed as described at
<a class="reference internal" href="installing.html#setenv"><span class="std std-ref">Set environment variables</span></a>.</p>
</div>
<div class="section" id="installation-instructions-for-developers">
<span id="setup-dev"></span><h2>Installation instructions for developers<a class="headerlink" href="#installation-instructions-for-developers" title="Permalink to this headline">¶</a></h2>
<p>Install a read-only copy of all the main repositories as described above in
<a class="reference internal" href="#developers-gitclone"><span class="std std-ref">Cloning the most recent code from Github</span></a>.</p>
<p><strong>Important Note:</strong> The repositories will each be checked out to a specific commit and
will probably be in a detached-head state.  You will need to checkout
<cite>master</cite> in each repository to see the current head of the master branch.</p>
<p>You should never commit to <cite>master</cite>, only to a feature branch, so
the <cite>master</cite> branch should always reflect what&#8217;s in the main
<em>clawpack</em> repository.  You can update it to reflect any changes via:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">checkout</span> <span class="n">master</span>
<span class="n">git</span> <span class="n">fetch</span> <span class="n">origin</span>
<span class="n">git</span> <span class="n">merge</span> <span class="n">origin</span><span class="o">/</span><span class="n">master</span>
</pre></div>
</div>
<p>or simply:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">pull</span> <span class="n">origin</span> <span class="n">master</span><span class="p">:</span><span class="n">master</span>
</pre></div>
</div>
<p>Remember that you need to do this in each repository before running anything
to make sure everything is up to date with <em>master</em>.</p>
</div>
<div class="section" id="setting-a-remote-to-point-to-your-fork">
<span id="dev-remote"></span><h2>Setting a remote to point to your fork<a class="headerlink" href="#setting-a-remote-to-point-to-your-fork" title="Permalink to this headline">¶</a></h2>
<p>If you plan to make changes and issue pull requests to one or more
repositories, you will need to do the following steps for each such
repository:</p>
<ol class="arabic">
<li><p class="first">Go to <a class="reference external" href="http://github.com/clawpack">http://github.com/clawpack</a> and fork the repository to your own
Github account.  (Click on the repository name and then the <em>Fork</em> button
at the top of the screen.)</p>
</li>
<li><p class="first">Add a <em>remote</em> pointing to your repository.  For example, if you have
forked the <cite>amrclaw</cite> repository to account <cite>username</cite>, you would do:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">amrclaw</span>
<span class="n">git</span> <span class="n">remote</span> <span class="n">add</span> <span class="n">username</span> <span class="n">git</span><span class="nd">@github</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="n">username</span><span class="o">/</span><span class="n">amrclaw</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>You should push only to this remote, not to <cite>origin</cite>, e.g.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">push</span> <span class="n">username</span>
</pre></div>
</div>
</li>
</ol>
<p>You might also want to clone some or all of the following repositories:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/clawpack/doc">https://github.com/clawpack/doc</a>  (documentation)</li>
<li><a class="reference external" href="https://github.com/clawpack/apps">https://github.com/clawpack/apps</a>  (To collect applications)</li>
<li><a class="reference external" href="https://github.com/clawpack/regression">https://github.com/clawpack/regression</a>  (Regression tests)</li>
<li><a class="reference external" href="https://github.com/clawpack/clawpack-4.x">https://github.com/clawpack/clawpack-4.x</a>  (Previous versions, 4.6)</li>
</ul>
<p>These are not brought over by cloning the top <cite>clawpack</cite> super-repository.
You can get one of these in read-only mode by doing, e.g.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">git</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">clawpack</span><span class="o">/</span><span class="n">doc</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>Then go through the above steps to add a remote to your own fork of the
repository if you plan to modify and issue pull requests.</p>
</div>
<div class="section" id="modifying-code">
<h2>Modifying code<a class="headerlink" href="#modifying-code" title="Permalink to this headline">¶</a></h2>
<p>Before making changes, you generally want to make sure <em>master</em> is up to
date:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">checkout</span> <span class="n">master</span>
<span class="n">git</span> <span class="n">pull</span>
</pre></div>
</div>
<p>Then create a new branch based on <cite>master</cite> for any new commits:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">checkout</span> <span class="o">-</span><span class="n">b</span> <span class="n">new_feature</span> <span class="n">master</span>

<span class="c1"># make some changes</span>
<span class="c1"># git add the modified files</span>
<span class="n">git</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;describe the changes&quot;</span>
</pre></div>
</div>
<p>Now make changes, add and commit them,
and then push to your own fork:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">push</span> <span class="n">username</span> <span class="n">new_feature</span>
</pre></div>
</div>
<p>If you want these changes pulled into <em>master</em>,
you can issue a pull request from the github page for your fork of this
repository (make sure to select the correct branch of your repository).</p>
<p><strong>Note:</strong> If you accidentally commit to <cite>master</cite> rather than creating a
feature branch first, you can easily recover:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">checkout</span> <span class="o">-</span><span class="n">b</span> <span class="n">new_feature</span>
</pre></div>
</div>
<p>will create a new branch based on the current state and history (including
your commits to <cite>master</cite>) and you can just continue adding additional
commits.</p>
<p>The only problem is your <cite>master</cite> branch no longer agrees with the history
on Github and you want to throw away the commits you made to <cite>master</cite>.  The
easiest way to do this is just to make sure you&#8217;re on a different branch,
e.g.,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">checkout</span> <span class="n">new_feature</span>
</pre></div>
</div>
<p>and then:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">branch</span> <span class="o">-</span><span class="n">D</span> <span class="n">master</span>
<span class="n">git</span> <span class="n">checkout</span> <span class="o">-</span><span class="n">b</span> <span class="n">master</span> <span class="n">origin</span><span class="o">/</span><span class="n">master</span>
</pre></div>
</div>
<p>This deletes your local branch named <cite>master</cite> and recreates a branch with
the same name based on <cite>origin/master</cite>, which is what you want.</p>
</div>
<div class="section" id="pull-requests">
<span id="developers-pr"></span><h2>Pull requests<a class="headerlink" href="#pull-requests" title="Permalink to this headline">¶</a></h2>
<p>Before issuing a pull request, you should make sure you have not broken
anything:</p>
<ol class="arabic">
<li><p class="first">Make sure you are up to date with <em>master</em>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">checkout</span> <span class="n">master</span>
<span class="n">git</span> <span class="n">pull</span>
</pre></div>
</div>
<p>If this does not say &#8220;Already up-to-date&#8221; then you might want to rebase
your modified code onto the updated master.  With your feature branch
checked out, you can see what newer commits have been added to <em>master</em>
via:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">checkout</span> <span class="n">new_feature</span>
<span class="n">git</span> <span class="n">log</span> <span class="n">HEAD</span><span class="o">..</span><span class="n">master</span>
</pre></div>
</div>
<p>If your new feature can be added on to the updated master, you can rebase:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">rebase</span> <span class="n">master</span>
</pre></div>
</div>
<p>which gives a cleaner history than merging the branches.</p>
</li>
<li><p class="first">Run the appropriate regression tests.  If you have modified code
in pyclaw or riemann, then you should run the pyclaw tests.  First,
if you have modified any Fortran code, you need to recompile:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">clawpack</span><span class="o">/</span>
<span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">e</span> <span class="o">.</span>
</pre></div>
</div>
<p>Then run the tests:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">pyclaw</span>
<span class="n">nosetests</span>
</pre></div>
</div>
<p>If any tests fail, you should fix them before issuing a pull request.</p>
</li>
</ol>
<p>To issue a pull request (PR), go to the Github page for your fork of the
repository in question, select the branch from which you want the pull
request to originate, and then click the <em>Pull Request</em> button.</p>
</div>
<div class="section" id="testing-out-a-pull-request">
<span id="test-pr"></span><h2>Testing out a pull request<a class="headerlink" href="#testing-out-a-pull-request" title="Permalink to this headline">¶</a></h2>
<p>To test out someone else&#8217;s pull request, follow these  instructions:
For
example, if you want to try out a pull request coming from a branch named
<em>bug-fix</em> from user <em>rjleveque</em> to the <em>master</em> branch of
the <em>amrclaw</em> repository, you would do:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cd $CLAW/amrclaw   # (and make sure you don&#39;t have uncommitted changes)
git checkout master
git pull  # to make sure you are up to date

git checkout -b rjleveque-bug-fix master
git pull https://github.com/rjleveque/amrclaw.git bug-fix
</pre></div>
</div>
<p>This puts you on a new branch of your own repository named
<em>rjleveque-bug-fix</em> that has the proposed changes pulled into it.</p>
<p>Once you are done testing, you can get rid of this branch via:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">checkout</span> <span class="n">master</span>
<span class="n">git</span> <span class="n">branch</span> <span class="o">-</span><span class="n">D</span> <span class="n">rjleveque</span><span class="o">-</span><span class="n">bug</span><span class="o">-</span><span class="n">fix</span>
</pre></div>
</div>
</div>
<div class="section" id="top-level-pull-requests">
<span id="toplevel-pr"></span><h2>Top level pull requests<a class="headerlink" href="#top-level-pull-requests" title="Permalink to this headline">¶</a></h2>
<p>The top level <em>clawpack</em> repository keeps track of what versions of the
subrepositories work well together.</p>
<p>If you make pull requests in two different repositories that are linked, say
to both <em>pyclaw</em> and <em>riemann</em>, then you should also push these changes to
the top-level <em>clawpack</em> repository and issue a PR for this change:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cd $CLAW   # top-level clawpack repository
git checkout master
git pull
git checkout -b pyclaw-riemann-changes
git add pyclaw riemann
git commit -m &quot;Cross-update pyclaw and riemann.&quot;
git push username pyclaw-riemann-changes
</pre></div>
</div>
</div>
<div class="section" id="git-workflow">
<h2>Git workflow<a class="headerlink" href="#git-workflow" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference internal" href="pyclaw/devel/gitwash/git_resources.html#git-resources"><span class="std std-ref">git resources</span></a> for useful links.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p><a href="http://clawpack.org/">
    <img class="logo" src= "_static/clawlogo.jpg" alt="Logo"/>
</a>
<h2>Version 5.2.1</h2>
</p>
  <h3><a href="contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Developers&#8217; Guide</a><ul>
<li><a class="reference internal" href="#cloning-the-most-recent-code-from-github">Cloning the most recent code from Github</a></li>
<li><a class="reference internal" href="#installation-instructions-for-developers">Installation instructions for developers</a></li>
<li><a class="reference internal" href="#setting-a-remote-to-point-to-your-fork">Setting a remote to point to your fork</a></li>
<li><a class="reference internal" href="#modifying-code">Modifying code</a></li>
<li><a class="reference internal" href="#pull-requests">Pull requests</a></li>
<li><a class="reference internal" href="#testing-out-a-pull-request">Testing out a pull request</a></li>
<li><a class="reference internal" href="#top-level-pull-requests">Top level pull requests</a></li>
<li><a class="reference internal" href="#git-workflow">Git workflow</a></li>
</ul>
</li>
</ul>
<h3>Related Topics</h3>
<ul>
  <li><a href="contents.html">Documentation overview</a><ul>
      <li>Previous: <a href="pyclaw/rp.html" title="previous chapter">Riemann Solver Package</a></li>
      <li>Next: <a href="git_resources.html" title="next chapter">git resources</a></li>
  </ul></li>
</ul>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/developers.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<h3>Versions</h3>
<ul>
    <li><a href="../v5.4.1/developers.html">v5.4.1</a></li>
    <li><a href="../v5.4.0/developers.html">v5.4.0</a></li>
    <li><a href="../v5.3.1/developers.html">v5.3.1</a></li>
    <li><a href="../v5.3.0/developers.html">v5.3.0</a></li>
    <li><a href="developers.html">v5.2.1</a></li>
    <li><a href="../v5.2.0/developers.html">v5.2.0</a></li>
    <li><a href="../v5.1.0/developers.html">v5.1.0</a></li>
    <li><a href="../v5.6.1/developers.html">v5.6.1</a></li>
    <li><a href="../v5.6.0/developers.html">v5.6.0</a></li>
    <li><a href="../v5.5.0/developers.html">v5.5.0</a></li>
    <li><a href="../dev/developers.html">dev</a></li>
</ul>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
    &copy; Copyright 2014, The Clawpack Development Team.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  
  </body>
</html>