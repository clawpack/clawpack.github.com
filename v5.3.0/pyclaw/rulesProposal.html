
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Conventions for coding and documenting PyClaw &#8212; Clawpack 5.3.0 documentation</title>
    <link rel="stylesheet" href="../_static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/base.css" type="text/css" />
    <link rel="stylesheet" href="../_static/layout.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/clawicon.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
<div id="main-wrapper" class="sphinx">
<div id="header-wrapper">
  <section id="header">
    <!-- <h1><a href="http://clawpack.org/">Clawpack</a></h1> -->
    <h1><a href="http://clawpack.org/">Clawpack-5</a></h1> 
    <nav>
      <ul>
        <li>
          <!--<a class="" href="http://clawpack.org">Overview</a>-->
          <a href="../index.html">Overview</a>
        </li>
        <li>
          <a href="../contents.html">Docs</a>
        </li>
        <li>
          <a href="../installing.html">Install</a>
        </li>
        <li>
          <a class="" href="http://clawpack.org/gallery/index.html">Gallery</a>
        </li>
        <li>
          <a class="active" href="http://github.com/clawpack">GitHub</a>
        </li>
        <li>
          <a class="" href="../community.html">Community</a>
        </li>
      </ul>
    </nav>
  </section>
<div class="decoration"></div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Clawpack 5.3.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="conventions-for-coding-and-documenting-pyclaw">
<h1>Conventions for coding and documenting PyClaw<a class="headerlink" href="#conventions-for-coding-and-documenting-pyclaw" title="Permalink to this headline">¶</a></h1>
<p>In order to improve and maintain PyClaw and allow more developers or simply
users to acces and use it all Python/Fortran code should follow some
conventions. As stressed in many books, reports, notes, etc. (see for instance
<a class="reference external" href="http://en.wikipedia.org/wiki/Coding_conventions">Wikipedia</a>) code conventions
are important to programmers for a number of reasons:</p>
<blockquote>
<div><ul class="simple">
<li><p>A big part of the lifetime cost of a piece of software goes to maintenance</p></li>
<li><p>Rarely is software maintained for its whole life by the original authors</p></li>
<li><p>Code conventions improve the readability of the software, allowing new developers and users to understand new code more quickly and thoroughly (efficiency increases!)</p></li>
<li><p>Standards makes the source code look consistent, well-organized, and professional</p></li>
<li><p>etc.</p></li>
</ul>
</div></blockquote>
<p>This page provides some suggested coding conventions for PyClaw developers.
Most of the ideas/proposed rules listed here are adapted
from some conventions already used by most of the Python, Fortran90/95, C, C++
communities.</p>
<p>Most of the proposed rules listed here have been extracted from the
documentation available at following links:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="http://www.python.org/dev/peps/pep-0008/">pep-0008</a></p></li>
<li><p><a class="reference external" href="http://www.python.org/dev/peps/pep-0257/">pep-0257</a></p></li>
<li><p><a class="reference external" href="https://github.com/numpy/numpy/blob/master/doc/HOWTO_DOCUMENT.rst.txt">numpy</a></p></li>
<li><p><a class="reference external" href="http://www.sagemath.org/doc/developer/conventions.html">sage</a></p></li>
</ul>
</div></blockquote>
<div class="section" id="code-layout">
<h2>Code layout<a class="headerlink" href="#code-layout" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>Indentation:</dt><dd><ul class="simple">
<li><p>Use 4 spaces per indentation level</p></li>
<li><p>Don’t use tabs</p></li>
<li><p>Confine your line width to 80 characters, so that your code can be displayed on screen for side-by-side comparison and printed easily on A4 paper.</p></li>
<li><p>For flowing long blocks of text (docstrings or comments), limiting the length to 72 characters is recommended.</p></li>
<li><p>Separate top-level function and class definitions with two blank lines.</p></li>
<li><p>Method definitions inside a class are separated by a single blank line.</p></li>
</ul>
</dd>
</dl>
<p><strong>NOTE:</strong> For Python 3.0 and beyond, the following policy is prescribed for the
standard library (see PEP 3131): All identifiers in the Python standard library
MUST use ASCII-only identifiers, and SHOULD use English words wherever feasible
(in many cases, abbreviations and technical terms are used which aren’t
English). In addition, string literals and comments must also be in ASCII. The
only exceptions are (a) test cases testing the non-ASCII features, and (b)
names of authors. Authors whose names are not based on the latin alphabet MUST
provide a latin transliteration of their names. <strong>Open source projects with a
global audience are encouraged to adopt a similar policy.</strong></p>
</div>
<div class="section" id="docstring-conventions">
<h2>Docstring conventions<a class="headerlink" href="#docstring-conventions" title="Permalink to this headline">¶</a></h2>
<p>A docstring is a string literal that occurs as the first statement in a module, function, class, or method definition. Such a docstring becomes the <code class="docutils literal notranslate"><span class="pre">__doc__</span> <span class="pre">special</span></code> attribute of that object.</p>
<p>All modules should normally have docstrings, and all functions and classes exported by a module should also have docstrings. Public methods (including the __init__ constructor) should also have docstrings. A package may be documented in the module docstring of the <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file in the package directory.</p>
<p><strong>One-line Docstrings:</strong> One-liners are for really obvious cases. They should really fit on one line. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">limiter_type</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Return the type of limiter.&quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">lim_type</span>
    <span class="k">if</span> <span class="n">lim_type</span><span class="p">:</span> <span class="k">return</span> <span class="n">lim_type</span>
    <span class="o">...</span>
</pre></div>
</div>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">limiter_type</span><span class="p">(</span><span class="n">method_data</span><span class="p">)</span>
<span class="c">! Return the type of limiter.</span>
<span class="p">...</span>
<span class="p">...</span>
<span class="k">return </span><span class="n">lim_type</span>
<span class="k">end subroutine </span><span class="n">limiter_type</span>
</pre></div>
</div>
<dl class="simple">
<dt><strong>NOTES:</strong></dt><dd><ul class="simple">
<li><p>Triple quotes are used even though the string fits on one line. This makes it easy to later expand it</p></li>
<li><p>The closing quotes are on the same line as the opening quotes. This looks better for one-liners</p></li>
<li><p>There’s no blank line either before or after the docstring</p></li>
<li><p>The docstring is a phrase ending in a period. It prescribes the function or method’s effect as a command (“Do this”, “Return that”), not as a description</p></li>
<li><p>The one-line docstring should NOT be a “signature” reiterating the function/method parameters (which can be obtained by introspection)</p></li>
</ul>
</dd>
</dl>
<p><strong>Multi-line docstrings:</strong></p>
<p>Multi-line docstrings consist of a summary line just like a one-line docstring, followed by a blank line, followed by a more elaborate description. The summary line may be used by automatic indexing tools; it is important that it fits on one line and is separated from the rest of the docstring by a blank line. The summary line may be on the same line as the opening quotes or on the next line. The entire docstring is indented the same as the quotes at its first line.</p>
<p>The docstring of a script (a stand-alone program) should be usable as its “usage” message, printed when the script is invoked with incorrect or missing arguments (or perhaps with a “-h” option, for “help”). Such a docstring should document the script’s function and command line syntax, environment variables, and files. Usage messages can be fairly elaborate (several screens full) and should be sufficient for a new user to use the command properly, as well as a complete quick reference to all options and arguments for the sophisticated user.</p>
<p>The docstring for a module should generally list the classes, exceptions and functions (and any other objects) that are exported by the module, with a one-line summary of each. (These summaries generally give less detail than the summary line in the object’s docstring.) The docstring for a package (i.e., the docstring of the package’s <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> module) should also list the modules and subpackages exported by the package.</p>
<p>The docstring for a function or method should summarize its behavior and document its arguments, return value(s), side effects, exceptions raised, and restrictions on when it can be called (all if applicable). Optional arguments should be indicated. It should be documented whether keyword arguments are part of the interface.</p>
<p>The docstring for a class should summarize its behavior and list the public methods and instance variables. If the class is intended to be subclassed, and has an additional interface for subclasses, this interface should be listed separately (in the docstring). The class constructor should be documented in the docstring for its <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method. Individual methods should be documented by their own docstring.</p>
<p>The extended summary should be used to clarify functionality, not to discuss implementation detail or background theory, which should rather be explored in the notes section below. You may refer to the parameters and the function name, but parameter descriptions still belong in the parameters section.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">complex</span><span class="p">(</span><span class="n">real</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">imag</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Form a complex number.</span>

<span class="sd">    Keyword arguments:</span>
<span class="sd">    real -- the real part (default 0.0)</span>
<span class="sd">    imag -- the imaginary part (default 0.0)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">imag</span> <span class="o">==</span> <span class="mf">0.0</span> <span class="ow">and</span> <span class="n">real</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span> <span class="k">return</span> <span class="n">complex_zero</span>
    <span class="o">...</span>
</pre></div>
</div>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">tfluct</span><span class="p">(</span><span class="n">ixy</span><span class="p">,</span><span class="n">maxmx</span><span class="p">,</span><span class="n">num_eqn</span><span class="p">,</span><span class="n">num_waves</span><span class="p">,</span><span class="n">num_ghost</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">ql</span><span class="p">,</span><span class="n">qr</span><span class="p">,</span><span class="n">auxl</span><span class="p">,</span><span class="n">auxr</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">adq</span><span class="p">)</span>

<span class="c">! Solve Riemann problems for the 2D shallow water equations</span>
<span class="c">! using f-wave algorithm and Roe&#39;s approximate Riemann solver.</span>
<span class="c">!</span>
<span class="c">! Input arguments:</span>
<span class="c">! ql -- left state vector at the left edge of each cell</span>
<span class="c">! qr -- right state vector at the right edge of each cell</span>
<span class="c">!</span>
<span class="c">! Output arguments:</span>
<span class="c">! wave -- Riemann problem waves,</span>
<span class="c">! s    -- Waves speed,</span>
<span class="c">! amdq -- left-going flux difference  A^- \Delta q</span>
<span class="c">! apdq -- right-going flux difference  A^+ \Delta q</span>
<span class="c">!</span>
<span class="c">!</span>
<span class="c">! Note that the i&#39;th Riemann problem has left state qr(i-1,:)</span>
<span class="c">!                                     and right state ql(i,:)</span>
<span class="c">! From the basic clawpack routine step1, rp is called with ql = qr = q.</span>
</pre></div>
</div>
<p>If it is not necessary to specify a keyword argument, use optional:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">optional</span>
</pre></div>
</div>
<p>An optional section detailing which errors get raised and under what conditions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Raises</span>
<span class="o">------</span>
    <span class="n">LinAlgException</span>
        <span class="n">If</span> <span class="n">the</span> <span class="n">matrix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">numerically</span> <span class="n">invertible</span><span class="o">.</span>
</pre></div>
</div>
<p>References cited in the notes section may be listed here, e.g. if you cited the article below using the text <a class="reference internal" href="#ref" id="id1"><span>[Ref]</span></a>, include it as in the list as follows:</p>
<dl class="citation">
<dt class="label" id="ref"><span class="brackets"><a class="fn-backref" href="#id1">Ref</a></span></dt>
<dd><p>Amal Alghamdi, Aron Ahmadia, David I. Ketcheson, Matthew G. Knepley, Kyle T. Mandli, and Lisandro Dalcin, PetClaw: A Scalable Parallel Nonlinear Wave Propagation Solver for Python.</p>
</dd>
</dl>
</div>
<div class="section" id="naming-conventions">
<h2>Naming conventions<a class="headerlink" href="#naming-conventions" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>Reasons for using a naming convention (as opposed to allowing programmers to choose any character sequence) include the following:</dt><dd><ul class="simple">
<li><p>to reduce the effort needed to read and understand source code</p></li>
<li><p>to enhance source code appearance (for example, by disallowing overly long names or abbreviations)</p></li>
</ul>
</dd>
<dt>Some of the potential benefits that can be obtained by adopting a naming convention include the following:</dt><dd><ul class="simple">
<li><p>to provide additional information (i.e., metadata) about the use to which an identifier is put</p></li>
<li><p>to help formalize expectations and promote consistency within a development team</p></li>
<li><p>to enable the use of automated refactoring or search and replace tools with minimal potential for error</p></li>
<li><p>to help avoid “naming collisions”</p></li>
<li><p>to provide better understanding in case of code reuse after a long interval of time</p></li>
</ul>
</dd>
</dl>
<p>Thus, I would use “self-explaining names for variables, procedures etc.”</p>
<dl class="simple">
<dt><strong>Multiple-word identifiers:</strong></dt><dd><ul class="simple">
<li><p>Delimiter-separated words: hyphen (‘-‘) and the underscore (‘_’)</p></li>
<li><p>Letter-case separated words: indicate word boundaries using medial capitalization (here we can have the first word in lower case), e.g. limiterType</p></li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="order-of-the-test-cases-instruction">
<h2>Order of the test cases instruction<a class="headerlink" href="#order-of-the-test-cases-instruction" title="Permalink to this headline">¶</a></h2>
<p>It would be useful to follow also some rules when preparing the Python script
of a new test case. Listing  phases and instructions in a logical order could
improve the readability of the set-up. One idea could be:</p>
<blockquote>
<div><ul class="simple">
<li><p>Import libraries needed by all the functions</p></li>
<li><p>Define the functions use by the main program, e.g. qinit, setaux, etc.
Here the conventions introduce previously for the docstrings should be used</p></li>
<li><dl class="simple">
<dt>Main function</dt><dd><ul>
<li><p>Import libraries</p></li>
<li><p>Initialize grid, solution and aux array</p></li>
<li><p>Setup the solver and solver parameters</p></li>
<li><p>Setup controller and controller parameters</p></li>
<li><p>Solve problem</p></li>
<li><p>Plot results</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="add-regression-test-to-check-new-piece-of-code">
<h2>Add regression test to check new piece of code<a class="headerlink" href="#add-regression-test-to-check-new-piece-of-code" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><p>Add one or more regression test to check the functionality of the new code</p></li>
<li><p>Check with nose if all the tests pass before to commit</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="add-documentation-when-new-code-is-added">
<h2>Add documentation when new code is added<a class="headerlink" href="#add-documentation-when-new-code-is-added" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><p>What the new code does</p></li>
<li><p>How to use it</p></li>
<li><p>Document inputs outputs and  default parameters</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="write-comments-as-you-code">
<h2>Write Comments as You Code<a class="headerlink" href="#write-comments-as-you-code" title="Permalink to this headline">¶</a></h2>
<p>You won’t ever go back later and document your code. You just won’t. So when
you do something document it right then and there. When you create a class-
document it. When you create a method- document it. And so on. That way when
you finish coding you will also be finished documenting.
Won’t this break the flow? No, I think it improves flow because it keeps you
mindful of what you are doing, why you are doing, and how it fits in the big
picture.</p>
</div>
<div class="section" id="some-fortran-tips">
<h2>Some fortran tips<a class="headerlink" href="#some-fortran-tips" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><p>Always use <strong>IMPLICIT NONE</strong></p></li>
<li><p>Always allocate and deallocate memory</p></li>
</ul>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p><a href="http://clawpack.org/">
    <img class="logo" src= "../_static/clawlogo.jpg" alt="Logo"/>
</a>
<h2>Version 5.3.0</h2>
</p>
  <h3><a href="../contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Conventions for coding and documenting PyClaw</a><ul>
<li><a class="reference internal" href="#code-layout">Code layout</a></li>
<li><a class="reference internal" href="#docstring-conventions">Docstring conventions</a></li>
<li><a class="reference internal" href="#naming-conventions">Naming conventions</a></li>
<li><a class="reference internal" href="#order-of-the-test-cases-instruction">Order of the test cases instruction</a></li>
<li><a class="reference internal" href="#add-regression-test-to-check-new-piece-of-code">Add regression test to check new piece of code</a></li>
<li><a class="reference internal" href="#add-documentation-when-new-code-is-added">Add documentation when new code is added</a></li>
<li><a class="reference internal" href="#write-comments-as-you-code">Write Comments as You Code</a></li>
<li><a class="reference internal" href="#some-fortran-tips">Some fortran tips</a></li>
</ul>
</li>
</ul>
<h3>Related Topics</h3>
<ul>
  <li><a href="../contents.html">Documentation overview</a><ul>
  </ul></li>
</ul>
<div class="widget navlinks">
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/pyclaw/rulesProposal.rst.txt"
            rel="nofollow"
            target="_blank">Source .rst</a></li>
    <li><a href="https://github.com/clawpack/doc/blob/dev/doc/pyclaw/rulesProposal.rst"
            rel="nofollow"
            target="_blank">Source on GitHub</a></li>
     <li><a href="https://github.com/clawpack/doc/commits/dev/doc/pyclaw/rulesProposal.rst"
             rel="nofollow"
             target="_blank">History</a></li>
    <li><a href="https://github.com/clawpack/doc/edit/dev/doc/pyclaw/rulesProposal.rst"
            rel="nofollow"
            target="_blank">Suggest Edits</a></li>
     <li><a href="https://github.com/clawpack/doc/issues/new/choose"
             rel="nofollow"
             target="_blank">Raise an Issue</a></li>
  </ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
<h4>Latest Version</h4>
<ul>
  <li><a href="../../dev/index.html">dev</a></li>
  <li><a href="../../v5.7.0/index.html">v5.7.0</a></li>
</ul>
<h4>Older Versions</h4>
<ul>
  <li><a href="../../v5.1.0/pyclaw/rulesProposal.html">v5.1.0</a></li>
  <li><a href="../../v5.2.0/pyclaw/rulesProposal.html">v5.2.0</a></li>
  <li><a href="../../v5.2.1/pyclaw/rulesProposal.html">v5.2.1</a></li>
  <li><a href="rulesProposal.html">v5.3.0</a></li>
  <li><a href="../../v5.3.1/pyclaw/rulesProposal.html">v5.3.1</a></li>
  <li><a href="../../v5.4.0/pyclaw/rulesProposal.html">v5.4.0</a></li>
  <li><a href="../../v5.4.1/index.html">v5.4.1</a></li>
  <li><a href="../../v5.5.0/index.html">v5.5.0</a></li>
  <li><a href="../../v5.6.0/index.html">v5.6.0</a></li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
    &copy; Copyright CC-BY 2020, The Clawpack Development Team.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44811544-1', 'auto');
  ga('send', 'pageview');

  </script>
  
  </body>
</html>