<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>2D AMRCLAW: shiftset2.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">2D AMRCLAW
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d522931ffa1371640980b621734a4381.html">Users</a></li><li class="navelem"><a class="el" href="dir_837366d549956f78ba0c13b361b20649.html">rjl</a></li><li class="navelem"><a class="el" href="dir_0ad45cc5847da5b5cd5f1a60a5cbf5fd.html">git</a></li><li class="navelem"><a class="el" href="dir_cfcb0e7004778f0fc545724ad1e8ce60.html">clawpack</a></li><li class="navelem"><a class="el" href="dir_2b857a5132d751c0446f4aab8bdab3c1.html">amrclaw</a></li><li class="navelem"><a class="el" href="dir_a68f94680f6f38a420f38db5560024e3.html">src</a></li><li class="navelem"><a class="el" href="dir_68a38f875bbc4bbbaba61c2d6abd7b34.html">2d</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">shiftset2.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="shiftset2_8f_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a47e8f1360b82d5efaf66127b94b16f93"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shiftset2_8f.html#a47e8f1360b82d5efaf66127b94b16f93">shiftset2</a> (rectflags, ilo, ihi, jlo, jhi, mbuff)</td></tr>
<tr class="memdesc:a47e8f1360b82d5efaf66127b94b16f93"><td class="mdescLeft">&#160;</td><td class="mdescRight">For an input grid, flag cells near the previously flagged cells for creating buffer zone.  <a href="#a47e8f1360b82d5efaf66127b94b16f93">More...</a><br /></td></tr>
<tr class="separator:a47e8f1360b82d5efaf66127b94b16f93"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a47e8f1360b82d5efaf66127b94b16f93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47e8f1360b82d5efaf66127b94b16f93">&#9670;&nbsp;</a></span>shiftset2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine shiftset2 </td>
          <td>(</td>
          <td class="paramtype">dimension(ilo-mbuff:ihi+mbuff,jlo-mbuff:jhi+mbuff)&#160;</td>
          <td class="paramname"><em>rectflags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ilo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ihi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jhi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mbuff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For an input grid, flag cells near the previously flagged cells for creating buffer zone. </p>
<p>Shift by + or - 1 in either direction to do bitwise calculus for proper nesting, buffering, etc. similar to cshift on CM machine. includes periodic buffering as well.</p>
<p>NEWER VERSION: DOES ALL DIRS AT SAME TIME rectflags array has been augmented by enough border cells to do buffering in place in the grid later will look to see if flagged pts are properly nested</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rectflags</td><td>array to be flagged </td></tr>
    <tr><td class="paramname">ilo</td><td>global <em>i</em> index of the left border of the grid being projected to (being flagged) </td></tr>
    <tr><td class="paramname">ihi</td><td>global <em>i</em> index of the right border of the grid being projected to (being flagged) </td></tr>
    <tr><td class="paramname">jlo</td><td>global <em>j</em> index of the lower border of the grid being projected to (being flagged) </td></tr>
    <tr><td class="paramname">jhi</td><td>global <em>i</em> index of the upper border of the grid being projected to (being flagged) </td></tr>
    <tr><td class="paramname">mbuff</td><td>width of the buffer zone </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="shiftset2_8f_source.html#l00026">26</a> of file <a class="el" href="shiftset2_8f_source.html">shiftset2.f</a>.</p>

<p class="reference">References <a class="el" href="amr__module_8f90_source.html#l00198">amr_module::ibuff</a>.</p>

<p class="reference">Referenced by <a class="el" href="bufnst2_8f_source.html#l00016">bufnst2()</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;       <span class="keywordtype">use </span><a class="code" href="namespaceamr__module.html">amr_module</a></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;       <span class="keywordtype">implicit double precision</span> (a-h, o-z)</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;       dimension rectflags(ilo-mbuff:ihi+mbuff,jlo-mbuff:jhi+mbuff)</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;       dimension copyflags(ilo-mbuff:ihi+mbuff,jlo-mbuff:jhi+mbuff)</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;       <span class="keywordflow">do</span> j = jlo-mbuff, jhi+mbuff</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;       <span class="keywordflow">do</span> i = ilo-mbuff, ihi+mbuff</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;          copyflags(i,j) = 0</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keywordflow">       end do</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keywordflow">       end do</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;c  note: not looking at ghost cells, only <span class="keywordtype">real</span> cells should be flagged</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;c  but can buffer the flags into the ghost zone</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;       <span class="keywordflow">do</span> j = jlo, jhi</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;       <span class="keywordflow">do</span> i = ilo, ihi</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;          rflag = rectflags(i,j)</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;          <span class="keywordflow">if</span> (rflag .gt. 0)  <span class="keywordflow">then</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;c            cell is flagged, buffer in all dirs by <a class="code" href="namespaceamr__module.html#a13d9d0fe2e6979f732de183a3639cd8b">ibuff</a></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;c(note this is not nec same as mbuff)</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;c            <span class="keywordtype">use </span>second array to avoid propagation</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;             mlo = i - <a class="code" href="namespaceamr__module.html#a13d9d0fe2e6979f732de183a3639cd8b">ibuff</a></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;             mhi = i + <a class="code" href="namespaceamr__module.html#a13d9d0fe2e6979f732de183a3639cd8b">ibuff</a></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;             klo = j - <a class="code" href="namespaceamr__module.html#a13d9d0fe2e6979f732de183a3639cd8b">ibuff</a></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;             khi = j + <a class="code" href="namespaceamr__module.html#a13d9d0fe2e6979f732de183a3639cd8b">ibuff</a></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;             <span class="keywordflow">do</span> k = klo, khi </div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;             <span class="keywordflow">do</span> m = mlo, mhi</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                copyflags(m,k) = rflag  <span class="comment">! copy the flag (doesnt distinguish buffer flag from orig flag)</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keywordflow">             end do</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keywordflow">             end do</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keywordflow">       end do</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keywordflow">       end do</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;c   copy back. need flags in original array, not temp scratch array</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;       <span class="keywordflow">do</span> 60 j = jlo-mbuff, jhi+mbuff</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;       <span class="keywordflow">do</span> 60 i = ilo-mbuff, ihi+mbuff</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;         rectflags(i,j) = copyflags(i,j)</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; 60    <span class="keywordflow">continue</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;       <span class="keywordflow">return</span></div><div class="ttc" id="namespaceamr__module_html_a13d9d0fe2e6979f732de183a3639cd8b"><div class="ttname"><a href="namespaceamr__module.html#a13d9d0fe2e6979f732de183a3639cd8b">amr_module::ibuff</a></div><div class="ttdeci">integer ibuff</div><div class="ttdef"><b>Definition:</b> <a href="amr__module_8f90_source.html#l00198">amr_module.f90:198</a></div></div>
<div class="ttc" id="namespaceamr__module_html"><div class="ttname"><a href="namespaceamr__module.html">amr_module</a></div><div class="ttdoc">The module contains the definition of a &quot;node descriptor&quot; as well as other global variables used duri...</div><div class="ttdef"><b>Definition:</b> <a href="amr__module_8f90_source.html#l00021">amr_module.f90:21</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="shiftset2_8f_a47e8f1360b82d5efaf66127b94b16f93_icgraph.png" border="0" usemap="#shiftset2_8f_a47e8f1360b82d5efaf66127b94b16f93_icgraph" alt=""/></div>
<map name="shiftset2_8f_a47e8f1360b82d5efaf66127b94b16f93_icgraph" id="shiftset2_8f_a47e8f1360b82d5efaf66127b94b16f93_icgraph">
<area shape="rect" id="node2" href="bufnst2_8f.html#ab911943f6d34b7689ba474a8f199dbb8" title="After error estimation, need to tag the cell for refinement, buffer the tags, take care of level nest..." alt="" coords="124,56,189,81"/>
<area shape="rect" id="node3" href="flglvl2_8f.html#a3e87b2987fe5b352527d32542b051f88" title="Controls the error estimation/flagging bad pts. " alt="" coords="237,56,293,81"/>
<area shape="rect" id="node4" href="grdfit2_8f.html#af2c87ed572e707000494dd5b41df3749" title="This subroutine is called by setgrd and regrid to actually fit the new grids on each level..." alt="" coords="341,56,392,81"/>
<area shape="rect" id="node5" href="moment_8f.html#a1daedabc834d90c804a58bb83b766bbe" title="Compute enclosing rectangle around flagged points. " alt="" coords="440,5,509,31"/>
<area shape="rect" id="node7" href="regrid_8f.html#a042dfbc681db663819f65973d64f1c08" title="regrid" alt="" coords="447,107,502,132"/>
<area shape="rect" id="node10" href="setgrd_8f.html#a8a283984c61bf6aae3fe94b76c80187c" title="setgrd" alt="" coords="564,156,622,181"/>
<area shape="rect" id="node6" href="smartbis_8f.html#ac10b1eb01bf006097c727f93970c8e98" title="Smart bisect rectangles until cutoff reached for each. " alt="" coords="557,31,629,56"/>
<area shape="rect" id="node8" href="tick_8f.html#a0f3d6e1153a914673fff20a5f339838f" title="tick" alt="" coords="572,107,614,132"/>
<area shape="rect" id="node9" href="amr2_8f90.html#a0397ec684f16719bd6dbe7192f654962" title="amr2" alt="" coords="677,132,729,157"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun May 7 2017 10:59:41 for 2D AMRCLAW by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
