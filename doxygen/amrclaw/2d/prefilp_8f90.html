<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>2D AMRCLAW: prefilp.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">2D AMRCLAW
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d522931ffa1371640980b621734a4381.html">Users</a></li><li class="navelem"><a class="el" href="dir_837366d549956f78ba0c13b361b20649.html">rjl</a></li><li class="navelem"><a class="el" href="dir_0ad45cc5847da5b5cd5f1a60a5cbf5fd.html">git</a></li><li class="navelem"><a class="el" href="dir_cfcb0e7004778f0fc545724ad1e8ce60.html">clawpack</a></li><li class="navelem"><a class="el" href="dir_2b857a5132d751c0446f4aab8bdab3c1.html">amrclaw</a></li><li class="navelem"><a class="el" href="dir_a68f94680f6f38a420f38db5560024e3.html">src</a></li><li class="navelem"><a class="el" href="dir_68a38f875bbc4bbbaba61c2d6abd7b34.html">2d</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">prefilp.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="prefilp_8f90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ade3b15439cf99ae8026428a11746757d"><td class="memItemLeft" align="right" valign="top">recursive subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="prefilp_8f90.html#ade3b15439cf99ae8026428a11746757d">prefilrecur</a> (level, nvar, valbig, auxbig, naux, time, mitot, mjtot, nrowst, ncolst, ilo, ihi, jlo, jhi, iglo, ighi, jglo, jghi, patchOnly)</td></tr>
<tr class="memdesc:ade3b15439cf99ae8026428a11746757d"><td class="mdescLeft">&#160;</td><td class="mdescRight">For periodic boundary conditions more work needed to fill the piece of the boundary.  <a href="#ade3b15439cf99ae8026428a11746757d">More...</a><br /></td></tr>
<tr class="separator:ade3b15439cf99ae8026428a11746757d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abea716a3f5a7008466b243225ec4b7a7"><td class="memItemLeft" align="right" valign="top">integer pure function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="prefilp_8f90.html#abea716a3f5a7008466b243225ec4b7a7">iadd</a> (n, i, j)</td></tr>
<tr class="separator:abea716a3f5a7008466b243225ec4b7a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b20545c1baa3a21c8a02f8efa3d377a"><td class="memItemLeft" align="right" valign="top">integer pure function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="prefilp_8f90.html#a2b20545c1baa3a21c8a02f8efa3d377a">iaddscratch</a> (n, i, j)</td></tr>
<tr class="separator:a2b20545c1baa3a21c8a02f8efa3d377a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a915346fec0569f3df802b896f4f0805d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="prefilp_8f90.html#a915346fec0569f3df802b896f4f0805d">patchcopyout</a> (nvar, valpatch, mi, mj, valbig, mitot, mjtot, i1, i2, j1, j2, iglo, jglo)</td></tr>
<tr class="separator:a915346fec0569f3df802b896f4f0805d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ae461010f4abb556af7f9d254c99fef"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="prefilp_8f90.html#a0ae461010f4abb556af7f9d254c99fef">auxcopyin</a> (auxPatch, mi, mj, auxbig, mitot, mjtot, naux, i1, i2, j1, j2, iglo, jglo)</td></tr>
<tr class="separator:a0ae461010f4abb556af7f9d254c99fef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a0ae461010f4abb556af7f9d254c99fef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ae461010f4abb556af7f9d254c99fef">&#9670;&nbsp;</a></span>auxcopyin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine auxcopyin </td>
          <td>(</td>
          <td class="paramtype">real(kind=8), dimension(naux,mi,mj), intent(inout)&#160;</td>
          <td class="paramname"><em>auxPatch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>mi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>mj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(naux,mitot,mjtot), intent(inout)&#160;</td>
          <td class="paramname"><em>auxbig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>mitot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>mjtot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>naux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>i1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>i2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>j1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>j2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>iglo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>jglo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="prefilp_8f90_source.html#l00250">250</a> of file <a class="el" href="prefilp_8f90_source.html">prefilp.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="prefilp_8f90_source.html#l00020">prefilrecur()</a>.</p>
<div class="fragment"><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">! set the aux array for the patch  to go with the soln vals to  be filled in filpatch,</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">! by copying from valbig&#39;s auxbig array</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceamr__module.html">amr_module</a></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">! Input</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordtype">integer</span> :: mi, mj, naux, mitot, mjtot, i1, i2,j1, j2, iglo, ighi, jglo, jghi</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">! Output</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordtype">real(kind=8)</span>, <span class="keywordtype">intent(in out)</span> :: auxbig(naux,mitot,mjtot)</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordtype">real(kind=8)</span>, <span class="keywordtype">intent(in out)</span> :: auxpatch(naux,mi,mj)</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">! Local storage</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordtype">integer</span> :: ist, jst </div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">! this ghost cell patch subset goes from (i1,j1) to (i2,j2) in integer index space</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">! the grid (including ghost cells) is from (iglo,jglo) to (ighi,jghi)</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">! figure out where to copy</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    ist = i1 - iglo + 1   <span class="comment">! offset 1 since aux arrays are 1-based</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    jst = j1 - jglo + 1</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    auxpatch(:,1:mi,1:mj) = auxbig(:,ist:ist+mi-1, jst:jst+mj-1)</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="ttc" id="namespaceamr__module_html"><div class="ttname"><a href="namespaceamr__module.html">amr_module</a></div><div class="ttdoc">The module contains the definition of a &quot;node descriptor&quot; as well as other global variables used duri...</div><div class="ttdef"><b>Definition:</b> <a href="amr__module_8f90_source.html#l00021">amr_module.f90:21</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="prefilp_8f90_a0ae461010f4abb556af7f9d254c99fef_icgraph.png" border="0" usemap="#prefilp_8f90_a0ae461010f4abb556af7f9d254c99fef_icgraph" alt=""/></div>
<map name="prefilp_8f90_a0ae461010f4abb556af7f9d254c99fef_icgraph" id="prefilp_8f90_a0ae461010f4abb556af7f9d254c99fef_icgraph">
<area shape="rect" id="node2" href="prefilp_8f90.html#ade3b15439cf99ae8026428a11746757d" title="For periodic boundary conditions more work needed to fill the piece of the boundary. " alt="" coords="135,150,215,176"/>
<area shape="rect" id="node3" href="bound_8f90.html#ad00f57f1c18c6e2fb99593e3e7fde889" title="This routine sets the boundary values for a given grid at level level. " alt="" coords="374,101,433,126"/>
<area shape="rect" id="node17" href="filpatch_8f90.html#a842d63d44af2ea44724f2ee0c374438e" title="Fill a region (patch) described by: " alt="" coords="263,150,325,176"/>
<area shape="rect" id="node4" href="advanc_8f.html#a7619f88bd394d1873fac570dd990c73d" title="Integrate all grids at the input level by one step of its delta(t) " alt="" coords="938,25,1002,50"/>
<area shape="rect" id="node8" href="flagger_8f.html#aa01ccdd832604fd7276c0a0d6dc97e19" title="Set up for and call two routines that flag using (a) spatial gradients, or other user&#45;specified crite..." alt="" coords="724,125,787,150"/>
<area shape="rect" id="node14" href="prepbigstep_8f.html#a3a50bfe12799e99f4e7238e571249888" title="prepbigstep" alt="" coords="482,76,573,101"/>
<area shape="rect" id="node16" href="spest2_8f.html#acb696b8536cf1c510bad11ce3feeb65f" title="spest2" alt="" coords="497,177,558,202"/>
<area shape="rect" id="node5" href="setgrd_8f.html#a8a283984c61bf6aae3fe94b76c80187c" title="setgrd" alt="" coords="1056,25,1114,50"/>
<area shape="rect" id="node7" href="tick_8f.html#a0f3d6e1153a914673fff20a5f339838f" title="tick" alt="" coords="1183,74,1224,100"/>
<area shape="rect" id="node6" href="amr2_8f90.html#a0397ec684f16719bd6dbe7192f654962" title="amr2" alt="" coords="1287,49,1339,74"/>
<area shape="rect" id="node9" href="flglvl2_8f.html#a3e87b2987fe5b352527d32542b051f88" title="Controls the error estimation/flagging bad pts. " alt="" coords="835,125,890,150"/>
<area shape="rect" id="node10" href="grdfit2_8f.html#af2c87ed572e707000494dd5b41df3749" title="This subroutine is called by setgrd and regrid to actually fit the new grids on each level..." alt="" coords="945,125,996,150"/>
<area shape="rect" id="node11" href="moment_8f.html#a1daedabc834d90c804a58bb83b766bbe" title="Compute enclosing rectangle around flagged points. " alt="" coords="1050,176,1120,201"/>
<area shape="rect" id="node13" href="regrid_8f.html#a042dfbc681db663819f65973d64f1c08" title="regrid" alt="" coords="1057,74,1113,100"/>
<area shape="rect" id="node12" href="smartbis_8f.html#ac10b1eb01bf006097c727f93970c8e98" title="Smart bisect rectangles until cutoff reached for each. " alt="" coords="1168,150,1239,176"/>
<area shape="rect" id="node15" href="errest_8f.html#a6549b2bd369989221d46011503fd612f" title="errest" alt="" coords="621,76,676,101"/>
<area shape="rect" id="node18" href="filpatch__orig_8f90.html#a17a35753c2dde1dd9f3ef43ae9312ef0" title="filrecur" alt="" coords="373,150,434,176"/>
</map>
</div>

</div>
</div>
<a id="abea716a3f5a7008466b243225ec4b7a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abea716a3f5a7008466b243225ec4b7a7">&#9670;&nbsp;</a></span>iadd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer pure function prefilrecur::iadd </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="prefilp_8f90_source.html#l00201">201</a> of file <a class="el" href="prefilp_8f90_source.html">prefilp.f90</a>.</p>

<p class="reference">References <a class="el" href="intfil_8f90_source.html#l00294">iadd()</a>.</p>
<div class="fragment"><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: n, i, j</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <a class="code" href="intfil_8f90.html#ab82ff7565af59f230a39f55e157a5c1c">iadd</a> = locflip + n-1 + nvar*((j-1)*mi+i-1)</div><div class="ttc" id="intfil_8f90_html_ab82ff7565af59f230a39f55e157a5c1c"><div class="ttname"><a href="intfil_8f90.html#ab82ff7565af59f230a39f55e157a5c1c">iadd</a></div><div class="ttdeci">integer pure function iadd(ivar, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="intfil_8f90_source.html#l00294">intfil.f90:294</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="prefilp_8f90_abea716a3f5a7008466b243225ec4b7a7_cgraph.png" border="0" usemap="#prefilp_8f90_abea716a3f5a7008466b243225ec4b7a7_cgraph" alt=""/></div>
<map name="prefilp_8f90_abea716a3f5a7008466b243225ec4b7a7_cgraph" id="prefilp_8f90_abea716a3f5a7008466b243225ec4b7a7_cgraph">
<area shape="rect" id="node2" href="intfil_8f90.html#ab82ff7565af59f230a39f55e157a5c1c" title="iadd" alt="" coords="100,5,146,31"/>
</map>
</div>

</div>
</div>
<a id="a2b20545c1baa3a21c8a02f8efa3d377a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b20545c1baa3a21c8a02f8efa3d377a">&#9670;&nbsp;</a></span>iaddscratch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer pure function prefilrecur::iaddscratch </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="prefilp_8f90_source.html#l00207">207</a> of file <a class="el" href="prefilp_8f90_source.html">prefilp.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="prefilp__orig_8f90_source.html#l00194">iaddscratch()</a>, and <a class="el" href="prefilp_8f90_source.html#l00020">prefilrecur()</a>.</p>
<div class="fragment"><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: n, i, j</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <a class="code" href="prefilp_8f90.html#a2b20545c1baa3a21c8a02f8efa3d377a">iaddscratch</a> = n + nvar*((j-1)*mi+i-1)  <span class="comment">! no subtract 1</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="ttc" id="prefilp_8f90_html_a2b20545c1baa3a21c8a02f8efa3d377a"><div class="ttname"><a href="prefilp_8f90.html#a2b20545c1baa3a21c8a02f8efa3d377a">iaddscratch</a></div><div class="ttdeci">integer pure function iaddscratch(n, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="prefilp_8f90_source.html#l00207">prefilp.f90:207</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="prefilp_8f90_a2b20545c1baa3a21c8a02f8efa3d377a_icgraph.png" border="0" usemap="#prefilp_8f90_a2b20545c1baa3a21c8a02f8efa3d377a_icgraph" alt=""/></div>
<map name="prefilp_8f90_a2b20545c1baa3a21c8a02f8efa3d377a_icgraph" id="prefilp_8f90_a2b20545c1baa3a21c8a02f8efa3d377a_icgraph">
<area shape="rect" id="node2" href="prefilp__orig_8f90.html#a2b20545c1baa3a21c8a02f8efa3d377a" title="iaddscratch" alt="" coords="143,101,232,126"/>
<area shape="rect" id="node3" href="prefilp_8f90.html#ade3b15439cf99ae8026428a11746757d" title="For periodic boundary conditions more work needed to fill the piece of the boundary. " alt="" coords="147,150,228,176"/>
<area shape="rect" id="node4" href="bound_8f90.html#ad00f57f1c18c6e2fb99593e3e7fde889" title="This routine sets the boundary values for a given grid at level level. " alt="" coords="391,101,450,126"/>
<area shape="rect" id="node18" href="filpatch_8f90.html#a842d63d44af2ea44724f2ee0c374438e" title="Fill a region (patch) described by: " alt="" coords="280,150,342,176"/>
<area shape="rect" id="node5" href="advanc_8f.html#a7619f88bd394d1873fac570dd990c73d" title="Integrate all grids at the input level by one step of its delta(t) " alt="" coords="955,25,1019,50"/>
<area shape="rect" id="node9" href="flagger_8f.html#aa01ccdd832604fd7276c0a0d6dc97e19" title="Set up for and call two routines that flag using (a) spatial gradients, or other user&#45;specified crite..." alt="" coords="741,125,804,150"/>
<area shape="rect" id="node15" href="prepbigstep_8f.html#a3a50bfe12799e99f4e7238e571249888" title="prepbigstep" alt="" coords="499,76,590,101"/>
<area shape="rect" id="node17" href="spest2_8f.html#acb696b8536cf1c510bad11ce3feeb65f" title="spest2" alt="" coords="514,177,575,202"/>
<area shape="rect" id="node6" href="setgrd_8f.html#a8a283984c61bf6aae3fe94b76c80187c" title="setgrd" alt="" coords="1073,25,1131,50"/>
<area shape="rect" id="node8" href="tick_8f.html#a0f3d6e1153a914673fff20a5f339838f" title="tick" alt="" coords="1200,74,1241,100"/>
<area shape="rect" id="node7" href="amr2_8f90.html#a0397ec684f16719bd6dbe7192f654962" title="amr2" alt="" coords="1305,49,1356,74"/>
<area shape="rect" id="node10" href="flglvl2_8f.html#a3e87b2987fe5b352527d32542b051f88" title="Controls the error estimation/flagging bad pts. " alt="" coords="852,125,907,150"/>
<area shape="rect" id="node11" href="grdfit2_8f.html#af2c87ed572e707000494dd5b41df3749" title="This subroutine is called by setgrd and regrid to actually fit the new grids on each level..." alt="" coords="962,125,1013,150"/>
<area shape="rect" id="node12" href="moment_8f.html#a1daedabc834d90c804a58bb83b766bbe" title="Compute enclosing rectangle around flagged points. " alt="" coords="1067,176,1137,201"/>
<area shape="rect" id="node14" href="regrid_8f.html#a042dfbc681db663819f65973d64f1c08" title="regrid" alt="" coords="1074,74,1130,100"/>
<area shape="rect" id="node13" href="smartbis_8f.html#ac10b1eb01bf006097c727f93970c8e98" title="Smart bisect rectangles until cutoff reached for each. " alt="" coords="1185,150,1257,176"/>
<area shape="rect" id="node16" href="errest_8f.html#a6549b2bd369989221d46011503fd612f" title="errest" alt="" coords="638,76,693,101"/>
<area shape="rect" id="node19" href="filpatch__orig_8f90.html#a17a35753c2dde1dd9f3ef43ae9312ef0" title="filrecur" alt="" coords="390,150,451,176"/>
</map>
</div>

</div>
</div>
<a id="a915346fec0569f3df802b896f4f0805d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a915346fec0569f3df802b896f4f0805d">&#9670;&nbsp;</a></span>patchcopyout()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine patchcopyout </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nvar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(nvar,mi,mj), intent(inout)&#160;</td>
          <td class="paramname"><em>valpatch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>mi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>mj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(nvar,mitot,mjtot), intent(inout)&#160;</td>
          <td class="paramname"><em>valbig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>mitot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>mjtot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>i1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>i2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>j1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>j2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>iglo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>jglo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="prefilp_8f90_source.html#l00219">219</a> of file <a class="el" href="prefilp_8f90_source.html">prefilp.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="prefilp_8f90_source.html#l00020">prefilrecur()</a>.</p>
<div class="fragment"><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">! the patch was filled from a possibly periodically wrapped place.</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">! put it back where it should go in original grids solution array</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;          </div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceamr__module.html">amr_module</a></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">! Input</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordtype">integer</span> :: mi, mj, nvar, mitot, mjtot, i1, i2,j1, j2, iglo, ighi, jglo, jghi</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">! Output</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordtype">real(kind=8)</span>, <span class="keywordtype">intent(in out)</span> :: valbig(nvar,mitot,mjtot)</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordtype">real(kind=8)</span>, <span class="keywordtype">intent(in out)</span> :: valpatch(nvar,mi,mj)</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">! Local storage</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordtype">integer</span> :: ist, jst </div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">! this ghost cell patch subset goes from (i1,j1) to (i2,j2) in integer index space</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">! the grid (including ghost cells) is from (iglo,jglo) to (ighi,jghi)</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">! figure out where to copy</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    ist = i1 - iglo + 1   <span class="comment">! offset 1 since soln array is 1-based</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    jst = j1 - jglo + 1</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    valbig(:,ist:ist+mi-1, jst:jst+mj-1) = valpatch</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="ttc" id="namespaceamr__module_html"><div class="ttname"><a href="namespaceamr__module.html">amr_module</a></div><div class="ttdoc">The module contains the definition of a &quot;node descriptor&quot; as well as other global variables used duri...</div><div class="ttdef"><b>Definition:</b> <a href="amr__module_8f90_source.html#l00021">amr_module.f90:21</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="prefilp_8f90_a915346fec0569f3df802b896f4f0805d_icgraph.png" border="0" usemap="#prefilp_8f90_a915346fec0569f3df802b896f4f0805d_icgraph" alt=""/></div>
<map name="prefilp_8f90_a915346fec0569f3df802b896f4f0805d_icgraph" id="prefilp_8f90_a915346fec0569f3df802b896f4f0805d_icgraph">
<area shape="rect" id="node2" href="prefilp_8f90.html#ade3b15439cf99ae8026428a11746757d" title="For periodic boundary conditions more work needed to fill the piece of the boundary. " alt="" coords="154,150,235,176"/>
<area shape="rect" id="node3" href="bound_8f90.html#ad00f57f1c18c6e2fb99593e3e7fde889" title="This routine sets the boundary values for a given grid at level level. " alt="" coords="393,101,452,126"/>
<area shape="rect" id="node17" href="filpatch_8f90.html#a842d63d44af2ea44724f2ee0c374438e" title="Fill a region (patch) described by: " alt="" coords="283,150,344,176"/>
<area shape="rect" id="node4" href="advanc_8f.html#a7619f88bd394d1873fac570dd990c73d" title="Integrate all grids at the input level by one step of its delta(t) " alt="" coords="957,25,1022,50"/>
<area shape="rect" id="node8" href="flagger_8f.html#aa01ccdd832604fd7276c0a0d6dc97e19" title="Set up for and call two routines that flag using (a) spatial gradients, or other user&#45;specified crite..." alt="" coords="744,125,806,150"/>
<area shape="rect" id="node14" href="prepbigstep_8f.html#a3a50bfe12799e99f4e7238e571249888" title="prepbigstep" alt="" coords="501,76,592,101"/>
<area shape="rect" id="node16" href="spest2_8f.html#acb696b8536cf1c510bad11ce3feeb65f" title="spest2" alt="" coords="516,177,577,202"/>
<area shape="rect" id="node5" href="setgrd_8f.html#a8a283984c61bf6aae3fe94b76c80187c" title="setgrd" alt="" coords="1075,25,1133,50"/>
<area shape="rect" id="node7" href="tick_8f.html#a0f3d6e1153a914673fff20a5f339838f" title="tick" alt="" coords="1202,74,1244,100"/>
<area shape="rect" id="node6" href="amr2_8f90.html#a0397ec684f16719bd6dbe7192f654962" title="amr2" alt="" coords="1307,49,1358,74"/>
<area shape="rect" id="node9" href="flglvl2_8f.html#a3e87b2987fe5b352527d32542b051f88" title="Controls the error estimation/flagging bad pts. " alt="" coords="854,125,909,150"/>
<area shape="rect" id="node10" href="grdfit2_8f.html#af2c87ed572e707000494dd5b41df3749" title="This subroutine is called by setgrd and regrid to actually fit the new grids on each level..." alt="" coords="964,125,1015,150"/>
<area shape="rect" id="node11" href="moment_8f.html#a1daedabc834d90c804a58bb83b766bbe" title="Compute enclosing rectangle around flagged points. " alt="" coords="1070,176,1139,201"/>
<area shape="rect" id="node13" href="regrid_8f.html#a042dfbc681db663819f65973d64f1c08" title="regrid" alt="" coords="1077,74,1132,100"/>
<area shape="rect" id="node12" href="smartbis_8f.html#ac10b1eb01bf006097c727f93970c8e98" title="Smart bisect rectangles until cutoff reached for each. " alt="" coords="1187,150,1259,176"/>
<area shape="rect" id="node15" href="errest_8f.html#a6549b2bd369989221d46011503fd612f" title="errest" alt="" coords="640,76,696,101"/>
<area shape="rect" id="node18" href="filpatch__orig_8f90.html#a17a35753c2dde1dd9f3ef43ae9312ef0" title="filrecur" alt="" coords="392,150,453,176"/>
</map>
</div>

</div>
</div>
<a id="ade3b15439cf99ae8026428a11746757d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade3b15439cf99ae8026428a11746757d">&#9670;&nbsp;</a></span>prefilrecur()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">recursive subroutine prefilrecur </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nvar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(nvar,mitot,mjtot), intent(inout)&#160;</td>
          <td class="paramname"><em>valbig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(naux,mitot,mjtot), intent(inout)&#160;</td>
          <td class="paramname"><em>auxbig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>naux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), intent(in)&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>mitot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>mjtot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nrowst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ncolst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ilo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ihi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jhi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iglo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ighi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jglo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jghi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>patchOnly</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For periodic boundary conditions more work needed to fill the piece of the boundary. </p>
<p>This routine was called because the patch sticks out of the domain, and has periodic bc.s preprocess the patch before calling filpatch to shift the patch periodically back into the domain.</p>
<p>Inputs to this routine: xl, xr, yb, yt = the location in physical space of corners of a patch. fill_indices = the location in index space of this patch.</p>
<p>Outputs from this routine: The values around the border of the grid are inserted directly into the enlarged valbig array for this piece. </p>

<p class="definition">Definition at line <a class="el" href="prefilp_8f90_source.html#l00020">20</a> of file <a class="el" href="prefilp_8f90_source.html">prefilp.f90</a>.</p>

<p class="reference">References <a class="el" href="amr__module_8f90_source.html#l00218">amr_module::alloc</a>, <a class="el" href="prefilp_8f90_source.html#l00250">auxcopyin()</a>, <a class="el" href="filpatch_8f90_source.html#l00073">filrecur()</a>, <a class="el" href="amr__module_8f90_source.html#l00193">amr_module::hxposs</a>, <a class="el" href="amr__module_8f90_source.html#l00193">amr_module::hyposs</a>, <a class="el" href="prefilp_8f90_source.html#l00207">iaddscratch()</a>, <a class="el" href="amr__module_8f90_source.html#l00198">amr_module::iregsz</a>, <a class="el" href="amr__module_8f90_source.html#l00198">amr_module::jregsz</a>, <a class="el" href="amr__module_8f90_source.html#l00168">amr_module::needs_to_be_set</a>, <a class="el" href="amr__module_8f90_source.html#l00232">amr_module::nghost</a>, <a class="el" href="prefilp_8f90_source.html#l00219">patchcopyout()</a>, <a class="el" href="setaux_8f90_source.html#l00002">setaux()</a>, <a class="el" href="amr__module_8f90_source.html#l00230">amr_module::spheredom</a>, <a class="el" href="amr__module_8f90_source.html#l00231">amr_module::xlower</a>, <a class="el" href="amr__module_8f90_source.html#l00230">amr_module::xperdom</a>, <a class="el" href="amr__module_8f90_source.html#l00231">amr_module::ylower</a>, and <a class="el" href="amr__module_8f90_source.html#l00230">amr_module::yperdom</a>.</p>

<p class="reference">Referenced by <a class="el" href="bound_8f90_source.html#l00052">bound()</a>, and <a class="el" href="filpatch_8f90_source.html#l00073">filrecur()</a>.</p>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceamr__module.html">amr_module</a><span class="keywordtype">, only</span>: <a class="code" href="namespaceamr__module.html#a031ce08951c5413d6e27cf0aa20b4ef3">iregsz</a>, <a class="code" href="namespaceamr__module.html#ab358b1bbd923fccb6f0f1a9cac199bb5">jregsz</a>, <a class="code" href="namespaceamr__module.html#a58fe0c14f620a219dfa19d4eabaebaaa">nghost</a>, <a class="code" href="namespaceamr__module.html#a8b2a33769290641df4fe4f7bf1c47e47">xlower</a>, <a class="code" href="namespaceamr__module.html#a0f44819b8d605e4846dc49f3b0b5674b">ylower</a>, <a class="code" href="namespaceamr__module.html#ae03f9f21f4caf3a5c1e9c98758c6daee">xperdom</a>, <a class="code" href="namespaceamr__module.html#a66d22175d9bad91782ee06469fa64fe8">yperdom</a></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceamr__module.html">amr_module</a><span class="keywordtype">, only</span>: <a class="code" href="namespaceamr__module.html#ac7ee4de6cf6e5dada17052e87006240b">spheredom</a>, <a class="code" href="namespaceamr__module.html#af62b98563fd59a5ef279f59f3af56d0e">hxposs</a>, <a class="code" href="namespaceamr__module.html#ae843bd0d937168c4a0878165e20e796b">hyposs</a>, <a class="code" href="namespaceamr__module.html#a7fb7e0d2f2fc883c87e7df2f125f9d9a">needs_to_be_set</a>, <a class="code" href="namespaceamr__module.html#a840234c5236253a654d137e46f0bfecf">alloc</a></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    </div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="comment">! Input</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: level, nvar, naux, mitot, mjtot</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ilo,ihi,jlo,jhi,iglo,ighi,jglo,jghi</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordtype">real(kind=8)</span>, <span class="keywordtype">intent(in)</span> :: time</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">! false when called from bound, when valbig is whole grid but only filling patch.</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">! true for recursive coarse sub-patches - grid is patch</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordtype">logical</span>  :: patchonly  </div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">! Output</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordtype">real(kind=8)</span>, <span class="keywordtype">intent(in out)</span> :: valbig(nvar,mitot,mjtot)</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordtype">real(kind=8)</span>, <span class="keywordtype">intent(in out)</span> :: auxbig(naux,mitot,mjtot)</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    </div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">! Local storage</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordtype">integer</span> :: i, j, ii, jj, ivar, ng, i1, i2, j1, j2, nrowst, ncolst</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordtype">integer</span> :: iputst, jputst, mi, mj, locpatch, locpaux</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordtype">integer</span> :: jbump, iwrap1, iwrap2, jwrap1, tmp, locflip, rect(4)</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordtype">real(kind=8)</span> :: xlwrap, ybwrap</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordtype">integer</span> ::  msrc    <span class="comment">! this signifies not a real grid, no bndry list with it</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">! it is possible to preprocess in the periodic case, just more complicated, so postponing</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordtype">integer</span> :: ist(3), iend(3), jst(3), jend(3), ishift(3), jshift(3)</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordtype">real(kind=8)</span> :: scratch(max(mitot,mjtot)*nghost*nvar)</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordtype">real(kind=8)</span> :: scratchaux(max(mitot,mjtot)*nghost*naux)</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">! dimension at largest possible</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">real(kind=8)</span> :: valpatch((ihi-ilo+1) * (jhi-jlo+1) * nvar)  </div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordtype">real(kind=8)</span> :: auxpatch((ihi-ilo+1) * (jhi-jlo+1) * naux)  </div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    </div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">!     # will divide patch  (from ilo,jlo to ihi,jhi)  into 9 possibilities (some empty): </span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">!       x sticks out left, x interior, x sticks out right</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">!       same for y. for example, the max. would be</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">!       i from (ilo,-1), (0,iregsz(level)-1), (iregsz(level),ihi)</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">!     # this patch lives in a grid with soln array valbig, which goes from</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">!       (iglo,jglo) to (ighi,jghi).</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    msrc = -1   <span class="comment">! iitialization indicating whether real src grid so can use faster bc list</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">if</span> (xperdom) <span class="keywordflow">then</span>       </div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;       ist(1)    = ilo</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;       ist(2)    = 0</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;       ist(3)    = iregsz(level)</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;       iend(1)   = -1</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;       iend(2)   = iregsz(level)-1</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;       iend(3)   = ihi</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;       ishift(1) = iregsz(level)</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;       ishift(2) = 0</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;       ishift(3) = -iregsz(level)</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">else</span>  <span class="comment">! if not periodic, set vals to only have nonnull intersection for interior regoin</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;       ist(1)    = iregsz(level)</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;       ist(2)    = ilo</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;       ist(3)    = iregsz(level)</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;       iend(1)   = -1</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;       iend(2)   = ihi</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;       iend(3)   = -1</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;       ishift(1) = 0</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;       ishift(2) = 0</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;       ishift(3) = 0</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">if</span> (yperdom .or. <a class="code" href="namespaceamr__module.html#ac7ee4de6cf6e5dada17052e87006240b">spheredom</a>) <span class="keywordflow">then</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;       jst(1)  = jlo</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;       jst(2)  = 0</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;       jst(3)  = jregsz(level)</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;       jend(1) = -1</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;       jend(2) = jregsz(level)-1</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;       jend(3) = jhi</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;       jshift(1) = jregsz(level)</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;       jshift(2) = 0</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;       jshift(3) = -jregsz(level)</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;       jst(1)    = jregsz(level)</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;       jst(2)    = jlo</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;       jst(3)    = jregsz(level)</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;       jend(1)   = -1</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;       jend(2)   = jhi</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;       jend(3)   = -1</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;       jshift(1) = 0</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;       jshift(2) = 0</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;       jshift(3) = 0</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">!   ## loop over the 9 regions (in 2D) of the patch - the interior is i=j=2 plus</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">!   ## the ghost cell regions.  If any parts stick out of domain and are periodic</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">!   ## map indices periodically, but stick the values in the correct place</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">!   ## in the orig grid (indicated by iputst,jputst.</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">!   ## if a region sticks out of domain  but is not periodic, not handled in (pre)-icall </span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">!   ## but in setaux/bcamr (not called from here).</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">do</span> 20 i = 1, 3</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        i1 = max(ilo,  ist(i))</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        i2 = min(ihi, iend(i))</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">if</span> (i1 .gt. i2) <span class="keywordflow">go to</span> 20</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">do</span> 10 j = 1, 3</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            j1 = max(jlo,  jst(j))</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            j2 = min(jhi, jend(j))</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="comment">! part of patch in this region</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <span class="keywordflow">if</span> (j1 &lt;= j2) <span class="keywordflow">then</span> </div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                <span class="keywordflow">if</span> (.not. <a class="code" href="namespaceamr__module.html#ac7ee4de6cf6e5dada17052e87006240b">spheredom</a> .or. j .eq. 2) <span class="keywordflow">then</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                    <span class="comment">! make temp patch of just the right size. </span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                    mi = i2 - i1 + 1</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                    mj = j2 - j1 + 1</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                    <span class="keywordflow">if</span> (mi .gt. (ihi-ilo+1) .or.  mj .gt. (jhi-jlo+1))  <span class="keywordflow">then</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                       <span class="keyword">write</span>(*,*)<span class="stringliteral">&quot; prefilp: not big enough dimension&quot;</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keywordflow">                    endif</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                    <span class="keywordflow">if</span> (naux .gt. 0)                                                         &amp;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                        <span class="keyword">call </span><a class="code" href="prefilp_8f90.html#a0ae461010f4abb556af7f9d254c99fef">auxcopyin</a>(auxpatch,mi,mj,auxbig,mitot,mjtot,naux,i1,i2,j1,j2,   &amp;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                                       iglo,jglo)</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                                       </div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                    <span class="keyword">call </span><a class="code" href="filpatch_8f90.html#a842d63d44af2ea44724f2ee0c374438e">filrecur</a>(level,nvar,valpatch,auxpatch,naux,time,mi,mj,       &amp;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                                  1,1,i1+ishift(i),i2+ishift(i),j1+jshift(j),j2+jshift(j),.true.,msrc)</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                    <span class="comment">! copy it back to proper place in valbig </span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                    <span class="keyword">call </span><a class="code" href="prefilp_8f90.html#a915346fec0569f3df802b896f4f0805d">patchcopyout</a>(nvar,valpatch,mi,mj,valbig,mitot,mjtot,i1,i2,j1,j2,   &amp;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                                      iglo,jglo)</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                   </div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                    mi = i2 - i1 + 1</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                    mj = j2 - j1 + 1</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                    ng = 0    <span class="comment">! no ghost cells in this little patch. fill everything.</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                    jbump = 0</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                    <span class="keywordflow">if</span> (j1 &lt; 0)   jbump = abs(j1)  <span class="comment">! bump up so new bottom is 0</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                    <span class="keywordflow">if</span> (j2 &gt;= jregsz(level)) jbump = -(j2+1-jregsz(level)) <span class="comment">! bump down</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                    <span class="comment">! next 2 lines would take care of periodicity in x</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                    iwrap1 = i1 + ishift(i)</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                    iwrap2 = i2 + ishift(i)</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                    <span class="comment">! next 2 lines take care of mapped sphere bcs</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                    iwrap1 = iregsz(level) - iwrap1 -1</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                    iwrap2 = iregsz(level) - iwrap2 -1</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                    <span class="comment">! swap so that smaller one is left index, etc since mapping reflects</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                    tmp = iwrap1</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                    iwrap1 = iwrap2</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                    iwrap2 = tmp</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                    jwrap1 = j1 + jbump</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                    xlwrap = xlower + iwrap1*<a class="code" href="namespaceamr__module.html#af62b98563fd59a5ef279f59f3af56d0e">hxposs</a>(level)</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                    ybwrap = ylower + jwrap1*<a class="code" href="namespaceamr__module.html#ae843bd0d937168c4a0878165e20e796b">hyposs</a>(level)</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                    <span class="keywordflow">if</span> (naux&gt;0) <span class="keywordflow">then</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                        scratchaux = <a class="code" href="namespaceamr__module.html#a7fb7e0d2f2fc883c87e7df2f125f9d9a">needs_to_be_set</a>  <span class="comment">!flag all cells with signal since dimensioned strangely</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                        <span class="keyword">call </span><a class="code" href="setaux_8f90.html#a7212fbd4a35bc6a0c9d629ad14725850">setaux</a>(ng,mi,mj,xlwrap,ybwrap,<a class="code" href="namespaceamr__module.html#af62b98563fd59a5ef279f59f3af56d0e">hxposs</a>(level),<a class="code" href="namespaceamr__module.html#ae843bd0d937168c4a0878165e20e796b">hyposs</a>(level),naux,scratchaux)</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="keywordflow">                    endif</span> </div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                    rect = [iwrap1,iwrap2,j1+jbump,j2+jbump]</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                    <span class="keyword">call </span><a class="code" href="filpatch_8f90.html#a842d63d44af2ea44724f2ee0c374438e">filrecur</a>(level,nvar,scratch,scratchaux,naux,time,mi, &amp;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                                  mj,1,1,iwrap1,iwrap2,j1+jbump,j2+jbump,.false.,msrc)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                    <span class="comment">! copy back using weird mapping for spherical folding (so cant call copy subr below)</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                    <span class="keywordflow">do</span> ii = i1, i2</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                        <span class="keywordflow">do</span> jj = j1, j2</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                            <span class="comment">! write(dbugunit,&#39;(&quot; filling loc &quot;,2i5,&quot; with &quot;,2i5)&#39;) &amp; </span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                            <span class="comment">! nrowst+ii-fill_indices(1),ncolst+jj-fill_indices(3),mi-(ii-i1),mj-jj+j1</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                            <span class="keywordflow">do</span> ivar = 1, nvar</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                                valbig(ivar,nrowst+(ii-ilo),ncolst+(jj-jlo)) = &amp;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                                    scratch(<a class="code" href="prefilp_8f90.html#a2b20545c1baa3a21c8a02f8efa3d377a">iaddscratch</a>(ivar,mi-(ii-i1),mj-(jj-j1)))</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="keywordflow">                            end do</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                            <span class="comment">! write(dbugunit,&#39;(&quot; new val is &quot;,4e15.7)&#39;)(valbig(ivar,  &amp;</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                            <span class="comment">! nrowst+(ii-fill_indices(1)),ncolst+(jj-fill_indices(3))),ivar=1,nvar)</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="keywordflow">                        end do</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="keywordflow">                    end do</span> </div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="keywordflow">                endif</span> <span class="comment">! end if not spherical or j == 2</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="keywordflow">            endif</span> <span class="comment">! end if region not empty</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; 10     <span class="keywordflow">continue</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; 20 <span class="keywordflow">continue</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;           </div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="keyword">contains</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keyword">    integer pure </span><span class="keyword">function </span><a class="code" href="intfil_8f90.html#ab82ff7565af59f230a39f55e157a5c1c">iadd</a>(n,i,j)</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: n, i, j</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <a class="code" href="intfil_8f90.html#ab82ff7565af59f230a39f55e157a5c1c">iadd</a> = locflip + n-1 + nvar*((j-1)*mi+i-1)</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="keyword">    end function </span><a class="code" href="intfil_8f90.html#ab82ff7565af59f230a39f55e157a5c1c">iadd</a></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keyword">    integer pure </span><span class="keyword">function </span><a class="code" href="prefilp_8f90.html#a2b20545c1baa3a21c8a02f8efa3d377a">iaddscratch</a>(n,i,j)</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: n, i, j</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <a class="code" href="prefilp_8f90.html#a2b20545c1baa3a21c8a02f8efa3d377a">iaddscratch</a> = n + nvar*((j-1)*mi+i-1)  <span class="comment">! no subtract 1</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keyword">    end function </span><a class="code" href="prefilp_8f90.html#a2b20545c1baa3a21c8a02f8efa3d377a">iaddscratch</a></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="ttc" id="prefilp_8f90_html_a915346fec0569f3df802b896f4f0805d"><div class="ttname"><a href="prefilp_8f90.html#a915346fec0569f3df802b896f4f0805d">patchcopyout</a></div><div class="ttdeci">subroutine patchcopyout(nvar, valpatch, mi, mj, valbig, mitot, mjtot, i1, i2, j1, j2, iglo, jglo)</div><div class="ttdef"><b>Definition:</b> <a href="prefilp_8f90_source.html#l00219">prefilp.f90:219</a></div></div>
<div class="ttc" id="namespaceamr__module_html_a031ce08951c5413d6e27cf0aa20b4ef3"><div class="ttname"><a href="namespaceamr__module.html#a031ce08951c5413d6e27cf0aa20b4ef3">amr_module::iregsz</a></div><div class="ttdeci">integer, dimension(maxlv) iregsz</div><div class="ttdef"><b>Definition:</b> <a href="amr__module_8f90_source.html#l00198">amr_module.f90:198</a></div></div>
<div class="ttc" id="namespaceamr__module_html_ae843bd0d937168c4a0878165e20e796b"><div class="ttname"><a href="namespaceamr__module.html#ae843bd0d937168c4a0878165e20e796b">amr_module::hyposs</a></div><div class="ttdeci">real(kind=8), dimension(maxlv) hyposs</div><div class="ttdef"><b>Definition:</b> <a href="amr__module_8f90_source.html#l00193">amr_module.f90:193</a></div></div>
<div class="ttc" id="namespaceamr__module_html_af62b98563fd59a5ef279f59f3af56d0e"><div class="ttname"><a href="namespaceamr__module.html#af62b98563fd59a5ef279f59f3af56d0e">amr_module::hxposs</a></div><div class="ttdeci">real(kind=8), dimension(maxlv) hxposs</div><div class="ttdef"><b>Definition:</b> <a href="amr__module_8f90_source.html#l00193">amr_module.f90:193</a></div></div>
<div class="ttc" id="namespaceamr__module_html_ab358b1bbd923fccb6f0f1a9cac199bb5"><div class="ttname"><a href="namespaceamr__module.html#ab358b1bbd923fccb6f0f1a9cac199bb5">amr_module::jregsz</a></div><div class="ttdeci">integer, dimension(maxlv) jregsz</div><div class="ttdef"><b>Definition:</b> <a href="amr__module_8f90_source.html#l00198">amr_module.f90:198</a></div></div>
<div class="ttc" id="prefilp_8f90_html_a2b20545c1baa3a21c8a02f8efa3d377a"><div class="ttname"><a href="prefilp_8f90.html#a2b20545c1baa3a21c8a02f8efa3d377a">iaddscratch</a></div><div class="ttdeci">integer pure function iaddscratch(n, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="prefilp_8f90_source.html#l00207">prefilp.f90:207</a></div></div>
<div class="ttc" id="namespaceamr__module_html_a8b2a33769290641df4fe4f7bf1c47e47"><div class="ttname"><a href="namespaceamr__module.html#a8b2a33769290641df4fe4f7bf1c47e47">amr_module::xlower</a></div><div class="ttdeci">real(kind=8) xlower</div><div class="ttdef"><b>Definition:</b> <a href="amr__module_8f90_source.html#l00231">amr_module.f90:231</a></div></div>
<div class="ttc" id="intfil_8f90_html_ab82ff7565af59f230a39f55e157a5c1c"><div class="ttname"><a href="intfil_8f90.html#ab82ff7565af59f230a39f55e157a5c1c">iadd</a></div><div class="ttdeci">integer pure function iadd(ivar, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="intfil_8f90_source.html#l00294">intfil.f90:294</a></div></div>
<div class="ttc" id="namespaceamr__module_html_a66d22175d9bad91782ee06469fa64fe8"><div class="ttname"><a href="namespaceamr__module.html#a66d22175d9bad91782ee06469fa64fe8">amr_module::yperdom</a></div><div class="ttdeci">logical yperdom</div><div class="ttdef"><b>Definition:</b> <a href="amr__module_8f90_source.html#l00230">amr_module.f90:230</a></div></div>
<div class="ttc" id="namespaceamr__module_html_a0f44819b8d605e4846dc49f3b0b5674b"><div class="ttname"><a href="namespaceamr__module.html#a0f44819b8d605e4846dc49f3b0b5674b">amr_module::ylower</a></div><div class="ttdeci">real(kind=8) ylower</div><div class="ttdef"><b>Definition:</b> <a href="amr__module_8f90_source.html#l00231">amr_module.f90:231</a></div></div>
<div class="ttc" id="namespaceamr__module_html_a7fb7e0d2f2fc883c87e7df2f125f9d9a"><div class="ttname"><a href="namespaceamr__module.html#a7fb7e0d2f2fc883c87e7df2f125f9d9a">amr_module::needs_to_be_set</a></div><div class="ttdeci">real(kind=8), parameter needs_to_be_set</div><div class="ttdef"><b>Definition:</b> <a href="amr__module_8f90_source.html#l00168">amr_module.f90:168</a></div></div>
<div class="ttc" id="namespaceamr__module_html_ac7ee4de6cf6e5dada17052e87006240b"><div class="ttname"><a href="namespaceamr__module.html#ac7ee4de6cf6e5dada17052e87006240b">amr_module::spheredom</a></div><div class="ttdeci">logical spheredom</div><div class="ttdef"><b>Definition:</b> <a href="amr__module_8f90_source.html#l00230">amr_module.f90:230</a></div></div>
<div class="ttc" id="filpatch_8f90_html_a842d63d44af2ea44724f2ee0c374438e"><div class="ttname"><a href="filpatch_8f90.html#a842d63d44af2ea44724f2ee0c374438e">filrecur</a></div><div class="ttdeci">recursive subroutine filrecur(level, nvar, valbig, aux, naux, t, mitot, mjtot, nrowst, ncolst, ilo, ihi, jlo, jhi, patchOnly, msrc)</div><div class="ttdoc">Fill a region (patch) described by: </div><div class="ttdef"><b>Definition:</b> <a href="filpatch_8f90_source.html#l00073">filpatch.f90:73</a></div></div>
<div class="ttc" id="namespaceamr__module_html_ae03f9f21f4caf3a5c1e9c98758c6daee"><div class="ttname"><a href="namespaceamr__module.html#ae03f9f21f4caf3a5c1e9c98758c6daee">amr_module::xperdom</a></div><div class="ttdeci">logical xperdom</div><div class="ttdef"><b>Definition:</b> <a href="amr__module_8f90_source.html#l00230">amr_module.f90:230</a></div></div>
<div class="ttc" id="prefilp_8f90_html_a0ae461010f4abb556af7f9d254c99fef"><div class="ttname"><a href="prefilp_8f90.html#a0ae461010f4abb556af7f9d254c99fef">auxcopyin</a></div><div class="ttdeci">subroutine auxcopyin(auxPatch, mi, mj, auxbig, mitot, mjtot, naux, i1, i2, j1, j2, iglo, jglo)</div><div class="ttdef"><b>Definition:</b> <a href="prefilp_8f90_source.html#l00250">prefilp.f90:250</a></div></div>
<div class="ttc" id="namespaceamr__module_html_a58fe0c14f620a219dfa19d4eabaebaaa"><div class="ttname"><a href="namespaceamr__module.html#a58fe0c14f620a219dfa19d4eabaebaaa">amr_module::nghost</a></div><div class="ttdeci">integer nghost</div><div class="ttdef"><b>Definition:</b> <a href="amr__module_8f90_source.html#l00232">amr_module.f90:232</a></div></div>
<div class="ttc" id="namespaceamr__module_html"><div class="ttname"><a href="namespaceamr__module.html">amr_module</a></div><div class="ttdoc">The module contains the definition of a &quot;node descriptor&quot; as well as other global variables used duri...</div><div class="ttdef"><b>Definition:</b> <a href="amr__module_8f90_source.html#l00021">amr_module.f90:21</a></div></div>
<div class="ttc" id="setaux_8f90_html_a7212fbd4a35bc6a0c9d629ad14725850"><div class="ttname"><a href="setaux_8f90.html#a7212fbd4a35bc6a0c9d629ad14725850">setaux</a></div><div class="ttdeci">subroutine setaux(mbc, mx, my, xlower, ylower, dx, dy, maux, aux)</div><div class="ttdef"><b>Definition:</b> <a href="setaux_8f90_source.html#l00002">setaux.f90:2</a></div></div>
<div class="ttc" id="namespaceamr__module_html_a840234c5236253a654d137e46f0bfecf"><div class="ttname"><a href="namespaceamr__module.html#a840234c5236253a654d137e46f0bfecf">amr_module::alloc</a></div><div class="ttdeci">real(kind=8), dimension(:), allocatable alloc</div><div class="ttdef"><b>Definition:</b> <a href="amr__module_8f90_source.html#l00218">amr_module.f90:218</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="prefilp_8f90_ade3b15439cf99ae8026428a11746757d_cgraph.png" border="0" usemap="#prefilp_8f90_ade3b15439cf99ae8026428a11746757d_cgraph" alt=""/></div>
<map name="prefilp_8f90_ade3b15439cf99ae8026428a11746757d_cgraph" id="prefilp_8f90_ade3b15439cf99ae8026428a11746757d_cgraph">
<area shape="rect" id="node2" href="prefilp_8f90.html#a0ae461010f4abb556af7f9d254c99fef" title="auxcopyin" alt="" coords="144,104,225,129"/>
<area shape="rect" id="node3" href="filpatch_8f90.html#a842d63d44af2ea44724f2ee0c374438e" title="Fill a region (patch) described by: " alt="" coords="154,153,215,179"/>
<area shape="rect" id="node13" href="setaux_8f90.html#a7212fbd4a35bc6a0c9d629ad14725850" title="setaux" alt="" coords="303,252,363,277"/>
<area shape="rect" id="node16" href="prefilp_8f90.html#a2b20545c1baa3a21c8a02f8efa3d377a" title="iaddscratch" alt="" coords="140,255,229,280"/>
<area shape="rect" id="node17" href="prefilp_8f90.html#a915346fec0569f3df802b896f4f0805d" title="patchcopyout" alt="" coords="134,304,235,329"/>
<area shape="rect" id="node4" href="bc2amr_8f.html#a7e58cfdeffec88e9f62a64e63857e6b3" title="Take a grid patch with mesh widths hx,hy, of dimensions nrow by ncol, and set the values of any piece..." alt="" coords="300,5,366,31"/>
<area shape="rect" id="node5" href="filpatch_8f90.html#a8b84451cffc665c6cc2841b348d1e16e" title="coarse_index" alt="" coords="283,55,383,80"/>
<area shape="rect" id="node6" href="intfil_8f90.html#ae482a08fd0210f2a24f3395a6029916b" title="Fill values for a patch at the specified level and location, using values from grids at level level O..." alt="" coords="310,104,355,129"/>
<area shape="rect" id="node14" href="filpatch_8f90.html#a3ee0bacda28769e7fedf28b0c0851864" title="sticksout" alt="" coords="296,153,370,179"/>
<area shape="rect" id="node15" href="trimbd_8f90.html#acf00ed933450aab26ee6f9ca7b583f0d" title="Examine the setting status of a patch. " alt="" coords="304,203,362,228"/>
<area shape="rect" id="node7" href="intfil_8f90.html#ab82ff7565af59f230a39f55e157a5c1c" title="iadd" alt="" coords="440,31,486,56"/>
<area shape="rect" id="node8" href="intfil_8f90.html#addc8d9262584651a89fe40e601163a03" title="iadnew" alt="" coords="431,80,495,105"/>
<area shape="rect" id="node9" href="intfil_8f90.html#ad9c8d71aef58b27732954c64f1d386d2" title="iadold" alt="" coords="435,129,491,155"/>
<area shape="rect" id="node10" href="outtre_8f.html#ab28134bcbe7f2491b96a1034b04b2b0d" title="Output a subtree of the grids. " alt="" coords="435,179,491,204"/>
<area shape="rect" id="node11" href="outmsh_8f.html#ac65cf64979d03bb53db746fbd031c3be" title="Output the grid descriptor of grid mptr and optionally the values on the grid (for a single grid &#45; se..." alt="" coords="543,179,608,204"/>
<area shape="rect" id="node12" href="outval_8f.html#a7bb33fa749e7c165d84e0e56586f0845" title="print solution and aux. " alt="" coords="656,179,713,204"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="prefilp_8f90_ade3b15439cf99ae8026428a11746757d_icgraph.png" border="0" usemap="#prefilp_8f90_ade3b15439cf99ae8026428a11746757d_icgraph" alt=""/></div>
<map name="prefilp_8f90_ade3b15439cf99ae8026428a11746757d_icgraph" id="prefilp_8f90_ade3b15439cf99ae8026428a11746757d_icgraph">
<area shape="rect" id="node2" href="bound_8f90.html#ad00f57f1c18c6e2fb99593e3e7fde889" title="This routine sets the boundary values for a given grid at level level. " alt="" coords="245,101,303,126"/>
<area shape="rect" id="node16" href="filpatch_8f90.html#a842d63d44af2ea44724f2ee0c374438e" title="Fill a region (patch) described by: " alt="" coords="134,150,195,176"/>
<area shape="rect" id="node3" href="advanc_8f.html#a7619f88bd394d1873fac570dd990c73d" title="Integrate all grids at the input level by one step of its delta(t) " alt="" coords="809,25,873,50"/>
<area shape="rect" id="node7" href="flagger_8f.html#aa01ccdd832604fd7276c0a0d6dc97e19" title="Set up for and call two routines that flag using (a) spatial gradients, or other user&#45;specified crite..." alt="" coords="595,125,657,150"/>
<area shape="rect" id="node13" href="prepbigstep_8f.html#a3a50bfe12799e99f4e7238e571249888" title="prepbigstep" alt="" coords="353,76,444,101"/>
<area shape="rect" id="node15" href="spest2_8f.html#acb696b8536cf1c510bad11ce3feeb65f" title="spest2" alt="" coords="368,177,428,202"/>
<area shape="rect" id="node4" href="setgrd_8f.html#a8a283984c61bf6aae3fe94b76c80187c" title="setgrd" alt="" coords="926,25,985,50"/>
<area shape="rect" id="node6" href="tick_8f.html#a0f3d6e1153a914673fff20a5f339838f" title="tick" alt="" coords="1054,74,1095,100"/>
<area shape="rect" id="node5" href="amr2_8f90.html#a0397ec684f16719bd6dbe7192f654962" title="amr2" alt="" coords="1158,49,1210,74"/>
<area shape="rect" id="node8" href="flglvl2_8f.html#a3e87b2987fe5b352527d32542b051f88" title="Controls the error estimation/flagging bad pts. " alt="" coords="705,125,761,150"/>
<area shape="rect" id="node9" href="grdfit2_8f.html#af2c87ed572e707000494dd5b41df3749" title="This subroutine is called by setgrd and regrid to actually fit the new grids on each level..." alt="" coords="815,125,866,150"/>
<area shape="rect" id="node10" href="moment_8f.html#a1daedabc834d90c804a58bb83b766bbe" title="Compute enclosing rectangle around flagged points. " alt="" coords="921,176,990,201"/>
<area shape="rect" id="node12" href="regrid_8f.html#a042dfbc681db663819f65973d64f1c08" title="regrid" alt="" coords="928,74,983,100"/>
<area shape="rect" id="node11" href="smartbis_8f.html#ac10b1eb01bf006097c727f93970c8e98" title="Smart bisect rectangles until cutoff reached for each. " alt="" coords="1038,150,1110,176"/>
<area shape="rect" id="node14" href="errest_8f.html#a6549b2bd369989221d46011503fd612f" title="errest" alt="" coords="492,76,547,101"/>
<area shape="rect" id="node17" href="filpatch__orig_8f90.html#a17a35753c2dde1dd9f3ef43ae9312ef0" title="filrecur" alt="" coords="243,150,305,176"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun May 7 2017 10:59:40 for 2D AMRCLAW by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
