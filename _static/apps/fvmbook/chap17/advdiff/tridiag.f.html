<!-- **** DO NOT EDIT THIS FILE *** 
         This file was generated automatically from file
              tridiag.f
         using $CLAW/clawutil/src/python/clawutil/clawcode2html.py         -->

<html>
<title> tridiag.f.html </title>


          <head>
           <link rel="icon" href="http://clawpack.github.io//clawicon.ico" />
          </head> 
           <BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#0000FF" 
                 VLINK="#5500DD" ALINK="#FF0000">
           <font FACE="HELVETICA,ARIAL">
           
<!-- Created from the file /Users/rjl/git/clawpack/apps/fvmbook/chap17/advdiff/tridiag.f -->
<!-- Date: Wed Jan  4 2017 at 21:04:11 -->

<table bgcolor="#FFEE99"> <tr> <td>
&nbsp;<font size=6> tridiag.f.html </font> </td>

            <td><a href="http://clawpack.github.io/doc/index.html"><img
            src="http://clawpack.github.io//clawlogo.jpg"
            width=100 alt="CLAWPACK"></a>&nbsp;&nbsp; </td> </tr> <tr> <td>
&nbsp;Source file: &nbsp;&nbsp;<a href="tridiag.f">tridiag.f </a>
</td></tr><tr><td>
&nbsp;Directory:  &nbsp; /Users/rjl/git/clawpack/apps/fvmbook/chap17/advdiff 
</td></tr><tr><td>
&nbsp;Converted:  &nbsp; Wed Jan  4 2017 at 21:04:11 
&nbsp; using <a href="http://clawpack.github.io//doc/application_documentation.html#clawcode2html">clawcode2html</a>
</td></tr><tr><td>
<font color="#BB3300"> &nbsp;This documentation file will 
not reflect any later changes in the source file. </font>
</td></tr></table></font>
<p>
<pre> 
<font color="blue">c</font>
<font color="blue">c  LAPACK routines to solve a general tridiagonal linear system, </font>
<font color="blue">c  used in src1.f for applying an implicit method to the diffusion equation.  </font>
<font color="blue">c</font>
<font color="blue">c  This file may not be needed if you already have lapack on your system.</font>
<font color="blue">c</font>
<font color="blue">c</font>
<font color="blue">c</font>
      SUBROUTINE DGTSV( N, NRHS, DL, D, DU, B, LDB, INFO )
<font color="blue">*</font>
<font color="blue">*  -- LAPACK routine (version 3.0) --</font>
<font color="blue">*     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</font>
<font color="blue">*     Courant Institute, Argonne National Lab, and Rice University</font>
<font color="blue">*     October 31, 1999</font>
<font color="blue">*</font>
<font color="blue">*     .. Scalar Arguments ..</font>
      INTEGER            INFO, LDB, N, NRHS
<font color="blue">*     ..</font>
<font color="blue">*     .. Array Arguments ..</font>
      DOUBLE PRECISION   B( LDB, * ), D( * ), DL( * ), DU( * )
<font color="blue">*     ..</font>
<font color="blue">*</font>
<font color="blue">*  Purpose</font>
<font color="blue">*  =======</font>
<font color="blue">*</font>
<font color="blue">*  DGTSV  solves the equation</font>
<font color="blue">*</font>
<font color="blue">*     A*X = B,</font>
<font color="blue">*</font>
<font color="blue">*  where A is an n by n tridiagonal matrix, by Gaussian elimination with</font>
<font color="blue">*  partial pivoting.</font>
<font color="blue">*</font>
<font color="blue">*  Note that the equation  A'*X = B  may be solved by interchanging the</font>
<font color="blue">*  order of the arguments DU and DL.</font>
<font color="blue">*</font>
<font color="blue">*  Arguments</font>
<font color="blue">*  =========</font>
<font color="blue">*</font>
<font color="blue">*  N       (input) INTEGER</font>
<font color="blue">*          The order of the matrix A.  N >= 0.</font>
<font color="blue">*</font>
<font color="blue">*  NRHS    (input) INTEGER</font>
<font color="blue">*          The number of right hand sides, i.e., the number of columns</font>
<font color="blue">*          of the matrix B.  NRHS >= 0.</font>
<font color="blue">*</font>
<font color="blue">*  DL      (input/output) DOUBLE PRECISION array, dimension (N-1)</font>
<font color="blue">*          On entry, DL must contain the (n-1) sub-diagonal elements of</font>
<font color="blue">*          A.</font>
<font color="blue">*</font>
<font color="blue">*          On exit, DL is overwritten by the (n-2) elements of the</font>
<font color="blue">*          second super-diagonal of the upper triangular matrix U from</font>
<font color="blue">*          the LU factorization of A, in DL(1), ..., DL(n-2).</font>
<font color="blue">*</font>
<font color="blue">*  D       (input/output) DOUBLE PRECISION array, dimension (N)</font>
<font color="blue">*          On entry, D must contain the diagonal elements of A.</font>
<font color="blue">*</font>
<font color="blue">*          On exit, D is overwritten by the n diagonal elements of U.</font>
<font color="blue">*</font>
<font color="blue">*  DU      (input/output) DOUBLE PRECISION array, dimension (N-1)</font>
<font color="blue">*          On entry, DU must contain the (n-1) super-diagonal elements</font>
<font color="blue">*          of A.</font>
<font color="blue">*</font>
<font color="blue">*          On exit, DU is overwritten by the (n-1) elements of the first</font>
<font color="blue">*          super-diagonal of U.</font>
<font color="blue">*</font>
<font color="blue">*  B       (input/output) DOUBLE PRECISION array, dimension (LDB,NRHS)</font>
<font color="blue">*          On entry, the N by NRHS matrix of right hand side matrix B.</font>
<font color="blue">*          On exit, if INFO = 0, the N by NRHS solution matrix X.</font>
<font color="blue">*</font>
<font color="blue">*  LDB     (input) INTEGER</font>
<font color="blue">*          The leading dimension of the array B.  LDB >= max(1,N).</font>
<font color="blue">*</font>
<font color="blue">*  INFO    (output) INTEGER</font>
<font color="blue">*          = 0: successful exit</font>
<font color="blue">*          < 0: if INFO = -i, the i-th argument had an illegal value</font>
<font color="blue">*          > 0: if INFO = i, U(i,i) is exactly zero, and the solution</font>
<font color="blue">*               has not been computed.  The factorization has not been</font>
<font color="blue">*               completed unless i = N.</font>
<font color="blue">*</font>
<font color="blue">*  =====================================================================</font>
<font color="blue">*</font>
<font color="blue">*     .. Parameters ..</font>
      DOUBLE PRECISION   ZERO
      PARAMETER          ( ZERO = 0.0D+0 )
<font color="blue">*     ..</font>
<font color="blue">*     .. Local Scalars ..</font>
      INTEGER            I, J
      DOUBLE PRECISION   FACT, TEMP
<font color="blue">*     ..</font>
<font color="blue">*     .. Intrinsic Functions ..</font>
      INTRINSIC          ABS, MAX
<font color="blue">*     ..</font>
<font color="blue">*     .. External Subroutines ..</font>
      EXTERNAL           XERBLA
<font color="blue">*     ..</font>
<font color="blue">*     .. Executable Statements ..</font>
<font color="blue">*</font>
      INFO = 0
      IF( N.LT.0 ) THEN
         INFO = -1
      ELSE IF( NRHS.LT.0 ) THEN
         INFO = -2
      ELSE IF( LDB.LT.MAX( 1, N ) ) THEN
         INFO = -7
      END IF
      IF( INFO.NE.0 ) THEN
         CALL XERBLA( 'DGTSV ', -INFO )
         RETURN
      END IF
<font color="blue">*</font>
      IF( N.EQ.0 )
     $   RETURN
<font color="blue">*</font>
      IF( NRHS.EQ.1 ) THEN
         DO 10 I = 1, N - 2
            IF( ABS( D( I ) ).GE.ABS( DL( I ) ) ) THEN
<font color="blue">*</font>
<font color="blue">*              No row interchange required</font>
<font color="blue">*</font>
               IF( D( I ).NE.ZERO ) THEN
                  FACT = DL( I ) / D( I )
                  D( I+1 ) = D( I+1 ) - FACT*DU( I )
                  B( I+1, 1 ) = B( I+1, 1 ) - FACT*B( I, 1 )
               ELSE
                  INFO = I
                  RETURN
               END IF
               DL( I ) = ZERO
            ELSE
<font color="blue">*</font>
<font color="blue">*              Interchange rows I and I+1</font>
<font color="blue">*</font>
               FACT = D( I ) / DL( I )
               D( I ) = DL( I )
               TEMP = D( I+1 )
               D( I+1 ) = DU( I ) - FACT*TEMP
               DL( I ) = DU( I+1 )
               DU( I+1 ) = -FACT*DL( I )
               DU( I ) = TEMP
               TEMP = B( I, 1 )
               B( I, 1 ) = B( I+1, 1 )
               B( I+1, 1 ) = TEMP - FACT*B( I+1, 1 )
            END IF
   10    CONTINUE
         IF( N.GT.1 ) THEN
            I = N - 1
            IF( ABS( D( I ) ).GE.ABS( DL( I ) ) ) THEN
               IF( D( I ).NE.ZERO ) THEN
                  FACT = DL( I ) / D( I )
                  D( I+1 ) = D( I+1 ) - FACT*DU( I )
                  B( I+1, 1 ) = B( I+1, 1 ) - FACT*B( I, 1 )
               ELSE
                  INFO = I
                  RETURN
               END IF
            ELSE
               FACT = D( I ) / DL( I )
               D( I ) = DL( I )
               TEMP = D( I+1 )
               D( I+1 ) = DU( I ) - FACT*TEMP
               DU( I ) = TEMP
               TEMP = B( I, 1 )
               B( I, 1 ) = B( I+1, 1 )
               B( I+1, 1 ) = TEMP - FACT*B( I+1, 1 )
            END IF
         END IF
         IF( D( N ).EQ.ZERO ) THEN
            INFO = N
            RETURN
         END IF
      ELSE
         DO 40 I = 1, N - 2
            IF( ABS( D( I ) ).GE.ABS( DL( I ) ) ) THEN
<font color="blue">*</font>
<font color="blue">*              No row interchange required</font>
<font color="blue">*</font>
               IF( D( I ).NE.ZERO ) THEN
                  FACT = DL( I ) / D( I )
                  D( I+1 ) = D( I+1 ) - FACT*DU( I )
                  DO 20 J = 1, NRHS
                     B( I+1, J ) = B( I+1, J ) - FACT*B( I, J )
   20             CONTINUE
               ELSE
                  INFO = I
                  RETURN
               END IF
               DL( I ) = ZERO
            ELSE
<font color="blue">*</font>
<font color="blue">*              Interchange rows I and I+1</font>
<font color="blue">*</font>
               FACT = D( I ) / DL( I )
               D( I ) = DL( I )
               TEMP = D( I+1 )
               D( I+1 ) = DU( I ) - FACT*TEMP
               DL( I ) = DU( I+1 )
               DU( I+1 ) = -FACT*DL( I )
               DU( I ) = TEMP
               DO 30 J = 1, NRHS
                  TEMP = B( I, J )
                  B( I, J ) = B( I+1, J )
                  B( I+1, J ) = TEMP - FACT*B( I+1, J )
   30          CONTINUE
            END IF
   40    CONTINUE
         IF( N.GT.1 ) THEN
            I = N - 1
            IF( ABS( D( I ) ).GE.ABS( DL( I ) ) ) THEN
               IF( D( I ).NE.ZERO ) THEN
                  FACT = DL( I ) / D( I )
                  D( I+1 ) = D( I+1 ) - FACT*DU( I )
                  DO 50 J = 1, NRHS
                     B( I+1, J ) = B( I+1, J ) - FACT*B( I, J )
   50             CONTINUE
               ELSE
                  INFO = I
                  RETURN
               END IF
            ELSE
               FACT = D( I ) / DL( I )
               D( I ) = DL( I )
               TEMP = D( I+1 )
               D( I+1 ) = DU( I ) - FACT*TEMP
               DU( I ) = TEMP
               DO 60 J = 1, NRHS
                  TEMP = B( I, J )
                  B( I, J ) = B( I+1, J )
                  B( I+1, J ) = TEMP - FACT*B( I+1, J )
   60          CONTINUE
            END IF
         END IF
         IF( D( N ).EQ.ZERO ) THEN
            INFO = N
            RETURN
         END IF
      END IF
<font color="blue">*</font>
<font color="blue">*     Back solve with the matrix U from the factorization.</font>
<font color="blue">*</font>
      IF( NRHS.LE.2 ) THEN
         J = 1
   70    CONTINUE
         B( N, J ) = B( N, J ) / D( N )
         IF( N.GT.1 )
     $      B( N-1, J ) = ( B( N-1, J )-DU( N-1 )*B( N, J ) ) / D( N-1 )
         DO 80 I = N - 2, 1, -1
            B( I, J ) = ( B( I, J )-DU( I )*B( I+1, J )-DL( I )*
     $                  B( I+2, J ) ) / D( I )
   80    CONTINUE
         IF( J.LT.NRHS ) THEN
            J = J + 1
            GO TO 70
         END IF
      ELSE
         DO 100 J = 1, NRHS
            B( N, J ) = B( N, J ) / D( N )
            IF( N.GT.1 )
     $         B( N-1, J ) = ( B( N-1, J )-DU( N-1 )*B( N, J ) ) /
     $                       D( N-1 )
            DO 90 I = N - 2, 1, -1
               B( I, J ) = ( B( I, J )-DU( I )*B( I+1, J )-DL( I )*
     $                     B( I+2, J ) ) / D( I )
   90       CONTINUE
  100    CONTINUE
      END IF
<font color="blue">*</font>
      RETURN
<font color="blue">*</font>
<font color="blue">*     End of DGTSV</font>
<font color="blue">*</font>
      END
      SUBROUTINE XERBLA( SRNAME, INFO )
<font color="blue">*</font>
<font color="blue">*  -- LAPACK auxiliary routine (preliminary version) --</font>
<font color="blue">*     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</font>
<font color="blue">*     Courant Institute, Argonne National Lab, and Rice University</font>
<font color="blue">*     February 29, 1992</font>
<font color="blue">*</font>
<font color="blue">*     .. Scalar Arguments ..</font>
      CHARACTER*6        SRNAME
      INTEGER            INFO
<font color="blue">*     ..</font>
<font color="blue">*</font>
<font color="blue">*  Purpose</font>
<font color="blue">*  =======</font>
<font color="blue">*</font>
<font color="blue">*  XERBLA  is an error handler for the LAPACK routines.</font>
<font color="blue">*  It is called by an LAPACK routine if an input parameter has an</font>
<font color="blue">*  invalid value.  A message is printed and execution stops.</font>
<font color="blue">*</font>
<font color="blue">*  Installers may consider modifying the STOP statement in order to</font>
<font color="blue">*  call system-specific exception-handling facilities.</font>
<font color="blue">*</font>
<font color="blue">*  Arguments</font>
<font color="blue">*  =========</font>
<font color="blue">*</font>
<font color="blue">*  SRNAME  (input) CHARACTER*6</font>
<font color="blue">*          The name of the routine which called XERBLA.</font>
<font color="blue">*</font>
<font color="blue">*  INFO    (input) INTEGER</font>
<font color="blue">*          The position of the invalid parameter in the parameter list</font>
<font color="blue">*          of the calling routine.</font>
<font color="blue">*</font>
<font color="blue">*</font>
      WRITE( *, FMT = 9999 )SRNAME, INFO
<font color="blue">*</font>
      STOP
<font color="blue">*</font>
 9999 FORMAT( ' ** On entry to ', A6, ' parameter number ', I2, ' had ',
     $      'an illegal value' )
<font color="blue">*</font>
<font color="blue">*     End of XERBLA</font>
<font color="blue">*</font>
      END

</pre></html>
