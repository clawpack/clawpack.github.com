<!-- **** DO NOT EDIT THIS FILE *** 
         This file was generated automatically from file
              plot_fgmax.py
         using $CLAW/clawutil/src/python/clawutil/clawcode2html.py         -->

<html>
<title> plot_fgmax.py.html </title>


          <head>
           <link rel="icon" href="http://clawpack.github.io//clawicon.ico" />
          </head> 
           <BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#0000FF" 
                 VLINK="#5500DD" ALINK="#FF0000">
           <font FACE="HELVETICA,ARIAL">
           
<!-- Created from the file /Users/rjl/git/clawpack/apps/tsunami/bowl_radial_fgmax/plot_fgmax.py -->
<!-- Date: Tue Apr 28 2015 at 11:27:40 -->

<table bgcolor="#FFEE99"> <tr> <td>
&nbsp;<font size=6> plot_fgmax.py.html </font> </td>

            <td><a href="http://clawpack.github.io/doc/index.html"><img
            src="http://clawpack.github.io//clawlogo.jpg"
            width=100 alt="CLAWPACK"></a>&nbsp;&nbsp; </td> </tr> <tr> <td>
&nbsp;Source file: &nbsp;&nbsp;<a href="plot_fgmax.py">plot_fgmax.py </a>
</td></tr><tr><td>
&nbsp;Directory:  &nbsp; /Users/rjl/git/clawpack/apps/tsunami/bowl_radial_fgmax 
</td></tr><tr><td>
&nbsp;Converted:  &nbsp; Tue Apr 28 2015 at 11:27:40 
&nbsp; using <a href="http://clawpack.github.io//doc/application_documentation.html#clawcode2html">clawcode2html</a>
</td></tr><tr><td>
<font color="#BB3300"> &nbsp;This documentation file will 
not reflect any later changes in the source file. </font>
</td></tr></table></font>
<p>
<pre> 
"""
Plot fgmax output from GeoClaw run.

"""

import matplotlib.pyplot as plt
import numpy
from clawpack.geoclaw import fgmax_tools, geoplot
from numpy import ma  <font color="blue"># masked arrays</font>

dry_tolerance = 1e-2   <font color="blue"># smaller h treated as dry</font>

def plot_fgmax_grid(fgno):

    fg = fgmax_tools.FGmaxGrid()
    fname = 'fgmax_grid%s.txt' % fgno
    fg.read_input_data(fname)
    fg.read_output(fgno)

    clines_zeta = [0.01] + list(numpy.linspace(.3, 2.1, 7))
    colors = geoplot.discrete_cmap_1(clines_zeta)
    plt.figure(fgno)
    plt.clf()

    <font color="blue"># set zeta = max depth on shore, max surface elevation offshore:</font>
    zeta = numpy.where(fg.B>0, fg.h, fg.h+fg.B)   

    plt.contourf(fg.X,fg.Y,zeta,clines_zeta,colors=colors,extend='max')
    plt.colorbar(extend='max')
    <font color="blue">#plt.contour(fg.X,fg.Y,fg.B,[0.],colors='k')  # coastline</font>

    <font color="blue"># plot original coastline extending beyond fgmax region:</font>
    theta = numpy.linspace(-numpy.pi/8., 3/8. *numpy.pi, 1000)
    plt.plot(90*numpy.cos(theta), 90*numpy.sin(theta), 'k')

    <font color="blue"># fix axes:</font>
    plt.ticklabel_format(format='plain',useOffset=False)
    plt.xticks(rotation=20)
    plt.gca().set_aspect(1./numpy.cos(fg.Y.mean()*numpy.pi/180.))
    plt.title("Zeta = max depth or surface elevation")
    plt.axis('scaled')
    if fgno==1:
        plt.axis([85,95,-5,5])
    else:
        plt.axis([59,69,59,69])

def plot_fgmax_transects():

    <font color="blue"># === Transect on x-axis:</font>
    fg = fgmax_tools.FGmaxGrid()
    fg.read_input_data('fgmax_transect1.txt')
    fg.read_output(3)

    plt.figure(3)
    plt.clf()

    surface = ma.masked_where(fg.h < dry_tolerance, fg.B+fg.h)
    sea_level = 0.
    surface_original = ma.masked_where(fg.B > 0, sea_level*numpy.ones(fg.B.shape))

    <font color="blue"># distance along transect:</font>
    xi = numpy.sqrt((fg.X-fg.X[0])**2 + (fg.Y-fg.Y[0])**2)  

    plt.plot(xi, fg.B, 'g')    <font color="blue"># topography</font>
    plt.plot(xi,surface_original, 'k')
    plt.plot(xi,surface, 'b', label="along x-axis")

    <font color="blue"># === Transect on diagonal:</font>
    fg = fgmax_tools.FGmaxGrid()
    fg.read_input_data('fgmax_transect2.txt')
    fg.read_output(4)

    surface = ma.masked_where(fg.h < dry_tolerance, fg.B+fg.h)

    xi = numpy.sqrt((fg.X-fg.X[0])**2 + (fg.Y-fg.Y[0])**2)  
    plt.plot(xi,surface, 'r', label="along diagonal")
    plt.legend(loc="lower right")

    plt.title("Max elevation along transects vs distance")

    <font color="blue"># === Along shoreline:</font>
    fg = fgmax_tools.FGmaxGrid()
    fg.read_input_data('fgmax_along_shore.txt')
    fg.read_output(5)
    plt.figure(5)
    theta = numpy.arctan(fg.Y / fg.X)
    plt.plot(theta,  fg.h, 'b')
    plt.title("Max elevation along shore (radius 90 m) vs angle")
    plt.xticks([0,numpy.pi/4.], ['0','pi/4'])
    plt.xlabel('theta')
    plt.ylabel('meters')


if __name__=="__main__":

    import os
    plotdir = '_plots'
    if not os.path.isdir(plotdir): 
        os.mkdir(plotdir)

    plot_fgmax_grid(1)
    plt.figure(1)
    fname = os.path.join(plotdir, "fgmax_grid1.png")
    plt.savefig(fname)
    print "Created ",fname

    plot_fgmax_grid(2)
    plt.figure(2)
    fname = os.path.join(plotdir, "fgmax_grid2.png")
    plt.savefig(fname)
    print "Created ",fname

    plot_fgmax_transects()
    plt.figure(3)
    fname = os.path.join(plotdir, "fgmax_transects.png")
    plt.savefig(fname)
    print "Created ",fname

    plt.figure(5)
    fname = os.path.join(plotdir, "fgmax_along_shore.png")
    plt.savefig(fname)
    print "Created ",fname


</pre></html>
