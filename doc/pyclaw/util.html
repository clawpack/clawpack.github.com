<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Pyclaw Utility Module &mdash; Clawpack 5.2.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/base.css" type="text/css" />
    <link rel="stylesheet" href="../_static/layout.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/clawicon.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="top" title="Clawpack 5.2.0 documentation" href="../index.html" />
    <link rel="up" title="Pyclaw" href="index.html" />
    <link rel="next" title="Riemann Solver Package" href="rp.html" />
    <link rel="prev" title="PyClaw Geometry" href="geometry.html" /> 
  </head>
  <body>
<div id="main-wrapper" class="sphinx">
<div id="header-wrapper">
  <section id="header">
    <!-- <h1><a href="http://clawpack.org/">Clawpack</a></h1> -->
    <h1><a href="http://clawpack.org/">Clawpack-5</a></h1> 
    <nav>
      <ul>
        <li>
          <a href="../toc_condensed.html">Docs</a>
        </li>
        <li>
          <a href="../installing.html">Install</a>
        </li>
        <li>
          <a class="" href="../galleries.html">Gallery</a>
        </li>
        <li>
          <a class="active" href="https://groups.google.com/forum/#!forum/claw-users">Support</a>
        </li>
        <li>
          <a class="active" href="http://github.com/organizations/clawpack">Source</a>
        </li>
        <li>
          <a class="" href="../developers.html">Develop</a>
        </li>
      </ul>
    </nav>
  </section>
<div class="decoration"></div>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="rp.html" title="Riemann Solver Package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="geometry.html" title="PyClaw Geometry"
             accesskey="P">previous</a> |</li>
        <li><a href="../contents.html">Clawpack 5.2.0 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Pyclaw</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="pyclaw-utility-module">
<span id="pyclaw-util"></span><h1>Pyclaw Utility Module<a class="headerlink" href="#pyclaw-utility-module" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-pyclaw.util">
<span id="id1"></span><h2><a class="reference internal" href="#module-pyclaw.util" title="pyclaw.util"><tt class="xref py py-mod docutils literal"><span class="pre">pyclaw.util</span></tt></a><a class="headerlink" href="#module-pyclaw.util" title="Permalink to this headline">¶</a></h2>
<p>Pyclaw utility methods</p>
<dl class="class">
<dt id="pyclaw.util.FrameCounter">
<em class="property">class </em><tt class="descclassname">pyclaw.util.</tt><tt class="descname">FrameCounter</tt><a class="headerlink" href="#pyclaw.util.FrameCounter" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple frame counter</p>
<p>Simple frame counter to keep track of current frame number.  This can
also be used to keep multiple runs frames seperated by having multiple
counters at once.</p>
<p>Initializes to 0</p>
<dl class="method">
<dt id="pyclaw.util.FrameCounter.get_counter">
<tt class="descname">get_counter</tt><big>(</big><big>)</big><a class="headerlink" href="#pyclaw.util.FrameCounter.get_counter" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current frame number</p>
</dd></dl>

<dl class="method">
<dt id="pyclaw.util.FrameCounter.increment">
<tt class="descname">increment</tt><big>(</big><big>)</big><a class="headerlink" href="#pyclaw.util.FrameCounter.increment" title="Permalink to this definition">¶</a></dt>
<dd><p>Increment the counter by one</p>
</dd></dl>

<dl class="method">
<dt id="pyclaw.util.FrameCounter.reset_counter">
<tt class="descname">reset_counter</tt><big>(</big><big>)</big><a class="headerlink" href="#pyclaw.util.FrameCounter.reset_counter" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the counter to 0</p>
</dd></dl>

<dl class="method">
<dt id="pyclaw.util.FrameCounter.set_counter">
<tt class="descname">set_counter</tt><big>(</big><em>new_frame_num</em><big>)</big><a class="headerlink" href="#pyclaw.util.FrameCounter.set_counter" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the counter to new_frame_num</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pyclaw.util.add_parent_doc">
<tt class="descclassname">pyclaw.util.</tt><tt class="descname">add_parent_doc</tt><big>(</big><em>parent</em><big>)</big><a class="headerlink" href="#pyclaw.util.add_parent_doc" title="Permalink to this definition">¶</a></dt>
<dd><p>add parent documentation for a class</p>
</dd></dl>

<dl class="function">
<dt id="pyclaw.util.check_diff">
<tt class="descclassname">pyclaw.util.</tt><tt class="descname">check_diff</tt><big>(</big><em>expected</em>, <em>test</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyclaw.util.check_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the difference between expected and test values, return None if ok</p>
<p>This function expects either the keyword argument &#8216;abstol&#8217; or &#8216;reltol&#8217;.</p>
</dd></dl>

<dl class="function">
<dt id="pyclaw.util.compile_library">
<tt class="descclassname">pyclaw.util.</tt><tt class="descname">compile_library</tt><big>(</big><em>source_list</em>, <em>module_name</em>, <em>interface_functions=</em>, <span class="optional">[</span><span class="optional">]</span><em>local_path='./'</em>, <em>library_path='./'</em>, <em>f2py_flags=''</em>, <em>FC=None</em>, <em>FFLAGS=None</em>, <em>recompile=False</em>, <em>clean=False</em><big>)</big><a class="headerlink" href="#pyclaw.util.compile_library" title="Permalink to this definition">¶</a></dt>
<dd><p>Compiles and wraps fortran source into a callable module in python.</p>
<p>This function uses f2py to create an interface from python to the fortran
sources in source_list.  The source_list can either be a list of names
of source files in which case compile_library will search for the file in
local_path and then in library_path.  If a path is given, the file will be
checked to see if it exists, if not it will look for the file in the above
resolution order.  If any source file is not found, an IOException is
raised.</p>
<p>The list interface_functions allows the user to specify which fortran
functions are actually available to python.  The interface functions are
assumed to be in the file with their name, i.e. claw1 is located in
&#8216;claw1.f95&#8217; or &#8216;claw1.f&#8217;.</p>
<p>The interface from fortran may be different than the original function
call in fortran so the user should make sure to check the automatically
created doc string for the fortran module for proper use.</p>
<p>Source files will not be recompiled if they have not been changed.</p>
<p>One set of options of note is for enabling OpenMP, it requires the usual
fortran flags but the OpenMP library also must be compiled in, this is
done with the flag -lgomp.  The call to compile_library would then be:</p>
<p>compile_library(src,module_name,f2py_flags=&#8217;-lgomp&#8217;,FFLAGS=&#8217;-fopenmp&#8217;)</p>
<p>For complete optimization use:</p>
<p>FFLAGS=&#8217;-O3 -fopenmp -funroll-loops -finline-functions -fdefault-real-8&#8217;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Input:</th><td class="field-body"><ul class="first last simple">
<li><em>source_list</em> - (list of strings) List of source files, if these are
just names of the source files, i.e. &#8216;bc1.f&#8217; then they will be searched
for in the default source resolution order, if an explicit path is
given, i.e. &#8216;./bc1.f&#8217;, then the function will use that source if it can
find it.</li>
<li><em>module_name</em> - (string) Name of the resulting module</li>
<li><em>interface_functions</em> - (list of strings) List of function names to
provide access to, if empty, all functions are accessible to python.
Defaults to [].</li>
<li><em>local_path</em> - (string) The base path for source resolution, defaults
to &#8216;./&#8217;.</li>
<li><em>library_path</em> - (string) The library path for source resolution,
defaults to &#8216;./&#8217;.</li>
<li><em>f2py_flags</em> - (string) f2py flags to be passed</li>
<li><em>FC</em> - (string) Override the environment variable FC and use it to
compile, note that this does not replace the compiler that f2py uses,
only the object file compilation (functions that do not have
interfaces)</li>
<li><em>FFLAGS</em> - (string) Override the environment variable FFLAGS and pass
them to the fortran compiler</li>
<li><em>recompile</em> - (bool) Force recompilation of the library, defaults to
False</li>
<li><em>clean</em> - (bool) Force a clean build of all source files</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyclaw.util.construct_function_handle">
<tt class="descclassname">pyclaw.util.</tt><tt class="descname">construct_function_handle</tt><big>(</big><em>path</em>, <em>function_name=None</em><big>)</big><a class="headerlink" href="#pyclaw.util.construct_function_handle" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs a function handle from the file at path.</p>
<p>This function will attempt to construct a function handle from the python
file at path.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Input:</th><td class="field-body"><ul class="first simple">
<li><em>path</em> - (string) Path to the file containing the function</li>
<li><em>function_name</em> - (string) Name of the function defined in the file
that the handle will point to.  Defaults to the same name as the file
without the extension.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Output:</th><td class="field-body"><ul class="first last simple">
<li>(func) Function handle to the constructed function, None if this has
failed.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyclaw.util.convert_fort_double_to_float">
<tt class="descclassname">pyclaw.util.</tt><tt class="descname">convert_fort_double_to_float</tt><big>(</big><em>number</em><big>)</big><a class="headerlink" href="#pyclaw.util.convert_fort_double_to_float" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a fortran format double to a float</p>
<p>Converts a fortran format double to a python float.</p>
<p>number: is a string representation of the double.  Number should
be of the form &#8220;1.0d0&#8221;</p>
</dd></dl>

<dl class="function">
<dt id="pyclaw.util.gen_variants">
<tt class="descclassname">pyclaw.util.</tt><tt class="descname">gen_variants</tt><big>(</big><em>application</em>, <em>verifier</em>, <em>kernel_languages=('Fortran'</em>, <em>)</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyclaw.util.gen_variants" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator of runnable variants of a test application given a verifier</p>
<p>Given an application, a script for verifying its output, and a
list of kernel languages to try, generates all possible variants of the
application to try by taking a product of the available kernel_languages and
(petclaw/pyclaw).  For many applications, this will generate 4 variants:
the product of the two main kernel languages (&#8216;Fortran&#8217; and &#8216;Python&#8217;), against
the the two parallel modes (petclaw and pyclaw).</p>
<p>For more information on how the verifier function should be implemented,
see util.test_app for a description, and util.check_diff for an example.</p>
<p>All unrecognized keyword arguments are passed through to the application.</p>
</dd></dl>

<dl class="function">
<dt id="pyclaw.util.read_data_line">
<tt class="descclassname">pyclaw.util.</tt><tt class="descname">read_data_line</tt><big>(</big><em>inputfile</em>, <em>num_entries=1</em>, <em>data_type=&lt;type 'float'&gt;</em><big>)</big><a class="headerlink" href="#pyclaw.util.read_data_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Read data a single line from an input file</p>
<p>Reads one line from an input file and returns an array of values</p>
<p>inputfile: a file pointer to an open file object
num_entries: number of entries that should be read, defaults to only 1
type: Type of the values to be read in, they all must be the same type</p>
<p>This function will return either a single value or an array of values
depending on if num_entries &gt; 1</p>
</dd></dl>

<dl class="function">
<dt id="pyclaw.util.run_app_from_main">
<tt class="descclassname">pyclaw.util.</tt><tt class="descname">run_app_from_main</tt><big>(</big><em>application</em>, <em>setplot=None</em><big>)</big><a class="headerlink" href="#pyclaw.util.run_app_from_main" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs an application from pyclaw/examples/, automatically parsing command line keyword
arguments (key=value) as parameters to the application, with positional
arguments being passed to PETSc (if it is enabled).</p>
<p>Perhaps we should take the PETSc approach of having a database of PyClaw
options that can be queried for options on specific objects within the
PyClaw runtime instead of front-loading everything through the application
main...</p>
</dd></dl>

<dl class="function">
<dt id="pyclaw.util.run_serialized">
<tt class="descclassname">pyclaw.util.</tt><tt class="descname">run_serialized</tt><big>(</big><em>fun</em><big>)</big><a class="headerlink" href="#pyclaw.util.run_serialized" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorates a function to only run serially, even if called in parallel.</p>
<p>In a parallel communicator, the first process will run while the remaining processes
block on a barrier.  In a serial run, the function will be called directly.</p>
<p>This currently assumes the global communicator is PETSc.COMM_WORLD, but is easily
generalized.</p>
</dd></dl>

<dl class="function">
<dt id="pyclaw.util.test_app">
<tt class="descclassname">pyclaw.util.</tt><tt class="descname">test_app</tt><big>(</big><em>application</em>, <em>verifier</em>, <em>kwargs</em><big>)</big><a class="headerlink" href="#pyclaw.util.test_app" title="Permalink to this definition">¶</a></dt>
<dd><p>Test the output of a given application against its verifier method.</p>
<p>This function performs the following two function calls:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">output</span> <span class="o">=</span> <span class="n">application</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">check_values</span> <span class="o">=</span> <span class="n">verifier</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
<p>The verifier method should return None if the output is correct, otherwise
it should return an indexed sequence of three items:</p>
<div class="highlight-python"><div class="highlight"><pre>0 - expected value
1 - test value
2 - string describing the tolerance type (abs/rel) and value.
</pre></div>
</div>
<p>This information is used to present descriptive help if an error is detected.
For an example verifier method, see util.check_diff</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<p><a href="http://clawpack.org/">
    <img class="logo" src= "_static/clawlogo.jpg" alt="Logo"/>
</a>
<h2>Version 5.2.0</h2>
</p>
  <h3><a href="../contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Pyclaw Utility Module</a><ul>
<li><a class="reference internal" href="#module-pyclaw.util"><tt class="docutils literal"><span class="pre">pyclaw.util</span></tt></a></li>
</ul>
</li>
</ul>
<h3>Related Topics</h3>
<ul>
  <li><a href="../contents.html">Documentation overview</a><ul>
  <li><a href="index.html">Pyclaw</a><ul>
      <li>Previous: <a href="geometry.html" title="previous chapter">PyClaw Geometry</a></li>
      <li>Next: <a href="rp.html" title="next chapter">Riemann Solver Package</a></li>
  </ul></li>
  </ul></li>
</ul>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/pyclaw/util.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
    &copy; Copyright 2013, The Clawpack Development Team.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  
  </body>
</html>