<!-- **** DO NOT EDIT THIS FILE *** 
         This file was generated automatically from file
              setplot.py
         using $CLAW/clawutil/src/python/clawutil/clawcode2html.py         -->

<html>
<title> setplot.py.html </title>


          <head>
           <link rel="icon" href="http://www.clawpack.org//_static/clawicon_new.ico" />
          </head> 
           <BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#0000FF" 
                 VLINK="#5500DD" ALINK="#FF0000">
           <font FACE="HELVETICA,ARIAL">
           
<!-- Created from the file /Users/rjl/clawpack_src/clawpack_master/geoclaw/examples/tsunami/eta_init_force_dry/setplot.py -->
<!-- Date: Sun Apr  5 2020 at 10:36:22 -->

<table bgcolor="#FFEE99"> <tr> <td>
&nbsp;<font size=6> setplot.py.html </font> </td>

            <td><a href="http://www.clawpack.org/index.html"><img
            src="http://www.clawpack.org//_static/clawlogo_border.jpg"
            width=150 alt="CLAWPACK"></a>&nbsp;&nbsp; </td> </tr> <tr> <td>
&nbsp;Source file: &nbsp;&nbsp;<a href="setplot.py">setplot.py </a>
</td></tr><tr><td>
&nbsp;Directory:  &nbsp; /Users/rjl/clawpack_src/clawpack_master/geoclaw/examples/tsunami/eta_init_force_dry 
</td></tr><tr><td>
&nbsp;Converted:  &nbsp; Sun Apr  5 2020 at 10:36:22 
&nbsp; using <a href="http://www.clawpack.org//doc/application_documentation.html#clawcode2html">clawcode2html</a>
</td></tr><tr><td>
<font color="#BB3300"> &nbsp;This documentation file will 
not reflect any later changes in the source file. </font>
</td></tr></table></font>
<p>
<pre> 

"""
Set up the plot figures, axes, and items to be done for each frame.

This module is imported by the plotting routines and then the
function setplot is called to set the plot parameters.

"""

from __future__ import absolute_import
from __future__ import print_function
import numpy as np
import matplotlib.pyplot as plt

from clawpack.geoclaw import topotools
from six.moves import range
import os,sys


new_code = '../../new_python'
print('Adding %s to path' % new_code)
sys.path.insert(0, new_code)

cmax = 0.5
cmin = -cmax

cmax_land = 2.

<font color="blue">#--------------------------</font>
def setplot(plotdata=None):
<font color="blue">#--------------------------</font>

    """
    Specify what is to be plotted at each frame.
    Input:  plotdata, an instance of pyclaw.plotters.data.ClawPlotData.
    Output: a modified version of plotdata.

    """


    from clawpack.visclaw import colormaps, geoplot
    from numpy import linspace

    if plotdata is None:
        from clawpack.visclaw.data import ClawPlotData
        plotdata = ClawPlotData()


    plotdata.clearfigures()  <font color="blue"># clear any old figures,axes,items data</font>
    plotdata.format = 'binary'



    def timeformat(t):
        from numpy import mod
        hours = int(t/3600.)
        tmin = mod(t,3600.)
        min = int(tmin/60.)
        sec = int(mod(tmin,60.))
        timestr = '%s:%s:%s' % (hours,str(min).zfill(2),str(sec).zfill(2))
        return timestr

    def title_hours(current_data):
        from pylab import title
        t = current_data.t
        timestr = timeformat(t)
        title('%s after earthquake' % timestr)


    <font color="blue">#-----------------------------------------</font>
    <font color="blue"># Figure for surface</font>
    <font color="blue">#-----------------------------------------</font>
    plotfigure = plotdata.new_plotfigure(name='Computational domain', figno=0)
    plotfigure.kwargs = {'figsize':(8,7)}
    plotfigure.show = True

    <font color="blue"># Set up for axes in this figure:</font>
    plotaxes = plotfigure.new_plotaxes('pcolor')
    plotaxes.title = 'Surface'
    plotaxes.scaled = True


    def aa(current_data):
        from pylab import ticklabel_format, xticks, gca, cos, pi, savefig
        gca().set_aspect(1.)
        title_hours(current_data)
        ticklabel_format(useOffset=False)
        xticks(rotation=20)


    plotaxes.afteraxes = aa


    <font color="blue"># Water</font>
    plotitem = plotaxes.new_plotitem(plot_type='2d_pcolor')
    <font color="blue">#plotitem.plot_var = geoplot.surface</font>
    plotitem.plot_var = geoplot.surface_or_depth
    plotitem.pcolor_cmap = geoplot.tsunami_colormap
    plotitem.pcolor_cmin = cmin
    plotitem.pcolor_cmax = cmax
    plotitem.add_colorbar = True
    plotitem.colorbar_shrink = 0.7
    plotitem.amr_celledges_show = [0,0,0]
    plotitem.amr_patchedges_show = [0,0,0,0]
    plotitem.amr_data_show = [1,1,1,1,1,0,0]

    <font color="blue"># Land</font>
    plotitem = plotaxes.new_plotitem(plot_type='2d_pcolor')
    plotitem.plot_var = geoplot.land
    plotitem.pcolor_cmap = geoplot.land_colors
    plotitem.pcolor_cmin = 0.0
    plotitem.pcolor_cmax = cmax_land
    plotitem.add_colorbar = False
    plotitem.amr_celledges_show = [0]
    plotitem.amr_patchedges_show = [0,0,0,0]
    plotitem.amr_data_show = [1,1,1,1,1,0,0]

    <font color="blue"># add contour lines of bathy if desired:</font>
    plotitem = plotaxes.new_plotitem(plot_type='2d_contour')
    plotitem.show = False
    plotitem.plot_var = geoplot.topo
    plotitem.contour_levels = linspace(-3000,-3000,1)
    plotitem.amr_contour_colors = ['y']  <font color="blue"># color on each level</font>
    plotitem.kwargs = {'linestyles':'solid','linewidths':2}
    plotitem.amr_contour_show = [1,0,0]
    plotitem.celledges_show = 0
    plotitem.patchedges_show = 0

    <font color="blue">#-----------------------------------------</font>
    <font color="blue"># Figure for coastal area</font>
    <font color="blue">#-----------------------------------------</font>
    x1,x2,y1,y2 = [-0.005, 0.016, -0.01, 0.01]

    plotfigure = plotdata.new_plotfigure(name="coastal area", figno=11)
    plotfigure.show = True
    plotfigure.kwargs = {'figsize': (6,7)}

    <font color="blue"># Set up for axes in this figure:</font>
    plotaxes = plotfigure.new_plotaxes()
    plotaxes.scaled = False

    plotaxes.xlimits = [x1, x2]
    plotaxes.ylimits = [y1, y2]

    def aa_withbox(current_data):
        from pylab import plot
        x1,x2,y1,y2 = (-0.009259, 0.013796, -0.005093, 0.005000)
        if current_data.t > 5*60.:
            plot([x1,x1,x2,x2,x1], [y1,y2,y2,y1,y1], 'w--')
        aa(current_data)
        
    plotaxes.afteraxes = aa_withbox

    <font color="blue"># Water</font>
    plotitem = plotaxes.new_plotitem(plot_type='2d_pcolor')
    plotitem.plot_var = geoplot.surface
    <font color="blue">#plotitem.plot_var = geoplot.surface_or_depth</font>
    plotitem.pcolor_cmap = geoplot.tsunami_colormap
    plotitem.pcolor_cmin = cmin
    plotitem.pcolor_cmax = cmax
    plotitem.add_colorbar = True
    plotitem.colorbar_shrink = 0.4
    plotitem.amr_celledges_show = [0,0,0]
    plotitem.patchedges_show = 0

    <font color="blue"># Land</font>
    plotitem = plotaxes.new_plotitem(plot_type='2d_pcolor')
    plotitem.plot_var = geoplot.land
    plotitem.pcolor_cmap = geoplot.land_colors
    plotitem.pcolor_cmin = 0.0
    plotitem.pcolor_cmax = cmax_land
    plotitem.add_colorbar = False
    plotitem.amr_celledges_show = [0]
    plotitem.patchedges_show = 0

    <font color="blue"># add contour lines of bathy if desired:</font>
    plotitem = plotaxes.new_plotitem(plot_type='2d_contour')
    <font color="blue">#plotitem.show = False</font>
    plotitem.plot_var = geoplot.topo
    plotitem.contour_levels = [-2,-1,0,1,2]
    plotitem.amr_contour_colors = ['yellow']  <font color="blue"># color on each level</font>
    plotitem.kwargs = {'linestyles':'solid','linewidths':1}
    plotitem.amr_contour_show = [0,0,1,0]
    plotitem.celledges_show = 0
    plotitem.patchedges_show = 0



    <font color="blue"># Plots of timing (CPU and wall time):</font>

    def make_timing_plots(plotdata):
        import os
        from clawpack.visclaw import plot_timing_stats
        try:
            timing_plotdir = plotdata.plotdir + '/_timing_figures'
            os.system('mkdir -p %s' % timing_plotdir)
            units = {'comptime':'minutes', 'simtime':'minutes', 'cell':'millions'}
            plot_timing_stats.make_plots(outdir=plotdata.outdir, make_pngs=True,
                                          plotdir=timing_plotdir, units=units)
            os.system('cp %s/timing.* %s' % (plotdata.outdir, timing_plotdir))
        except:
            print('*** Error making timing plots')

    otherfigure = plotdata.new_otherfigure(name='timing',
                    fname='_timing_figures/timing.html')
    otherfigure.makefig = make_timing_plots


    <font color="blue">#-----------------------------------------</font>

    <font color="blue"># Parameters used only when creating html and/or latex hardcopy</font>
    <font color="blue"># e.g., via pyclaw.plotters.frametools.printframes:</font>

    plotdata.printfigs = True                <font color="blue"># print figures</font>
    plotdata.print_format = 'png'            <font color="blue"># file format</font>
    plotdata.print_framenos = 'all'        <font color="blue"># list of frames to print</font>
    plotdata.print_gaugenos = 'all'          <font color="blue"># list of gauges to print</font>
    plotdata.print_fignos = 'all'            <font color="blue"># list of figures to print</font>
    plotdata.html = True                     <font color="blue"># create html files of plots?</font>
    plotdata.html_homelink = '../README.html'   <font color="blue"># pointer for top of index</font>
    plotdata.latex = True                    <font color="blue"># create latex file of plots?</font>
    plotdata.latex_figsperline = 2           <font color="blue"># layout of plots</font>
    plotdata.latex_framesperline = 1         <font color="blue"># layout of plots</font>
    plotdata.latex_makepdf = False           <font color="blue"># also run pdflatex?</font>
    plotdata.parallel = True                 <font color="blue"># make multiple frame png's at once</font>

    return plotdata
</pre></html>
