<!-- **** DO NOT EDIT THIS FILE *** 
         This file was generated automatically from file
              bc1.f
         using $CLAW/clawutil/src/python/clawutil/clawcode2html.py         -->

<html>
<title> bc1.f.html </title>


          <head>
           <link rel="icon" href="http://www.clawpack.org//_static/clawicon_new.ico" />
          </head> 
           <BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#0000FF" 
                 VLINK="#5500DD" ALINK="#FF0000">
           <font FACE="HELVETICA,ARIAL">
           
<!-- Created from the file /Users/rjl/clawpack_src/clawpack_master/geoclaw/examples/1d_classic/bouss_wavetank_matsuyama/bc1.f -->
<!-- Date: Mon Feb 19 2024 at 14:30:59 -->

<table bgcolor="#FFEE99"> <tr> <td>
&nbsp;<font size=6> bc1.f.html </font> </td>

            <td><a href="http://www.clawpack.org/index.html"><img
            src="http://www.clawpack.org//_static/clawlogo_border.jpg"
            width=150 alt="CLAWPACK"></a>&nbsp;&nbsp; </td> </tr> <tr> <td>
&nbsp;Source file: &nbsp;&nbsp;<a href="bc1.f">bc1.f </a>
</td></tr><tr><td>
&nbsp;Directory:  &nbsp; /Users/rjl/clawpack_src/clawpack_master/geoclaw/examples/1d_classic/bouss_wavetank_matsuyama 
</td></tr><tr><td>
&nbsp;Converted:  &nbsp; Mon Feb 19 2024 at 14:30:59 
&nbsp; using <a href="http://www.clawpack.org//doc/application_documentation.html#clawcode2html">clawcode2html</a>
</td></tr><tr><td>
<font color="#BB3300"> &nbsp;This documentation file will 
not reflect any later changes in the source file. </font>
</td></tr></table></font>
<p>
<pre> 

<font color="blue">c</font>
<font color="blue">c</font>
<font color="blue">c     =================================================================</font>
      subroutine bc1(meqn,mbc,mx,xlower,dx,q,maux,aux,t,dt,mthbc)
<font color="blue">c     =================================================================</font>
<font color="blue">c</font>
<font color="blue">c     # Standard boundary condition choices for claw2</font>
<font color="blue">c</font>
<font color="blue">c     # Modified for 1d GeoClaw to extend topo aux(1,:) to ghost cells.</font>
<font color="blue">c</font>
<font color="blue">c     # At each boundary  k = 1 (left),  2 (right):</font>
<font color="blue">c     #   mthbc(k) =  0  for user-supplied BC's (must be inserted!)</font>
<font color="blue">c     #            =  1  for zero-order extrapolation</font>
<font color="blue">c     #            =  2  for periodic boundary coniditions</font>
<font color="blue">c     #            =  3  for solid walls, assuming this can be implemented</font>
<font color="blue">c     #                  by reflecting the data about the boundary and then</font>
<font color="blue">c     #                  negating the 2'nd component of q.</font>
<font color="blue">c     ------------------------------------------------</font>
<font color="blue">c</font>
<font color="blue">c     # Extend the data from the computational region</font>
<font color="blue">c     #      i = 1, 2, ..., mx2</font>
<font color="blue">c     # to the virtual cells outside the region, with</font>
<font color="blue">c     #      i = 1-ibc  and   i = mx+ibc   for ibc=1,...,mbc</font>
<font color="blue">c</font>
      use geoclaw_module, only: grav
      implicit double precision (a-h,o-z)
      dimension q(meqn,1-mbc:mx+mbc)
      dimension aux(maux,1-mbc:mx+mbc)

      dimension mthbc(2)

      pi = 4.d0*atan(1.d0)
      h0 = 4.d0
      
      ampl_eta = 0.03
      ampl_u = ampl_eta * sqrt(grav/h0)
      <font color="blue">!write(6,*) '+++ ampl_eta, ampl_u: ',ampl_eta, ampl_u</font>
      <font color="blue">!ampl = 0.047  #0.15d0</font>
      tperiod = 20.d0

<font color="blue">c</font>
<font color="blue">c</font>
<font color="blue">c-------------------------------------------------------</font>
<font color="blue">c     # left boundary:</font>
<font color="blue">c-------------------------------------------------------</font>
      do ibc=1,mbc
         aux(1,1-ibc)=aux(1,1)
      enddo

      go to (100,110,120,130) mthbc(1)+1
<font color="blue">c</font>
  100 continue
<font color="blue">c     # wave maker</font>
      if (t < tperiod) then
          s = ampl_u * sin(2.d0*pi*t/tperiod)
      else
          s = 0.d0
      endif
      do ibc=1,mbc
          aux(1,1-ibc) = aux(1,ibc)
          do m=1,meqn
              q(m,1-ibc) = q(m,ibc)
          enddo
          u = q(2,ibc)/q(1,ibc)
          q(2,1-ibc) = (2.d0*s - u) * q(1,1-ibc)
      enddo
      
      go to 199
<font color="blue">c</font>
  110 continue
<font color="blue">c     # zero-order extrapolation:</font>
      do ibc=1,mbc
         do m=1,meqn
            q(m,1-ibc) = q(m,1)
         end do
      end do
      go to 199

  120 continue
<font color="blue">c     # periodic:</font>
      do ibc=1,mbc
         do m=1,meqn
            q(m,1-ibc) = q(m,mx+1-ibc)
         end do
      end do
      go to 199

  130 continue
<font color="blue">c     # solid wall (assumes 2'nd component is velocity or momentum in x):</font>
      do ibc=1,mbc
         do m=1,meqn
            q(m,1-ibc) = q(m,ibc)
         end do
<font color="blue">c        # negate the normal velocity:</font>
         q(2,1-ibc) = -q(2,ibc)
      end do
      go to 199

  199 continue

<font color="blue">c</font>
<font color="blue">c-------------------------------------------------------</font>
<font color="blue">c     # right boundary:</font>
<font color="blue">c-------------------------------------------------------</font>
      do ibc=1,mbc
         aux(1,mx+ibc)=aux(1,mx)
      enddo

      go to (200,210,220,230) mthbc(2)+1
<font color="blue">c</font>
  200 continue
<font color="blue">c     # user-specified boundary conditions go here in place of error output</font>
      write(6,*) '*** ERROR *** mthbc(2)=0 and no BCs specified in bc2'
      stop
      go to 299

  210 continue
<font color="blue">c     # zero-order extrapolation:</font>
      do ibc=1,mbc
         do m=1,meqn
            q(m,mx+ibc) = q(m,mx)
         end do
      end do
      go to 299

  220 continue
<font color="blue">c     # periodic:</font>
      do ibc=1,mbc
         do m=1,meqn
            q(m,mx+ibc) = q(m,ibc)
         end do
      end do
      go to 299

  230 continue
<font color="blue">c     # solid wall (assumes 2'nd component is velocity or momentum in x):</font>
      do ibc=1,mbc
         do m=1,meqn
            q(m,mx+ibc) = q(m,mx+1-ibc)
         end do
<font color="blue">c        # negate the normal velocity:</font>
         q(2,mx+ibc) = -q(2,mx+1-ibc)
      end do
      go to 299

  299 continue
<font color="blue">c</font>
      return
      end
</pre></html>
