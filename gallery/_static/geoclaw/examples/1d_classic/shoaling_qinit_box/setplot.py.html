<!-- **** DO NOT EDIT THIS FILE *** 
         This file was generated automatically from file
              setplot.py
         using $CLAW/clawutil/src/python/clawutil/clawcode2html.py         -->

<html>
<title> setplot.py.html </title>


          <head>
           <link rel="icon" href="http://www.clawpack.org//_static/clawicon_new.ico" />
          </head> 
           <BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#0000FF" 
                 VLINK="#5500DD" ALINK="#FF0000">
           <font FACE="HELVETICA,ARIAL">
           
<!-- Created from the file /Users/rjl/clawpack_src/clawpack_master/geoclaw/examples/1d_classic/shoaling_qinit_box/setplot.py -->
<!-- Date: Mon Feb 19 2024 at 16:13:44 -->

<table bgcolor="#FFEE99"> <tr> <td>
&nbsp;<font size=6> setplot.py.html </font> </td>

            <td><a href="http://www.clawpack.org/index.html"><img
            src="http://www.clawpack.org//_static/clawlogo_border.jpg"
            width=150 alt="CLAWPACK"></a>&nbsp;&nbsp; </td> </tr> <tr> <td>
&nbsp;Source file: &nbsp;&nbsp;<a href="setplot.py">setplot.py </a>
</td></tr><tr><td>
&nbsp;Directory:  &nbsp; /Users/rjl/clawpack_src/clawpack_master/geoclaw/examples/1d_classic/shoaling_qinit_box 
</td></tr><tr><td>
&nbsp;Converted:  &nbsp; Mon Feb 19 2024 at 16:13:44 
&nbsp; using <a href="http://www.clawpack.org//doc/application_documentation.html#clawcode2html">clawcode2html</a>
</td></tr><tr><td>
<font color="#BB3300"> &nbsp;This documentation file will 
not reflect any later changes in the source file. </font>
</td></tr></table></font>
<p>
<pre> 


import os, sys
from clawpack.visclaw import geoplot
from clawpack.geoclaw.nonuniform_grid_tools import make_mapc2p
import numpy


fname_celledges = os.path.abspath('celledges.data')


xlimits = [-300,150]

def setplot(plotdata=None):

    if plotdata is None:
        from clawpack.visclaw.data import ClawPlotData
        plotdata = ClawPlotData()

    plotdata.clearfigures()

    mapc2p, mx_edge, xp_edge = make_mapc2p(fname_celledges)

    def mapc2p_km(xc):
        x_m = mapc2p(xc)
        x_km = x_m / 1000.   <font color="blue"># convert to km</font>
        return x_km


    def add_annotations(current_data):
        from pylab import ticklabel_format, plot,grid,ones,sqrt, \
            legend,title,ylabel,text
        ticklabel_format(useOffset=False)

        hl = 3200.
        hr = 200.
        greens = (hl/hr)**(0.25)
        print('greens = ',greens)
        <font color="blue">#plot(current_data.x, greens*ones(current_data.x.shape),'g--')</font>
        plot(xlimits,[greens,greens],'g--', label='$C_g$, Greens Law')
        ctrans = 2*sqrt(hl)/(sqrt(hl)+sqrt(hr))
        crefl = (sqrt(hl)-sqrt(hr))/(sqrt(hl)+sqrt(hr))
        print('ctrans = ',ctrans)
        plot(xlimits,[ctrans,ctrans],'r--', label='$C_T$, Transmission coefficient')
        print('crefl = ',crefl)
        plot(xlimits,[crefl,crefl],'m--', label='$C_R$, Reflection coefficient')
        legend(loc='upper left')
        title('')
        ylabel('meters', fontsize=14)
        if current_data.frameno == 0:
            text(-95,-0.4,'$\longrightarrow$',fontsize=20)
            text(-95,-0.6,'Incident')
        h = current_data.q[0,:]
        mx2 = int(round(len(h)/2.))
        etamax2 = (h[:mx2] - hl).max()
        print('mx2 = %i, etamax2 = %g' % (mx2,etamax2))
        if (current_data.frameno == 5) and (etamax2 > 0.1):
            text(-190,-0.5,'$\longleftarrow$',fontsize=20)
            text(-190,-0.7,'Reflected')
            text(30,-0.5,'$\longrightarrow$',fontsize=20)
            text(15,-0.7,'Transmitted')
        if (current_data.frameno == 6) and (etamax2 > 0.1):
            text(-260,-0.5,'$\longleftarrow$',fontsize=20)
            text(-260,-0.7,'Reflected')
            text(40,-0.5,'$\longrightarrow$',fontsize=20)
            text(25,-0.7,'Transmitted')
        elif (current_data.frameno == 6):
            text(-20,-0.5,'$\longleftarrow$',fontsize=20)
            text(-20,-0.7,'Reflected')
            text(70,-0.5,'$\longrightarrow$',fontsize=20)
            text(65,-0.7,'Transmitted')
        

    plotfigure = plotdata.new_plotfigure(name='domain', figno=0)
    plotfigure.kwargs = {'figsize':(7,6.5)}
    plotaxes = plotfigure.new_plotaxes()
    plotaxes.axescmd = 'axes([.1,.4,.8,.5])' <font color="blue">#'subplot(211)'</font>
    plotaxes.xlimits = xlimits
    <font color="blue">#plotaxes.xlimits = [-100e3,-20e3]</font>
    plotaxes.ylimits = [-1,3]
    plotaxes.title = 'Surface displacement'
    plotaxes.afteraxes = add_annotations

    plotitem = plotaxes.new_plotitem(plot_type='1d_plot')
    plotitem.plot_var = geoplot.surface
    plotitem.color = 'b'
    plotitem.MappedGrid = True
    plotitem.mapc2p = mapc2p_km


    plotitem = plotaxes.new_plotitem(plot_type='1d_plot')
    plotitem.show = False
    plotitem.plot_var = 1
    plotitem.color = 'k'
    plotitem.MappedGrid = True
    plotitem.mapc2p = mapc2p_km

    plotaxes = plotfigure.new_plotaxes()
    plotaxes.axescmd = 'axes([.1,.1,.8,.2])' <font color="blue">#'subplot(212)'</font>
    plotaxes.xlimits = xlimits

    plotitem = plotaxes.new_plotitem(plot_type='1d_plot')
    plotitem.plot_var = geoplot.topo
    plotitem.color = 'g'
    plotitem.MappedGrid = True
    plotitem.mapc2p = mapc2p_km

    def fix_topo_plot(current_data):
        from pylab import title,xlabel
        title('')
        xlabel('kilometers', fontsize=14)
    plotaxes.afteraxes = fix_topo_plot

    plotitem.MappedGrid = True
    plotitem.mapc2p = mapc2p_km



    <font color="blue">#-----------------------------------------</font>
    <font color="blue"># Figures for gauges</font>
    <font color="blue">#-----------------------------------------</font>
    plotfigure = plotdata.new_plotfigure(name='q', figno=300, \
                                         type='each_gauge')
    plotfigure.clf_each_gauge = True

    plotaxes = plotfigure.new_plotaxes()
    plotaxes.xlimits = 'auto'
    plotaxes.ylimits = 'auto'
    plotaxes.title = 'Eta'
    plotitem = plotaxes.new_plotitem(plot_type='1d_plot')
    plotitem.plot_var = 2
    plotitem.plotstyle = 'b-'


    <font color="blue">#-----------------------------------------</font>

    <font color="blue"># Parameters used only when creating html and/or latex hardcopy</font>
    <font color="blue"># e.g., via pyclaw.plotters.frametools.printframes:</font>
    
    plotdata.printfigs = True                <font color="blue"># print figures</font>
    plotdata.print_format = 'png'            <font color="blue"># file format</font>
    plotdata.print_framenos = 'all'          <font color="blue"># list of frames to print</font>
    plotdata.print_gaugenos = 'all'          <font color="blue"># list of gauges to print</font>
    plotdata.print_fignos = 'all'            <font color="blue"># list of figures to print</font>
    plotdata.html = True                     <font color="blue"># create html files of plots?</font>
    plotdata.html_homelink = '../README.html'   <font color="blue"># pointer for top of index</font>
    plotdata.latex = True                    <font color="blue"># create latex file of plots?</font>
    plotdata.latex_figsperline = 2           <font color="blue"># layout of plots</font>
    plotdata.latex_framesperline = 1         <font color="blue"># layout of plots</font>
    plotdata.latex_makepdf = False           <font color="blue"># also run pdflatex?</font>
    plotdata.parallel = True                 <font color="blue"># make multiple frame png's at once</font>

    return plotdata
</pre></html>
