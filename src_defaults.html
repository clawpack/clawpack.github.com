<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>src default routines &#8212; Clawpack 5.4.0 documentation</title>
    
    <link rel="stylesheet" href="_static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/base.css" type="text/css" />
    <link rel="stylesheet" href="_static/layout.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '5.4.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: ''
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/clawicon.ico"/>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head>
  <body role="document">
<div id="main-wrapper" class="sphinx">
<div id="header-wrapper">
  <section id="header">
    <!-- <h1><a href="http://clawpack.org/">Clawpack</a></h1> -->
    <h1><a href="http://clawpack.org/">Clawpack-5</a></h1> 
    <nav>
      <ul>
        <li>
          <a href="contents.html">Docs</a>
        </li>
        <li>
          <a href="installing.html">Install</a>
        </li>
        <li>
          <a class="" href="gallery/index.html">Gallery</a>
        </li>
        <li>
          <a class="" href="community.html">Community</a>
        </li>
        <li>
          <a class="active" href="http://github.com/clawpack">Source</a>
        </li>
        <li>
          <a class="" href="developers.html">Develop</a>
        </li>
      </ul>
    </nav>
  </section>
<div class="decoration"></div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="contents.html">Clawpack 5.4.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="src-default-routines">
<span id="src-defaults"></span><h1>src default routines<a class="headerlink" href="#src-default-routines" title="Permalink to this headline">Â¶</a></h1>
<p>See also <a class="reference internal" href="user_routines.html#user-src"><span class="std std-ref">Using src for source terms</span></a>.</p>
<p>For GeoClaw, see <a class="reference internal" href="#src-geoclaw"><span class="std std-ref">src routine in GeoClaw</span></a>.</p>
<p>Below are the default <cite>src</cite> library routines for Classic and AMRClaw.
By default these do nothing.  If you wish to specify source terms, you
need to copy one of these files to your application directory and modify it
as needed.  Remember to change to <cite>Makefile</cite> to point to the proper version.</p>
<p>If you are using AMRClaw, you will also need to provide a routine <cite>src1d</cite>,
see <a class="reference internal" href="user_routines.html#user-src1d"><span class="std std-ref">Using src1d for source terms with AMRClaw</span></a>.</p>
<p><cite>$CLAW/classic/src/1d/src1.f90</cite>:</p>
<div class="highlight-fortran"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">src1</span><span class="p">(</span><span class="n">meqn</span><span class="p">,</span><span class="n">mbc</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">xlower</span><span class="p">,</span><span class="n">dx</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">maux</span><span class="p">,</span><span class="n">aux</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>

    <span class="c">! Called to update q by solving source term equation </span>
    <span class="c">! $q_t = \psi(q)$ over time dt starting at time t.</span>
    <span class="c">!</span>
    <span class="c">! This default version does nothing. </span>
 
    <span class="k">implicit none</span>
<span class="k">    </span><span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mbc</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">meqn</span><span class="p">,</span><span class="n">maux</span>
    <span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xlower</span><span class="p">,</span><span class="n">dx</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dt</span>
    <span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">aux</span><span class="p">(</span><span class="n">maux</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">mbc</span><span class="p">:</span><span class="n">mx</span><span class="o">+</span><span class="n">mbc</span><span class="p">)</span>
    <span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">q</span><span class="p">(</span><span class="n">meqn</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">mbc</span><span class="p">:</span><span class="n">mx</span><span class="o">+</span><span class="n">mbc</span><span class="p">)</span>

<span class="k">end subroutine </span><span class="n">src1</span>
</pre></div>
</td></tr></table></div>
<p><cite>$CLAW/classic/src/2d/src2.f90</cite>:</p>
<div class="highlight-fortran"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">src2</span><span class="p">(</span><span class="n">meqn</span><span class="p">,</span><span class="n">mbc</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">my</span><span class="p">,</span><span class="n">xlower</span><span class="p">,</span><span class="n">ylower</span><span class="p">,</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">maux</span><span class="p">,</span><span class="n">aux</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>

    <span class="c">! Called to update q by solving source term equation </span>
    <span class="c">! $q_t = \psi(q)$ over time dt starting at time t.</span>
    <span class="c">!</span>
    <span class="c">! This default version does nothing. </span>
 
    <span class="k">implicit none</span>
<span class="k">    </span><span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mbc</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">my</span><span class="p">,</span><span class="n">meqn</span><span class="p">,</span><span class="n">maux</span>
    <span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xlower</span><span class="p">,</span><span class="n">ylower</span><span class="p">,</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dt</span>
    <span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">aux</span><span class="p">(</span><span class="n">maux</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">mbc</span><span class="p">:</span><span class="n">mx</span><span class="o">+</span><span class="n">mbc</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">mbc</span><span class="p">:</span><span class="n">my</span><span class="o">+</span><span class="n">mbc</span><span class="p">)</span>
    <span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">q</span><span class="p">(</span><span class="n">meqn</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">mbc</span><span class="p">:</span><span class="n">mx</span><span class="o">+</span><span class="n">mbc</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">mbc</span><span class="p">:</span><span class="n">my</span><span class="o">+</span><span class="n">mbc</span><span class="p">)</span>

<span class="k">end subroutine </span><span class="n">src2</span>
</pre></div>
</td></tr></table></div>
<p><cite>$CLAW/classic/src/3d/src3.f90</cite>:</p>
<div class="highlight-fortran"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">src3</span><span class="p">(</span><span class="n">meqn</span><span class="p">,</span><span class="n">mbc</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">my</span><span class="p">,</span><span class="n">mz</span><span class="p">,</span><span class="n">xlower</span><span class="p">,</span><span class="n">ylower</span><span class="p">,</span><span class="n">zlower</span><span class="p">,</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">,</span><span class="n">dz</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">maux</span><span class="p">,</span><span class="n">aux</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>

    <span class="c">! Called to update q by solving source term equation </span>
    <span class="c">! $q_t = \psi(q)$ over time dt starting at time t.</span>
    <span class="c">!</span>
    <span class="c">! This default version does nothing. </span>
 
    <span class="k">implicit none</span>
<span class="k">    </span><span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">meqn</span><span class="p">,</span><span class="n">mbc</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">my</span><span class="p">,</span><span class="n">mz</span><span class="p">,</span><span class="n">maux</span>
    <span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xlower</span><span class="p">,</span><span class="n">ylower</span><span class="p">,</span><span class="n">zlower</span><span class="p">,</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">,</span><span class="n">dz</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dt</span>
    <span class="kt">double precision</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">aux</span><span class="p">(</span><span class="n">maux</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">mbc</span><span class="p">:</span><span class="n">mx</span><span class="o">+</span><span class="n">mbc</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">mbc</span><span class="p">:</span><span class="n">my</span><span class="o">+</span><span class="n">mbc</span><span class="p">)</span>
    <span class="kt">double precision</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">q</span><span class="p">(</span><span class="n">meqn</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">mbc</span><span class="p">:</span><span class="n">mx</span><span class="o">+</span><span class="n">mbc</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">mbc</span><span class="p">:</span><span class="n">my</span><span class="o">+</span><span class="n">mbc</span><span class="p">)</span>

<span class="k">end subroutine </span><span class="n">src3</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="src-routine-in-geoclaw">
<span id="src-geoclaw"></span><h2>src routine in GeoClaw<a class="headerlink" href="#src-routine-in-geoclaw" title="Permalink to this headline">Â¶</a></h2>
<p>In GeoClaw, there is a library routine to impose source terms for bottom
friction (via a Manning term) and Coriolis terms.  The topography source term
is built into the Riemann solver in a manner that achieves well balancing
(an ocean at rest remains at rest).</p>
<p><cite>$CLAW/geoclaw/src/2d/shallow/src2.f90</cite>:</p>
<div class="highlight-fortran"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">src2</span><span class="p">(</span><span class="n">meqn</span><span class="p">,</span><span class="n">mbc</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">my</span><span class="p">,</span><span class="n">xlower</span><span class="p">,</span><span class="n">ylower</span><span class="p">,</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">maux</span><span class="p">,</span><span class="n">aux</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
      
    <span class="k">use </span><span class="n">geoclaw_module</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">g</span> <span class="o">=&gt;</span> <span class="n">grav</span><span class="p">,</span> <span class="n">coriolis_forcing</span><span class="p">,</span> <span class="n">coriolis</span>
    <span class="k">use </span><span class="n">geoclaw_module</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">friction_forcing</span><span class="p">,</span> <span class="n">friction_depth</span>
    <span class="k">use </span><span class="n">geoclaw_module</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">manning_coefficient</span>
    <span class="k">use </span><span class="n">geoclaw_module</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">manning_break</span><span class="p">,</span> <span class="n">num_manning</span>
    <span class="k">use </span><span class="n">geoclaw_module</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">spherical_distance</span><span class="p">,</span> <span class="n">coordinate_system</span>
    <span class="k">use </span><span class="n">geoclaw_module</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">RAD2DEG</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">dry_tolerance</span>
      
    <span class="k">use </span><span class="n">storm_module</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">wind_forcing</span><span class="p">,</span> <span class="n">pressure_forcing</span>
    <span class="k">use </span><span class="n">storm_module</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">rho_air</span><span class="p">,</span> <span class="n">wind_drag</span><span class="p">,</span> <span class="n">ambient_pressure</span>
    <span class="k">use </span><span class="n">storm_module</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">wind_index</span><span class="p">,</span> <span class="n">pressure_index</span>
    <span class="k">use </span><span class="n">storm_module</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">storm_direction</span><span class="p">,</span> <span class="n">storm_location</span>

    <span class="k">use </span><span class="n">friction_module</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">variable_friction</span><span class="p">,</span> <span class="n">friction_index</span>

    <span class="k">implicit none</span>
    
    <span class="c">! Input parameters</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">meqn</span><span class="p">,</span><span class="n">mbc</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">my</span><span class="p">,</span><span class="n">maux</span>
    <span class="kt">double precision</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xlower</span><span class="p">,</span><span class="n">ylower</span><span class="p">,</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dt</span>
    
    <span class="c">! Output</span>
    <span class="kt">double precision</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">q</span><span class="p">(</span><span class="n">meqn</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">mbc</span><span class="p">:</span><span class="n">mx</span><span class="o">+</span><span class="n">mbc</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">mbc</span><span class="p">:</span><span class="n">my</span><span class="o">+</span><span class="n">mbc</span><span class="p">)</span>
    <span class="kt">double precision</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">aux</span><span class="p">(</span><span class="n">maux</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">mbc</span><span class="p">:</span><span class="n">mx</span><span class="o">+</span><span class="n">mbc</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">mbc</span><span class="p">:</span><span class="n">my</span><span class="o">+</span><span class="n">mbc</span><span class="p">)</span>

    <span class="c">! Locals</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">nman</span>
    <span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">h</span><span class="p">,</span> <span class="n">hu</span><span class="p">,</span> <span class="n">hv</span><span class="p">,</span> <span class="nb">gamma</span><span class="p">,</span> <span class="n">dgamma</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fdt</span><span class="p">,</span> <span class="n">a</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">coeff</span>
    <span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xm</span><span class="p">,</span> <span class="n">xc</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">ym</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">yp</span><span class="p">,</span> <span class="n">dx_meters</span><span class="p">,</span> <span class="n">dy_meters</span>
    <span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">hu0</span><span class="p">,</span> <span class="n">hv0</span>
    <span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tau</span><span class="p">,</span> <span class="n">wind_speed</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">P_gradient</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ddt</span><span class="p">,</span> <span class="n">sloc</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="c">! Algorithm parameters</span>
    <span class="c">! Parameter controls when to zero out the momentum at a depth in the</span>
    <span class="c">! friction source term</span>
    <span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">depth_tolerance</span> <span class="o">=</span> <span class="mf">1.0d-30</span>

    <span class="c">! Physics</span>
    <span class="c">! Nominal density of water</span>
    <span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">rho</span> <span class="o">=</span> <span class="mi">102</span><span class="mf">5.d0</span>

    <span class="c">! Friction source term</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">friction_forcing</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">my</span>
            <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">mx</span>
                <span class="c">! Extract appropriate momentum</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">q</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">depth_tolerance</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                    </span><span class="n">q</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.d0</span>
                <span class="k">else</span>
                    <span class="c">! Apply friction source term only if in shallower water</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">q</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">friction_depth</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                        if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">variable_friction</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                            do </span><span class="n">nman</span> <span class="o">=</span> <span class="n">num_manning</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
                                <span class="k">if</span> <span class="p">(</span><span class="n">aux</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">manning_break</span><span class="p">(</span><span class="n">nman</span><span class="p">))</span> <span class="k">then</span>
<span class="k">                                    </span><span class="n">coeff</span> <span class="o">=</span> <span class="n">manning_coefficient</span><span class="p">(</span><span class="n">nman</span><span class="p">)</span>
                                <span class="n">endif</span>
                            <span class="n">enddo</span>
                        <span class="k">else</span>
<span class="k">                            </span><span class="n">coeff</span> <span class="o">=</span> <span class="n">aux</span><span class="p">(</span><span class="n">friction_index</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
                        <span class="n">endif</span>
                        
                        <span class="c">! Calculate source term</span>
                        <span class="nb">gamma</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">q</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">q</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">g</span>     <span class="p">&amp;</span>   
                              <span class="o">*</span> <span class="n">coeff</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">q</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">7.d0</span><span class="o">/</span><span class="mf">3.d0</span><span class="p">))</span>
                        <span class="n">dgamma</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="nb">gamma</span>
<span class="nb">                        </span><span class="n">q</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">q</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">/</span> <span class="n">dgamma</span>
                        <span class="n">q</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">q</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">/</span> <span class="n">dgamma</span>
                    <span class="n">endif</span>
                <span class="n">endif</span>
            <span class="n">enddo</span>
        <span class="n">enddo</span>
    <span class="n">endif</span>
    <span class="c">! End of friction source term</span>

    <span class="c">! Coriolis source term</span>
    <span class="c">! TODO: May want to remove the internal calls to coriolis as this could </span>
    <span class="c">!       lead to slow downs.</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">coriolis_forcing</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">my</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">ylower</span> <span class="o">+</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">dy</span>
            <span class="n">fdt</span> <span class="o">=</span> <span class="n">coriolis</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span> <span class="c">! Calculate f dependent on coordinate system</span>

            <span class="c">! Calculate matrix components</span>
            <span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="o">-</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="n">fdt</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">fdt</span><span class="o">**</span><span class="mi">4</span> <span class="o">/</span> <span class="mi">2</span><span class="mf">4.d0</span>
            <span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span>  <span class="n">fdt</span> <span class="o">-</span> <span class="n">fdt</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="mf">6.d0</span>
            <span class="n">a</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">fdt</span> <span class="o">+</span> <span class="n">fdt</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="mf">6.d0</span>
            <span class="n">a</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

            <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">mx</span>
                <span class="n">q</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">q</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">*</span> <span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">q</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">*</span> <span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">q</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">q</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">*</span> <span class="n">a</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">q</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">*</span> <span class="n">a</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">enddo</span>
        <span class="n">enddo</span>
    <span class="n">endif</span>
    <span class="c">! End of coriolis source term</span>

    <span class="c">! wind -----------------------------------------------------------</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">wind_forcing</span><span class="p">)</span> <span class="k">then</span>
        <span class="c">! Need storm location and direction for sector based wind drag</span>
        <span class="n">sloc</span> <span class="o">=</span> <span class="n">storm_location</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">storm_direction</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">my</span>
            <span class="n">yc</span> <span class="o">=</span> <span class="n">ylower</span> <span class="o">+</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">dy</span>
            <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">mx</span>
                <span class="n">xc</span> <span class="o">=</span> <span class="n">xlower</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">dx</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">q</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">dry_tolerance</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                    </span><span class="n">psi</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">yc</span> <span class="o">-</span> <span class="n">sloc</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">xc</span> <span class="o">-</span> <span class="n">sloc</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">theta</span> <span class="o">&gt;</span> <span class="n">psi</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                        </span><span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.d0</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">-</span> <span class="n">theta</span> <span class="o">+</span> <span class="n">psi</span><span class="p">)</span> <span class="o">*</span> <span class="n">RAD2DEG</span>
                    <span class="k">else</span>
<span class="k">                        </span><span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">psi</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">RAD2DEG</span> 
                    <span class="n">endif</span>
                    <span class="n">wind_speed</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">aux</span><span class="p">(</span><span class="n">wind_index</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>        <span class="p">&amp;</span>
                                    <span class="o">+</span> <span class="n">aux</span><span class="p">(</span><span class="n">wind_index</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">tau</span> <span class="o">=</span> <span class="n">wind_drag</span><span class="p">(</span><span class="n">wind_speed</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">rho_air</span> <span class="o">*</span> <span class="n">wind_speed</span> <span class="o">/</span> <span class="n">rho</span>
                    <span class="n">q</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">q</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">tau</span> <span class="o">*</span> <span class="n">aux</span><span class="p">(</span><span class="n">wind_index</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
                    <span class="n">q</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">q</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">tau</span> <span class="o">*</span> <span class="n">aux</span><span class="p">(</span><span class="n">wind_index</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
                <span class="n">endif</span>
            <span class="n">enddo</span>
        <span class="n">enddo</span>
    <span class="n">endif</span>
    <span class="c">! ----------------------------------------------------------------</span>

    <span class="c">! Atmosphere Pressure --------------------------------------------</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pressure_forcing</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">my</span>  
            <span class="n">ym</span> <span class="o">=</span> <span class="n">ylower</span> <span class="o">+</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mf">1.d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">dy</span>
            <span class="n">yc</span> <span class="o">=</span> <span class="n">ylower</span> <span class="o">+</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">dy</span>
            <span class="n">yp</span> <span class="o">=</span> <span class="n">ylower</span> <span class="o">+</span> <span class="n">j</span> <span class="o">*</span> <span class="n">dy</span>
            <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">mx</span>  
                <span class="n">xm</span> <span class="o">=</span> <span class="n">xlower</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mf">1.d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">dx</span>
                <span class="n">xc</span> <span class="o">=</span> <span class="n">xlower</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">dx</span>
                <span class="n">xp</span> <span class="o">=</span> <span class="n">xlower</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">dx</span>
                
                <span class="k">if</span> <span class="p">(</span><span class="n">coordinate_system</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
                    <span class="c">! Convert distance in lat-long to meters</span>
                    <span class="n">dx_meters</span> <span class="o">=</span> <span class="n">spherical_distance</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span><span class="n">yc</span><span class="p">,</span><span class="n">xm</span><span class="p">,</span><span class="n">yc</span><span class="p">)</span>
                    <span class="n">dy_meters</span> <span class="o">=</span> <span class="n">spherical_distance</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">yp</span><span class="p">,</span><span class="n">xc</span><span class="p">,</span><span class="n">ym</span><span class="p">)</span>
                <span class="k">else</span>
<span class="k">                    </span><span class="n">dx_meters</span> <span class="o">=</span> <span class="n">dx</span>
                    <span class="n">dy_meters</span> <span class="o">=</span> <span class="n">dy</span>
                <span class="n">endif</span>

                <span class="c">! Extract depths</span>
                <span class="n">h</span> <span class="o">=</span> <span class="n">q</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>

                <span class="c">! Calculate gradient of Pressure</span>
                <span class="n">P_gradient</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">aux</span><span class="p">(</span><span class="n">pressure_index</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="p">&amp;</span>
                               <span class="o">-</span> <span class="n">aux</span><span class="p">(</span><span class="n">pressure_index</span><span class="p">,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.d0</span> <span class="o">*</span> <span class="n">dx_meters</span><span class="p">)</span>
                <span class="n">P_gradient</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">aux</span><span class="p">(</span><span class="n">pressure_index</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">&amp;</span>
                               <span class="o">-</span> <span class="n">aux</span><span class="p">(</span><span class="n">pressure_index</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.d0</span> <span class="o">*</span> <span class="n">dy_meters</span><span class="p">)</span>

                    <span class="c">! Modify momentum in each layer</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">h</span> <span class="o">&gt;</span> <span class="n">dry_tolerance</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                    </span><span class="n">q</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">q</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">-</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="n">P_gradient</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">rho</span>
                    <span class="n">q</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">q</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">-</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="n">P_gradient</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">rho</span>
                <span class="k">end if</span>
<span class="k">            </span><span class="n">enddo</span>
        <span class="n">enddo</span>
    <span class="n">endif</span>

<span class="k">end subroutine </span><span class="n">src2</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p><a href="http://clawpack.org/">
    <img class="logo" src= "_static/clawlogo.jpg" alt="Logo"/>
</a>
<h2>Version 5.4.0</h2>
</p>
  <h3><a href="contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">src default routines</a><ul>
<li><a class="reference internal" href="#src-routine-in-geoclaw">src routine in GeoClaw</a></li>
</ul>
</li>
</ul>
<h3>Related Topics</h3>
<ul>
  <li><a href="contents.html">Documentation overview</a><ul>
  </ul></li>
</ul>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/src_defaults.rst"
           rel="nofollow">Show Source</a></li>
    <li><a href="https://github.com/clawpack/doc/blob/master/doc/src_defaults.rst"
           rel="nofollow">Show on GitHub</a></li>
    <li><a href="https://github.com/clawpack/doc/edit/master/doc/src_defaults.rst"
           rel="nofollow">Edit on GitHub</a></li>
  </ul>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
    &copy; Copyright 2017, The Clawpack Development Team.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44811544-1', 'auto');
  ga('send', 'pageview');

  </script>
  
  </body>
</html>